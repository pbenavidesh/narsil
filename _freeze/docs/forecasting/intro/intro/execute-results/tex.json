{
  "hash": "4252920b637e631117ec917a87f7803d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Descifrando patrones\"\nsubtitle: \"Cómo utilizar los pronósticos para predecir el turismo en México\"\ndate-modified: today\nformat: \n  html: default\n  revealjs:\n    output-file: intro_pres.html\n  pdf: default\n---\n\n\n\n\n```{}\nauthor: \"Pablo Benavides Herrera\"\nformat: \n  revealjs:\n    transition: zoom\n    logo: iteso.png\n    footer: \"Series de tiempo\"\n    scrollable: true\n    theme: league\n    self-contained: true\n    execute:\n      echo: false\n```\n\n\n# ¿Qué es una serie de tiempo? {backgroung-color=\"black\" background-image=\"dark.jpg\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(tidyverse, plotly, patchwork, timetk, modeltime, tidyquant, tsibble, feasts, fable, tsibbledata, fpp3, ggpubr, jpeg)\n```\n:::\n\n\n\n\n## {}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- gapminder::gapminder |> \n  ggplot(aes(x = gdpPercap, y = lifeExp, color = country,\n                       size = pop, label = country)) +\n  geom_point(aes(frame = year)) + \n  scale_x_log10() + \n  ylab(\"Esperanza de vida (años)\") +\n  xlab(\"PIB per cápita (USD, deflactado)\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in geom_point(aes(frame = year)): Ignoring unknown aesthetics: frame\n```\n\n\n:::\n\n```{.r .cell-code}\nggplotly(p)\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/gapminder-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n## {background-image=\"doge.jpg\"}\n\n## ![](fragua.png){fig-align=\"center\"} {background-color=\"white\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfragua <- tq_get(\"FRAGUAB.MX\", from = \"2021-01-01\")\n\nfragua |> \n  ggplot(aes(x = date, open = open, high = high, low = low, close = close)) +\n  geom_barchart(size = 1) +\n  geom_bbands(ma_fun = SMA, sd = 2, n = 20) +\n  theme_tq() +\n  labs(x = \"\")\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/fragua-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n## ¿Qué es un pronóstico?{backgroung-color=\"black\" background-image=\"walter2.jpeg\"}\n\n## {background-image=\"dr_strange.jpg\"}\n\n## {background-image=\"dr_strange_math.jpg\"}\n\n## {background-image=\"eclipse.jpg\"}\n\n## Existen infinitas posibilidades {background-image=\"google.jpg\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngoogle_stock <- tsibbledata::gafa_stock %>%\n  filter(Symbol == \"GOOG\") %>%\n  mutate(day = row_number()) %>%\n  tsibble::update_tsibble(index = day, regular = TRUE)\n\n# Filter the year of interest\ngoogle_2015 <- google_stock %>% filter(year(Date) == 2015)\n\nfit <- google_2015 %>%\n  model(NAIVE(Close))\n\nsim <- fit %>%  generate(h = 30, times = 10, bootstrap = TRUE, seed = 123)\n\np <- google_2015 %>%\n  ggplot(aes(x = day)) +\n  geom_line(aes(y = Close), size = 1) +\n  geom_line(aes(y = .sim, colour = as.factor(.rep)), data = sim, size = 1) +\n  ggtitle(\"Google closing stock price\") +\n  guides(col = \"none\") +\n  theme(legend.position = \"none\")\n\nggplotly(p, dynamicTicks = TRUE) |> rangeslider()\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/google_2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Pronóstico de la producción de cerveza\n\n::: {.columns}\n\n::: {.column width=\"70%\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naus_production |> \n  model(arima = ARIMA(Beer)) |> \n  forecast(h = \"5 years\") |> \n  autoplot(aus_production |> filter_index(\"1990 Q1\" ~ .), size = 1) +\n  labs(title = \"Producción de cerveza\",\n       x = \"Trimestre\",\n       y = \"Megalitros\")\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/beer-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n:::\n\n::: {.column width=\"30%\"}\n![](homer.png)\n:::\n\n::::\n\n## Energía eléctrica\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvic_elec_daily <- vic_elec %>%\n  # filter(year(Time) == 2014) %>%\n  index_by(Date = date(Time)) %>%\n  summarise(\n    Demand = sum(Demand)/1e3,\n    Temperature = max(Temperature),\n    Holiday = any(Holiday)\n  ) %>%\n  mutate(Day_Type = case_when(\n    Holiday ~ \"Holiday\",\n    wday(Date) %in% 2:6 ~ \"Weekday\",\n    TRUE ~ \"Weekend\"\n  ))\n\nvic_elec_daily |> \n  ggplot(aes(x = Date, y = Demand)) +\n  background_image(readJPEG(\"rick.jpg\")) +\n  annotate(\"rect\", xmin = min(vic_elec_daily$Date), xmax = max(vic_elec_daily$Date), ymin = -Inf, ymax = Inf, fill = \"black\", alpha = 0.5) +\n  geom_line(color = \"yellow2\") + theme_dark()\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/energy-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Demanda de energía eléctrica {}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- vic_elec_daily |> \n  ggplot(aes(x = Date, y = Demand)) +\n  geom_line(color = \"yellow2\", size = 1) +\n  theme_dark() +\n  labs(x = \"Fecha\", y = \"Demanda\")\n\np\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/energy_plotly-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# ggplotly(p, dynamicTicks = TRUE) |> rangeslider()\n```\n:::\n\n\n\n\n## Empleo {auto-animate=\"true\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_retail_employment <- us_employment %>%\n  filter(year(Month) >= 1990, Title == \"Retail Trade\")\n\np <- us_retail_employment |> \n  ggplot(aes(x = Month, y = Employed)) +\n  geom_line(size = 1, color = \"purple\") +\n  labs(x = \"Mes\", y = \"Empleados\") + \n  theme_pubclean()\n\np\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# ggplotly(p, dynamicTicks = TRUE) |> \n#   rangeslider()\n```\n:::\n\n\n\n\n## Empleo {auto-animate=\"true\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_retail_employment |> \n  model(ets = ARIMA(Employed)) |> \n  forecast(h = \"6 years\") |> \n  autoplot(color = \"purple\", size = 1) +\n  autolayer(us_retail_employment, Employed, color = \"purple\", size = 1) +\n  theme_pubclean() +\n  labs(x = \"Mes\", y = \"Empleos\")\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n## {background-iframe=\"https://pbenavides.shinyapps.io/04_covid_forecasts_google/\" background-interactive=true}\n\n\n\n\n# El turismo en México\n\n## \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nturismo <- readxl::read_excel(\"evi_01.xlsx\", skip = 10, col_names = TRUE) |> \n  slice(1:6) |> \n  janitor::remove_empty()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nvalue for \"which\" not specified, defaulting to c(\"rows\", \"cols\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n* `` -> `...1`\n* `Entradas` -> `Entradas...2`\n* `Salidas` -> `Salidas...3`\n* `` -> `...4`\n* `Entradas` -> `Entradas...5`\n* `Salidas` -> `Salidas...6`\n* `` -> `...7`\n* `Entradas` -> `Entradas...8`\n* `Salidas` -> `Salidas...9`\n* `` -> `...10`\n* `Entradas` -> `Entradas...11`\n* `Salidas` -> `Salidas...12`\n* `` -> `...13`\n* `Entradas` -> `Entradas...14`\n* `Salidas` -> `Salidas...15`\n* `` -> `...16`\n* `Entradas` -> `Entradas...17`\n* `Salidas` -> `Salidas...18`\n* `` -> `...19`\n* `Entradas` -> `Entradas...20`\n* `Salidas` -> `Salidas...21`\n* `` -> `...22`\n* `Entradas` -> `Entradas...23`\n* `Salidas` -> `Salidas...24`\n* `` -> `...25`\n* `Entradas` -> `Entradas...26`\n* `Salidas` -> `Salidas...27`\n* `` -> `...28`\n* `Entradas` -> `Entradas...29`\n* `Salidas` -> `Salidas...30`\n* `` -> `...31`\n* `Entradas` -> `Entradas...32`\n* `Salidas` -> `Salidas...33`\n* `` -> `...34`\n* `Entradas` -> `Entradas...35`\n* `Salidas` -> `Salidas...36`\n* `` -> `...37`\n* `Entradas` -> `Entradas...38`\n* `Salidas` -> `Salidas...39`\n* `` -> `...40`\n* `Entradas` -> `Entradas...41`\n* `Salidas` -> `Salidas...42`\n* `` -> `...43`\n* `Entradas` -> `Entradas...44`\n* `Salidas` -> `Salidas...45`\n* `` -> `...46`\n* `Entradas` -> `Entradas...47`\n* `Salidas` -> `Salidas...48`\n* `` -> `...49`\n* `Entradas` -> `Entradas...50`\n* `Salidas` -> `Salidas...51`\n* `` -> `...52`\n* `Entradas` -> `Entradas...53`\n* `Salidas` -> `Salidas...54`\n* `` -> `...55`\n* `Entradas` -> `Entradas...56`\n* `Salidas` -> `Salidas...57`\n* `` -> `...58`\n* `Entradas` -> `Entradas...59`\n* `Salidas` -> `Salidas...60`\n* `` -> `...61`\n* `Entradas` -> `Entradas...62`\n* `Salidas` -> `Salidas...63`\n* `` -> `...64`\n* `Entradas` -> `Entradas...65`\n* `Salidas` -> `Salidas...66`\n* `` -> `...67`\n* `Entradas` -> `Entradas...68`\n* `Salidas` -> `Salidas...69`\n* `` -> `...70`\n* `Entradas` -> `Entradas...71`\n* `Salidas` -> `Salidas...72`\n* `` -> `...73`\n* `Entradas` -> `Entradas...74`\n* `Salidas` -> `Salidas...75`\n* `` -> `...76`\n* `Entradas` -> `Entradas...77`\n* `Salidas` -> `Salidas...78`\n* `` -> `...79`\n* `Entradas` -> `Entradas...80`\n* `Salidas` -> `Salidas...81`\n* `` -> `...82`\n* `Entradas` -> `Entradas...83`\n* `Salidas` -> `Salidas...84`\n* `` -> `...85`\n* `Entradas` -> `Entradas...86`\n* `Salidas` -> `Salidas...87`\n* `` -> `...88`\n* `Entradas` -> `Entradas...89`\n* `Salidas` -> `Salidas...90`\n* `` -> `...91`\n* `Entradas` -> `Entradas...92`\n* `Salidas` -> `Salidas...93`\n* `` -> `...94`\n* `Entradas` -> `Entradas...95`\n* `Salidas` -> `Salidas...96`\n* `` -> `...97`\n* `Entradas` -> `Entradas...98`\n* `Salidas` -> `Salidas...99`\n* `` -> `...100`\n* `Entradas` -> `Entradas...101`\n* `Salidas` -> `Salidas...102`\n* `` -> `...103`\n* `Entradas` -> `Entradas...104`\n* `Salidas` -> `Salidas...105`\n* `` -> `...106`\n* `Entradas` -> `Entradas...107`\n* `Salidas` -> `Salidas...108`\n* `` -> `...109`\n* `Entradas` -> `Entradas...110`\n* `Salidas` -> `Salidas...111`\n* `` -> `...112`\n* `Entradas` -> `Entradas...113`\n* `Salidas` -> `Salidas...114`\n* `` -> `...115`\n* `Entradas` -> `Entradas...116`\n* `Salidas` -> `Salidas...117`\n* `` -> `...118`\n* `Entradas` -> `Entradas...119`\n* `Salidas` -> `Salidas...120`\n* `` -> `...121`\n* `Entradas` -> `Entradas...122`\n* `Salidas` -> `Salidas...123`\n* `` -> `...124`\n* `Entradas` -> `Entradas...125`\n* `Salidas` -> `Salidas...126`\n* `` -> `...127`\n* `Entradas` -> `Entradas...128`\n* `Salidas` -> `Salidas...129`\n* `` -> `...130`\n* `Entradas` -> `Entradas...131`\n* `Salidas` -> `Salidas...132`\n* `` -> `...133`\n* `Entradas` -> `Entradas...134`\n* `Salidas` -> `Salidas...135`\n* `` -> `...136`\n* `Entradas` -> `Entradas...137`\n* `Salidas` -> `Salidas...138`\n* `` -> `...139`\n* `Entradas` -> `Entradas...140`\n* `Salidas` -> `Salidas...141`\n* `` -> `...142`\n* `Entradas` -> `Entradas...143`\n* `Salidas` -> `Salidas...144`\n* `` -> `...145`\n* `Entradas` -> `Entradas...146`\n* `Salidas` -> `Salidas...147`\n* `` -> `...148`\n* `Entradas` -> `Entradas...149`\n* `Salidas` -> `Salidas...150`\n* `` -> `...151`\n* `Entradas` -> `Entradas...152`\n* `Salidas` -> `Salidas...153`\n* `` -> `...154`\n* `Entradas` -> `Entradas...155`\n* `Salidas` -> `Salidas...156`\n* `` -> `...157`\n* `Entradas` -> `Entradas...158`\n* `Salidas` -> `Salidas...159`\n* `` -> `...160`\n* `Entradas` -> `Entradas...161`\n* `Salidas` -> `Salidas...162`\n* `` -> `...163`\n* `Entradas` -> `Entradas...164`\n* `Salidas` -> `Salidas...165`\n* `` -> `...166`\n* `Entradas` -> `Entradas...167`\n* `Salidas` -> `Salidas...168`\n* `` -> `...169`\n* `Entradas` -> `Entradas...170`\n* `Salidas` -> `Salidas...171`\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nturismo_long <- turismo |> \n  rename(tipo_turismo = ...1) |> \n  select(tipo_turismo, starts_with(\"Entradas\")) |> \n  pivot_longer(cols = - tipo_turismo) |> \n  select(-name) |> \n  group_by(tipo_turismo) |> \n  mutate(date = seq(as.Date(\"2018-08-01\"), as.Date(\"2023-04-01\"), by = \"month\")) |> \n  relocate(date) |> \n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nturismo_tsbl <- turismo_long |> \n  mutate(date = yearmonth(date)) |> \n  as_tsibble(index = date, key = tipo_turismo)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np <- turismo_tsbl |> \n  autoplot(value) +\n  facet_wrap(~ factor(tipo_turismo, levels = c(\"Turistas de internación\", \"Vía aérea\", \"Vía terrestre\", \n                                               \"Turistas fronterizos\", \"En automóviles\", \"Peatones\")), ncol = 3) +\n  theme(legend.position = \"none\")\n\np\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# ggplotly(p)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# turismo_long |> \n#   filter(tipo_turismo == \"Turistas de internación\") |> \n#   select(-tipo_turismo) |> \n#   write_csv(\"turismo.csv\")\n\nturismo_tsbl |> \n  filter(tipo_turismo == \"Turistas de internación\") |> \n  # filter(tipo_turismo %in% c(\"Vía aérea\", \"Vía terrestre\")) |> \n  model(\n    arima = ETS(value)\n  ) |> \n  forecast(h = \"3 years\") |> \n  autoplot(turismo_tsbl)\n```\n\n::: {.cell-output-display}\n![](intro_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "intro_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": true
  }
}