<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Pablo Benavides">
<meta name="dcterms.date" content="2022-09-30">
<title>The Forecasting Workflow using fable – Time Series Forecasting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../docs/modules/module_2/01_ets/ets.html" rel="next">
<link href="../../docs/modules/module_1/03_fcst/forecasting.html" rel="prev">
<link href="../../images/narsil_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a14e345711173c227b21482e2eb4cc70.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-6d7e0e055978adcb0dc3bbe98a6d8351.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a14e345711173c227b21482e2eb4cc70.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-524790b0a7ee18005c3851d02937763f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-eee2d00aedcbe505dcabd4c64206c4cc.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-524790b0a7ee18005c3851d02937763f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "classic"
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../../site_libs/plotly-binding-4.11.0/plotly.js"></script><script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script><script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script><link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta property="og:image" content="https://pbenavidesh.github.io/narsil/docs/modules/forecasting_workflow_files/figure-html/unnamed-chunk-10-1.png">
<meta property="og:site_name" content="Time Series Forecasting">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta name="twitter:image" content="https://pbenavidesh.github.io/narsil/docs/modules/forecasting_workflow_files/figure-html/unnamed-chunk-10-1.png">
<meta name="twitter:creator" content="@PabsBenavides">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/iteso_logo_blanco.png" alt="" class="navbar-logo light-content"><img src="../../images/iteso_logo_blanco.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Time Series Forecasting</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../docs/modules/module_1/00_intro/intro.html"> 
<span class="menu-text">Modules</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../images/under_construction.jpg"> 
<span class="menu-text">More</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../docs/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/pbenavidesh/narsil" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/modules/module_1/00_intro/intro.html">1. Forecasting models based on decomposition methods</a></li><li class="breadcrumb-item"><a href="../../docs/modules/forecasting_workflow.html">1.4 The Forecasting Workflow</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav><div id="quarto-announcement" data-announcement-id="f7515ca3a679eca1904c4eeb50b2aff8" class="alert alert-primary hidden">
<div class="quarto-announcement-content">
<p><strong>NEW</strong> - Module 1 - Forecasting is now up &amp; running</p>
</div>
<i class="bi bi-x-lg quarto-announcement-action"></i>
</div>
</header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">1. Forecasting models based on decomposition methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/module_1/00_intro/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.0 Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/module_1/01_time_series/r_time_series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.1 RStudio, R, and Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/module_1/02_ts_dcmp/ts_dcmp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.2 Time Series Decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/module_1/03_fcst/forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1.3 Forecasting principles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/forecasting_workflow.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">1.4 The Forecasting Workflow</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">2. Adding ETS and ARIMA filters</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/modules/module_2/01_ets/ets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1 Exponential Smoothing</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">2.2 Identifying Stationarity</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">2.3 ARIMA models</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">2.4 Decomposition &amp; ETS/ARIMA</span>
  </li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">3. Adding exogenous variables to the model</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
 <span class="menu-text">3.1 Linear Regression Models</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">3.2 Build dynamic regressions</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">3.3 Analyze the model's performance</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">3.4 Choose the best variables for the model</span>
  </li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">4. Forecasting at scale</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
 <span class="menu-text">4.1 Understanding the challenges and approaches when dealing with multiple time series</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">4.2 Applying hierarchical and reconciliation models</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">4.3 Efficient forecasting workflow</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">4.4 Evaluation of the global performance</span>
  </li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
<li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages"><span class="header-section-number">0.1</span> Packages</a></li>
  </ul>
</li>
  <li>
<a href="#forecasting-workflow" id="toc-forecasting-workflow" class="nav-link" data-scroll-target="#forecasting-workflow"><span class="header-section-number">1</span> Forecasting Workflow</a>
  <ul class="collapse">
<li>
<a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.1</span> Data</a>
  <ul class="collapse">
<li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">1.1.1</span> Import data</a></li>
  <li><a href="#wrangle-data" id="toc-wrangle-data" class="nav-link" data-scroll-target="#wrangle-data"><span class="header-section-number">1.1.2</span> Wrangle data</a></li>
  </ul>
</li>
  <li><a href="#traintest-split" id="toc-traintest-split" class="nav-link" data-scroll-target="#traintest-split"><span class="header-section-number">1.2</span> Train/Test Split</a></li>
  <li>
<a href="#visualization-and-eda" id="toc-visualization-and-eda" class="nav-link" data-scroll-target="#visualization-and-eda"><span class="header-section-number">1.3</span> Visualization and EDA</a>
  <ul class="collapse">
<li><a href="#ts-decomposition" id="toc-ts-decomposition" class="nav-link" data-scroll-target="#ts-decomposition"><span class="header-section-number">1.3.1</span> TS Decomposition</a></li>
  </ul>
</li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><span class="header-section-number">1.4</span> Model Specification</a></li>
  <li>
<a href="#residuals-diagnostics" id="toc-residuals-diagnostics" class="nav-link" data-scroll-target="#residuals-diagnostics"><span class="header-section-number">1.5</span> Residuals Diagnostics</a>
  <ul class="collapse">
<li><a href="#visual-analysis" id="toc-visual-analysis" class="nav-link" data-scroll-target="#visual-analysis"><span class="header-section-number">1.5.1</span> Visual analysis</a></li>
  <li><a href="#portmanteau-tests-of-autocorrelation" id="toc-portmanteau-tests-of-autocorrelation" class="nav-link" data-scroll-target="#portmanteau-tests-of-autocorrelation"><span class="header-section-number">1.5.2</span> Portmanteau tests of autocorrelation</a></li>
  </ul>
</li>
  <li>
<a href="#modeling-using-decomposition" id="toc-modeling-using-decomposition" class="nav-link" data-scroll-target="#modeling-using-decomposition"><span class="header-section-number">1.6</span> Modeling using decomposition</a>
  <ul class="collapse">
<li><a href="#residuals-diagnostics-1" id="toc-residuals-diagnostics-1" class="nav-link" data-scroll-target="#residuals-diagnostics-1"><span class="header-section-number">1.6.1</span> Residuals diagnostics</a></li>
  </ul>
</li>
  <li><a href="#forecasting-on-the-test-set" id="toc-forecasting-on-the-test-set" class="nav-link" data-scroll-target="#forecasting-on-the-test-set"><span class="header-section-number">1.7</span> Forecasting on the test set</a></li>
  <li><a href="#forecasting-the-future" id="toc-forecasting-the-future" class="nav-link" data-scroll-target="#forecasting-the-future"><span class="header-section-number">1.8</span> Forecasting the future</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/pbenavidesh/narsil/edit/main/docs/modules/forecasting_workflow.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pbenavidesh/narsil/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="forecasting_wf_pres.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/modules/module_1/00_intro/intro.html">1. Forecasting models based on decomposition methods</a></li><li class="breadcrumb-item"><a href="../../docs/modules/forecasting_workflow.html">1.4 The Forecasting Workflow</a></li></ol></nav><div class="quarto-title">
<h1 class="title">The Forecasting Workflow using <code>fable</code>
</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pablo Benavides </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 1, 2025</p>
    </div>
  </div>
    
  </div>
  


</header><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="https://tidyverts.org/images/fable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://tidyverts.org/images/fable.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<section id="introduction" class="level1 unnumbered"><h1 class="unnumbered">Introduction</h1>
<section id="packages" class="level2" data-number="0.1"><h2 data-number="0.1" class="anchored" data-anchor-id="packages">
<span class="header-section-number">0.1</span> Packages</h2>
<p>It is recommended to load all the packages at the beginning of your file. We will be using the <code>tidyverts</code> ecosystem for the whole forecasting workflow.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp3/">fpp3</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not load unnecesary packages into your environment. It could lead to conflicts between functions and unwanted results.</p>
</div>
</div>
</section></section><section id="forecasting-workflow" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Forecasting Workflow</h1>
<section id="data" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="data">
<span class="header-section-number">1.1</span> Data</h2>
<p>We will work with the Real Gross Domestic Product (GDP) for Mexico. The data is downloaded from <a href="https://fred.stlouisfed.org/series/NGDPRNSAXDCMXQ">FRED</a>. The time series id is <code>NGDPRNSAXDCMXQ</code>.</p>
<section id="import-data" class="level3" data-number="1.1.1"><h3 data-number="1.1.1" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">1.1.1</span> Import data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp</span> <span class="op">&lt;-</span> <span class="fu">tidyquant</span><span class="fu">::</span><span class="fu"><a href="https://business-science.github.io/tidyquant/reference/tq_get.html">tq_get</a></span><span class="op">(</span></span>
<span>  x    <span class="op">=</span> <span class="st">"NGDPRNSAXDCMXQ"</span>,</span>
<span>  get  <span class="op">=</span> <span class="st">"economic.data"</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"1997-01-01"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gdp</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 113 × 3
   symbol         date          price
   &lt;chr&gt;          &lt;date&gt;        &lt;dbl&gt;
 1 NGDPRNSAXDCMXQ 1997-01-01 3702398.
 2 NGDPRNSAXDCMXQ 1997-04-01 3896084.
 3 NGDPRNSAXDCMXQ 1997-07-01 3906063 
 4 NGDPRNSAXDCMXQ 1997-10-01 4038358.
 5 NGDPRNSAXDCMXQ 1998-01-01 4084304.
 6 NGDPRNSAXDCMXQ 1998-04-01 4134899.
 7 NGDPRNSAXDCMXQ 1998-07-01 4138200.
 8 NGDPRNSAXDCMXQ 1998-10-01 4146841.
 9 NGDPRNSAXDCMXQ 1999-01-01 4176243.
10 NGDPRNSAXDCMXQ 1999-04-01 4232280.
# ℹ 103 more rows</code></pre>
</div>
</div>
</section><section id="wrangle-data" class="level3" data-number="1.1.2"><h3 data-number="1.1.2" class="anchored" data-anchor-id="wrangle-data">
<span class="header-section-number">1.1.2</span> Wrangle data</h3>
<p>There are some issues with our data:</p>
<ol type="1">
<li>It is loaded into a <code>tibble</code> object. We need to convert it to a <strong><code>tsibble</code></strong>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can use <code>as_tsibble()</code> to do so.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Our data is <strong>quarterly</strong>, but it is loaded in a <code>YYYY-MM-DD</code> format. We need to change it to a <code>YYYY QQ</code> format.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are some functions that help us achieve this, such as</p>
<ul>
<li><code>yearquarter()</code></li>
<li><code>yearmonth()</code></li>
<li><code>yearweek()</code></li>
<li><code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code></li>
</ul>
<p>depending on the time series’ period.</p>
</div>
</div>
</div>
<p>We will overwrite our data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">gdp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu">yearquarter</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">as_tsibble</span><span class="op">(</span></span>
<span>    index <span class="op">=</span> <span class="va">date</span>,</span>
<span>    key   <span class="op">=</span> <span class="va">symbol</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">gdp</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134899"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146841"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262621"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840643"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936399"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990925"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169143"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237545"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734911"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542389"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862075"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803635"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995609"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826518"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872816"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082191"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892094"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098930"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151324"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947660"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038713"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006225"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089133"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862463"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813195"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518074"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876203"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q1","3":"5710343"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q2","3":"5905898"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q3","3":"5801172"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q4","3":"5987418"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q1","3":"5860410"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q2","3":"6077371"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q3","3":"6072202"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q4","3":"6263110"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q1","3":"6087664"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q2","3":"6288978"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q3","3":"6291630"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q4","3":"6418829"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q1","3":"6180422"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q2","3":"6429466"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q3","3":"6393540"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q4","3":"6441774"},{"1":"NGDPRNSAXDCMXQ","2":"2025 Q1","3":"6229814"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>We always need to specify the <code>index</code> argument, as it is our <strong>date</strong> variable.</p></li>
<li><p>The <code>key</code> argument is necessary whenever we have more than one time series in our data frame and is made up of <strong>one or more columns</strong> that uniquely identify each time series .</p></li>
</ul>
</div>
</div>
</div>
</section></section><section id="traintest-split" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="traintest-split">
<span class="header-section-number">1.2</span> Train/Test Split</h2>
<p>We will split our data in two sets: a training set, and a test set, in order to evaluate our forecasts’ accuracy.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train</span> <span class="op">&lt;-</span> <span class="va">gdp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">filter_index</span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="st">"2021 Q4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gdp_train</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134899"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146841"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262621"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840643"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936399"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990925"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169143"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237545"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734911"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542389"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862075"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803635"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995609"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826518"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872816"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082191"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892094"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098930"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151324"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947660"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038713"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006225"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089133"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862463"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813195"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518074"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876203"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q1","3":"5710343"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q2","3":"5905898"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q3","3":"5801172"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q4","3":"5987418"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For all our variables, it is strongly recommended to follow the same notation process, and write our code using <a href="https://en.wikipedia.org/wiki/Snake_case"><strong>snake_case</strong></a>. Here, we called our data <code>gdp</code>, therefore, all the following variables will be called starting with <strong><code>gdp_</code></strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, such as <code>gdp_train</code> for our training set.</p>
</div>
</div>
</section><section id="visualization-and-eda" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="visualization-and-eda">
<span class="header-section-number">1.3</span> Visualization and EDA</h2>
<p>When performing time series analysis/forecasting, one of the first things to do is to create a time series plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Time series plot of the Real GDP for Mexico"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"GDP"</span></span>
<span>  <span class="op">)</span></span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p</span>, dynamicTicks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/rangeslider.html">rangeslider</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-577e76158c16bdda039d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-577e76158c16bdda039d">{"x":{"data":[{"x":["1997-01-01","1997-04-01","1997-07-01","1997-10-01","1998-01-01","1998-04-01","1998-07-01","1998-10-01","1999-01-01","1999-04-01","1999-07-01","1999-10-01","2000-01-01","2000-04-01","2000-07-01","2000-10-01","2001-01-01","2001-04-01","2001-07-01","2001-10-01","2002-01-01","2002-04-01","2002-07-01","2002-10-01","2003-01-01","2003-04-01","2003-07-01","2003-10-01","2004-01-01","2004-04-01","2004-07-01","2004-10-01","2005-01-01","2005-04-01","2005-07-01","2005-10-01","2006-01-01","2006-04-01","2006-07-01","2006-10-01","2007-01-01","2007-04-01","2007-07-01","2007-10-01","2008-01-01","2008-04-01","2008-07-01","2008-10-01","2009-01-01","2009-04-01","2009-07-01","2009-10-01","2010-01-01","2010-04-01","2010-07-01","2010-10-01","2011-01-01","2011-04-01","2011-07-01","2011-10-01","2012-01-01","2012-04-01","2012-07-01","2012-10-01","2013-01-01","2013-04-01","2013-07-01","2013-10-01","2014-01-01","2014-04-01","2014-07-01","2014-10-01","2015-01-01","2015-04-01","2015-07-01","2015-10-01","2016-01-01","2016-04-01","2016-07-01","2016-10-01","2017-01-01","2017-04-01","2017-07-01","2017-10-01","2018-01-01","2018-04-01","2018-07-01","2018-10-01","2019-01-01","2019-04-01","2019-07-01","2019-10-01","2020-01-01","2020-04-01","2020-07-01","2020-10-01","2021-01-01","2021-04-01","2021-07-01","2021-10-01"],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5,4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999,4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002,4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998,4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004,4269784.4000000004,4504199.5,4457000.9000000004,4458615,4402401.5,4520666,4464786.7999999998,4511463.5999999996,4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996,4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998,4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998,4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002,4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996,4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002,4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004,5022838,5170733.5,5237545.4000000004,5368843.5999999996,5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996,5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004,5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998,5542388.7000000002,5710754.5,5752936.4000000004,5862074.5999999996,5634257.5999999996,5839988.7000000002,5803635.4000000004,5995609.0999999996,5826518.0999999996,5927581.9000000004,5872816.4000000004,6082190.9000000004,5892094.5,6098930.0999999996,6034322.0999999996,6151323.5999999996,5947659.7999999998,6038713,6006224.7000000002,6089133.4000000004,5862462.9000000004,4813194.7000000002,5518073.9000000004,5876203.2999999998,5710343.2999999998,5905897.7999999998,5801172.5,5987417.5],"text":["date: 1997 Q1<br />price: 3702398","date: 1997 Q2<br />price: 3896084","date: 1997 Q3<br />price: 3906063","date: 1997 Q4<br />price: 4038358","date: 1998 Q1<br />price: 4084304","date: 1998 Q2<br />price: 4134899","date: 1998 Q3<br />price: 4138200","date: 1998 Q4<br />price: 4146841","date: 1999 Q1<br />price: 4176243","date: 1999 Q2<br />price: 4232280","date: 1999 Q3<br />price: 4262621","date: 1999 Q4<br />price: 4287798","date: 2000 Q1<br />price: 4412426","date: 2000 Q2<br />price: 4465504","date: 2000 Q3<br />price: 4505221","date: 2000 Q4<br />price: 4428703","date: 2001 Q1<br />price: 4441058","date: 2001 Q2<br />price: 4468505","date: 2001 Q3<br />price: 4440265","date: 2001 Q4<br />price: 4381722","date: 2002 Q1<br />price: 4269784","date: 2002 Q2<br />price: 4504200","date: 2002 Q3<br />price: 4457001","date: 2002 Q4<br />price: 4458615","date: 2003 Q1<br />price: 4402402","date: 2003 Q2<br />price: 4520666","date: 2003 Q3<br />price: 4464787","date: 2003 Q4<br />price: 4511464","date: 2004 Q1<br />price: 4546254","date: 2004 Q2<br />price: 4692565","date: 2004 Q3<br />price: 4615345","date: 2004 Q4<br />price: 4683344","date: 2005 Q1<br />price: 4567922","date: 2005 Q2<br />price: 4804679","date: 2005 Q3<br />price: 4720818","date: 2005 Q4<br />price: 4835832","date: 2006 Q1<br />price: 4840643","date: 2006 Q2<br />price: 5029028","date: 2006 Q3<br />price: 4959002","date: 2006 Q4<br />price: 5010131","date: 2007 Q1<br />price: 4936399","date: 2007 Q2<br />price: 5127368","date: 2007 Q3<br />price: 5066709","date: 2007 Q4<br />price: 5120551","date: 2008 Q1<br />price: 4975730","date: 2008 Q2<br />price: 5249626","date: 2008 Q3<br />price: 5123968","date: 2008 Q4<br />price: 5092737","date: 2009 Q1<br />price: 4634315","date: 2009 Q2<br />price: 4706891","date: 2009 Q3<br />price: 4823052","date: 2009 Q4<br />price: 4990925","date: 2010 Q1<br />price: 4842968","date: 2010 Q2<br />price: 5045140","date: 2010 Q3<br />price: 5050200","date: 2010 Q4<br />price: 5169143","date: 2011 Q1<br />price: 5022838","date: 2011 Q2<br />price: 5170734","date: 2011 Q3<br />price: 5237545","date: 2011 Q4<br />price: 5368844","date: 2012 Q1<br />price: 5270945","date: 2012 Q2<br />price: 5380528","date: 2012 Q3<br />price: 5369752","date: 2012 Q4<br />price: 5517802","date: 2013 Q1<br />price: 5256450","date: 2013 Q2<br />price: 5473377","date: 2013 Q3<br />price: 5425704","date: 2013 Q4<br />price: 5567030","date: 2014 Q1<br />price: 5386946","date: 2014 Q2<br />price: 5580039","date: 2014 Q3<br />price: 5564547","date: 2014 Q4<br />price: 5734911","date: 2015 Q1<br />price: 5542389","date: 2015 Q2<br />price: 5710754","date: 2015 Q3<br />price: 5752936","date: 2015 Q4<br />price: 5862075","date: 2016 Q1<br />price: 5634258","date: 2016 Q2<br />price: 5839989","date: 2016 Q3<br />price: 5803635","date: 2016 Q4<br />price: 5995609","date: 2017 Q1<br />price: 5826518","date: 2017 Q2<br />price: 5927582","date: 2017 Q3<br />price: 5872816","date: 2017 Q4<br />price: 6082191","date: 2018 Q1<br />price: 5892094","date: 2018 Q2<br />price: 6098930","date: 2018 Q3<br />price: 6034322","date: 2018 Q4<br />price: 6151324","date: 2019 Q1<br />price: 5947660","date: 2019 Q2<br />price: 6038713","date: 2019 Q3<br />price: 6006225","date: 2019 Q4<br />price: 6089133","date: 2020 Q1<br />price: 5862463","date: 2020 Q2<br />price: 4813195","date: 2020 Q3<br />price: 5518074","date: 2020 Q4<br />price: 5876203","date: 2021 Q1<br />price: 5710343","date: 2021 Q2<br />price: 5905898","date: 2021 Q3<br />price: 5801172","date: 2021 Q4<br />price: 5987418"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time series plot of the Real GDP for Mexico","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"tickmode":"auto","ticktext":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"tickvals":[10957,12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"date [1Q]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f","rangeslider":{"visible":true}},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[3579951.5099999998,6273769.8899999997],"tickmode":"auto","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"GDP","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"19025d537533":{"x":{},"y":{},"type":"scatter"}},"cur_data":"19025d537533","visdat":{"19025d537533":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Our data exhibits an upward <em>linear trend</em> (with some economic cycles), and strong <em>yearly seasonality</em>.</p>
</div>
</div>
</div>
<p>We will explore it further with a season plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gg_season</span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6d6d311b32de17a1b769" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6d6d311b32de17a1b769">{"x":{"data":[{"x":[1096,1186,1277,1369],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5],"text":["date: 1973 Q1<br />price: 3702398<br />unclass(id):  1<br />id: 1997","date: 1973 Q2<br />price: 3896084<br />unclass(id):  1<br />id: 1997","date: 1973 Q3<br />price: 3906063<br />unclass(id):  1<br />id: 1997","date: 1973 Q4<br />price: 4038358<br />unclass(id):  1<br />id: 1997"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999],"text":["date: 1973 Q1<br />price: 4084304<br />unclass(id):  2<br />id: 1998","date: 1973 Q2<br />price: 4134899<br />unclass(id):  2<br />id: 1998","date: 1973 Q3<br />price: 4138200<br />unclass(id):  2<br />id: 1998","date: 1973 Q4<br />price: 4146841<br />unclass(id):  2<br />id: 1998"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(237,129,83,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002],"text":["date: 1973 Q1<br />price: 4176243<br />unclass(id):  3<br />id: 1999","date: 1973 Q2<br />price: 4232280<br />unclass(id):  3<br />id: 1999","date: 1973 Q3<br />price: 4262621<br />unclass(id):  3<br />id: 1999","date: 1973 Q4<br />price: 4287798<br />unclass(id):  3<br />id: 1999"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(224,138,54,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998],"text":["date: 1973 Q1<br />price: 4412426<br />unclass(id):  4<br />id: 2000","date: 1973 Q2<br />price: 4465504<br />unclass(id):  4<br />id: 2000","date: 1973 Q3<br />price: 4505221<br />unclass(id):  4<br />id: 2000","date: 1973 Q4<br />price: 4428703<br />unclass(id):  4<br />id: 2000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(211,146,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004],"text":["date: 1973 Q1<br />price: 4441058<br />unclass(id):  5<br />id: 2001","date: 1973 Q2<br />price: 4468505<br />unclass(id):  5<br />id: 2001","date: 1973 Q3<br />price: 4440265<br />unclass(id):  5<br />id: 2001","date: 1973 Q4<br />price: 4381722<br />unclass(id):  5<br />id: 2001"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(191,155,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4269784.4000000004,4504199.5,4457000.9000000004,4458615],"text":["date: 1973 Q1<br />price: 4269784<br />unclass(id):  6<br />id: 2002","date: 1973 Q2<br />price: 4504200<br />unclass(id):  6<br />id: 2002","date: 1973 Q3<br />price: 4457001<br />unclass(id):  6<br />id: 2002","date: 1973 Q4<br />price: 4458615<br />unclass(id):  6<br />id: 2002"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(170,163,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4402401.5,4520666,4464786.7999999998,4511463.5999999996],"text":["date: 1973 Q1<br />price: 4402402<br />unclass(id):  7<br />id: 2003","date: 1973 Q2<br />price: 4520666<br />unclass(id):  7<br />id: 2003","date: 1973 Q3<br />price: 4464787<br />unclass(id):  7<br />id: 2003","date: 1973 Q4<br />price: 4511464<br />unclass(id):  7<br />id: 2003"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(147,170,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996],"text":["date: 1973 Q1<br />price: 4546254<br />unclass(id):  8<br />id: 2004","date: 1973 Q2<br />price: 4692565<br />unclass(id):  8<br />id: 2004","date: 1973 Q3<br />price: 4615345<br />unclass(id):  8<br />id: 2004","date: 1973 Q4<br />price: 4683344<br />unclass(id):  8<br />id: 2004"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(120,176,27,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998],"text":["date: 1973 Q1<br />price: 4567922<br />unclass(id):  9<br />id: 2005","date: 1973 Q2<br />price: 4804679<br />unclass(id):  9<br />id: 2005","date: 1973 Q3<br />price: 4720818<br />unclass(id):  9<br />id: 2005","date: 1973 Q4<br />price: 4835832<br />unclass(id):  9<br />id: 2005"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(85,181,43,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998],"text":["date: 1973 Q1<br />price: 4840643<br />unclass(id): 10<br />id: 2006","date: 1973 Q2<br />price: 5029028<br />unclass(id): 10<br />id: 2006","date: 1973 Q3<br />price: 4959002<br />unclass(id): 10<br />id: 2006","date: 1973 Q4<br />price: 5010131<br />unclass(id): 10<br />id: 2006"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002],"text":["date: 1973 Q1<br />price: 4936399<br />unclass(id): 11<br />id: 2007","date: 1973 Q2<br />price: 5127368<br />unclass(id): 11<br />id: 2007","date: 1973 Q3<br />price: 5066709<br />unclass(id): 11<br />id: 2007","date: 1973 Q4<br />price: 5120551<br />unclass(id): 11<br />id: 2007"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(25,188,94,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996],"text":["date: 1973 Q1<br />price: 4975730<br />unclass(id): 12<br />id: 2008","date: 1973 Q2<br />price: 5249626<br />unclass(id): 12<br />id: 2008","date: 1973 Q3<br />price: 5123968<br />unclass(id): 12<br />id: 2008","date: 1973 Q4<br />price: 5092737<br />unclass(id): 12<br />id: 2008"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(26,191,127,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002],"text":["date: 1973 Q1<br />price: 4634315<br />unclass(id): 13<br />id: 2009","date: 1973 Q2<br />price: 4706891<br />unclass(id): 13<br />id: 2009","date: 1973 Q3<br />price: 4823052<br />unclass(id): 13<br />id: 2009","date: 1973 Q4<br />price: 4990925<br />unclass(id): 13<br />id: 2009"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,193,159,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004],"text":["date: 1973 Q1<br />price: 4842968<br />unclass(id): 14<br />id: 2010","date: 1973 Q2<br />price: 5045140<br />unclass(id): 14<br />id: 2010","date: 1973 Q3<br />price: 5050200<br />unclass(id): 14<br />id: 2010","date: 1973 Q4<br />price: 5169143<br />unclass(id): 14<br />id: 2010"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(20,190,182,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5022838,5170733.5,5237545.4000000004,5368843.5999999996],"text":["date: 1973 Q1<br />price: 5022838<br />unclass(id): 15<br />id: 2011","date: 1973 Q2<br />price: 5170734<br />unclass(id): 15<br />id: 2011","date: 1973 Q3<br />price: 5237545<br />unclass(id): 15<br />id: 2011","date: 1973 Q4<br />price: 5368844<br />unclass(id): 15<br />id: 2011"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(20,188,204,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996],"text":["date: 1973 Q1<br />price: 5270945<br />unclass(id): 16<br />id: 2012","date: 1973 Q2<br />price: 5380528<br />unclass(id): 16<br />id: 2012","date: 1973 Q3<br />price: 5369752<br />unclass(id): 16<br />id: 2012","date: 1973 Q4<br />price: 5517802<br />unclass(id): 16<br />id: 2012"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,185,227,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004],"text":["date: 1973 Q1<br />price: 5256450<br />unclass(id): 17<br />id: 2013","date: 1973 Q2<br />price: 5473377<br />unclass(id): 17<br />id: 2013","date: 1973 Q3<br />price: 5425704<br />unclass(id): 17<br />id: 2013","date: 1973 Q4<br />price: 5567030<br />unclass(id): 17<br />id: 2013"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(58,176,236,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998],"text":["date: 1973 Q1<br />price: 5386946<br />unclass(id): 18<br />id: 2014","date: 1973 Q2<br />price: 5580039<br />unclass(id): 18<br />id: 2014","date: 1973 Q3<br />price: 5564547<br />unclass(id): 18<br />id: 2014","date: 1973 Q4<br />price: 5734911<br />unclass(id): 18<br />id: 2014"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(81,166,246,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5542388.7000000002,5710754.5,5752936.4000000004,5862074.5999999996],"text":["date: 1973 Q1<br />price: 5542389<br />unclass(id): 19<br />id: 2015","date: 1973 Q2<br />price: 5710754<br />unclass(id): 19<br />id: 2015","date: 1973 Q3<br />price: 5752936<br />unclass(id): 19<br />id: 2015","date: 1973 Q4<br />price: 5862075<br />unclass(id): 19<br />id: 2015"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5634257.5999999996,5839988.7000000002,5803635.4000000004,5995609.0999999996],"text":["date: 1973 Q1<br />price: 5634258<br />unclass(id): 20<br />id: 2016","date: 1973 Q2<br />price: 5839989<br />unclass(id): 20<br />id: 2016","date: 1973 Q3<br />price: 5803635<br />unclass(id): 20<br />id: 2016","date: 1973 Q4<br />price: 5995609<br />unclass(id): 20<br />id: 2016"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,145,254,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5826518.0999999996,5927581.9000000004,5872816.4000000004,6082190.9000000004],"text":["date: 1973 Q1<br />price: 5826518<br />unclass(id): 21<br />id: 2017","date: 1973 Q2<br />price: 5927582<br />unclass(id): 21<br />id: 2017","date: 1973 Q3<br />price: 5872816<br />unclass(id): 21<br />id: 2017","date: 1973 Q4<br />price: 6082191<br />unclass(id): 21<br />id: 2017"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(187,131,252,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5892094.5,6098930.0999999996,6034322.0999999996,6151323.5999999996],"text":["date: 1973 Q1<br />price: 5892094<br />unclass(id): 22<br />id: 2018","date: 1973 Q2<br />price: 6098930<br />unclass(id): 22<br />id: 2018","date: 1973 Q3<br />price: 6034322<br />unclass(id): 22<br />id: 2018","date: 1973 Q4<br />price: 6151324<br />unclass(id): 22<br />id: 2018"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(219,114,251,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5947659.7999999998,6038713,6006224.7000000002,6089133.4000000004],"text":["date: 1973 Q1<br />price: 5947660<br />unclass(id): 23<br />id: 2019","date: 1973 Q2<br />price: 6038713<br />unclass(id): 23<br />id: 2019","date: 1973 Q3<br />price: 6006225<br />unclass(id): 23<br />id: 2019","date: 1973 Q4<br />price: 6089133<br />unclass(id): 23<br />id: 2019"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(233,109,232,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5862462.9000000004,4813194.7000000002,5518073.9000000004,5876203.2999999998],"text":["date: 1973 Q1<br />price: 5862463<br />unclass(id): 24<br />id: 2020","date: 1973 Q2<br />price: 4813195<br />unclass(id): 24<br />id: 2020","date: 1973 Q3<br />price: 5518074<br />unclass(id): 24<br />id: 2020","date: 1973 Q4<br />price: 5876203<br />unclass(id): 24<br />id: 2020"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(245,103,213,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5710343.2999999998,5905897.7999999998,5801172.5,5987417.5],"text":["date: 1973 Q1<br />price: 5710343<br />unclass(id): 25<br />id: 2021","date: 1973 Q2<br />price: 5905898<br />unclass(id): 25<br />id: 2021","date: 1973 Q3<br />price: 5801172<br />unclass(id): 25<br />id: 2021","date: 1973 Q4<br />price: 5987418<br />unclass(id): 25<br />id: 2021"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,97,195,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1369],"y":[4000000],"name":"26078b4206a36f2f9855a23b677e756a","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F8766D"],[0.0033444816053511683,"#F7776B"],[0.0066889632107023367,"#F67869"],[0.010033444816053514,"#F57967"],[0.013377926421404682,"#F47A65"],[0.016722408026755852,"#F47A63"],[0.020066889632107027,"#F37B61"],[0.023411371237458196,"#F27C5F"],[0.026755852842809364,"#F17D5D"],[0.030100334448160532,"#F07E5B"],[0.033444816053511704,"#EF7F59"],[0.03678929765886288,"#EE7F56"],[0.040133779264214048,"#ED8054"],[0.043478260869565223,"#EC8152"],[0.046822742474916391,"#EB8250"],[0.05016722408026756,"#EA834E"],[0.053511705685618728,"#E9834C"],[0.056856187290969896,"#E88449"],[0.060200668896321065,"#E78547"],[0.06354515050167224,"#E68645"],[0.066889632107023408,"#E58642"],[0.070234113712374577,"#E48740"],[0.073578595317725759,"#E3883D"],[0.076923076923076927,"#E2883B"],[0.080267558528428096,"#E18938"],[0.083612040133779264,"#E08A36"],[0.086956521739130432,"#DF8B33"],[0.090301003344481601,"#DE8B30"],[0.093645484949832783,"#DD8C2D"],[0.096989966555183951,"#DC8D2A"],[0.10033444816053512,"#DB8D27"],[0.10367892976588629,"#DA8E24"],[0.10702341137123746,"#D98F20"],[0.11036789297658862,"#D88F1C"],[0.11371237458193979,"#D79017"],[0.11705685618729096,"#D69112"],[0.12040133779264213,"#D5910B"],[0.12374581939799333,"#D39203"],[0.12709030100334448,"#D29200"],[0.13043478260869565,"#D09300"],[0.13377926421404682,"#CF9400"],[0.13712374581939799,"#CD9500"],[0.14046822742474915,"#CC9600"],[0.14381270903010032,"#CA9600"],[0.14715719063545152,"#C99700"],[0.15050167224080269,"#C79800"],[0.15384615384615385,"#C59800"],[0.15719063545150502,"#C49900"],[0.16053511705685619,"#C29A00"],[0.16387959866220736,"#C19B00"],[0.16722408026755853,"#BF9B00"],[0.1705685618729097,"#BD9C00"],[0.17391304347826086,"#BC9D00"],[0.17725752508361203,"#BA9D00"],[0.1806020066889632,"#B89E00"],[0.18394648829431437,"#B79F00"],[0.18729096989966557,"#B59F00"],[0.19063545150501673,"#B3A000"],[0.1939799331103679,"#B2A000"],[0.19732441471571907,"#B0A100"],[0.20066889632107024,"#AEA200"],[0.20401337792642141,"#ACA200"],[0.20735785953177258,"#ABA300"],[0.21070234113712374,"#A9A300"],[0.21404682274247491,"#A7A400"],[0.21739130434782608,"#A5A500"],[0.22073578595317725,"#A4A500"],[0.22408026755852842,"#A2A600"],[0.22742474916387959,"#A0A600"],[0.23076923076923075,"#9EA700"],[0.23411371237458192,"#9CA700"],[0.23745819397993309,"#9AA800"],[0.24080267558528426,"#98A900"],[0.24414715719063548,"#96A900"],[0.24749163879598665,"#94AA00"],[0.25083612040133779,"#93AA01"],[0.25418060200668896,"#91AB03"],[0.25752508361204013,"#8EAB06"],[0.2608695652173913,"#8CAC09"],[0.26421404682274247,"#8AAC0C"],[0.26755852842809363,"#88AD0E"],[0.2709030100334448,"#86AD10"],[0.27424749163879597,"#84AE12"],[0.27759197324414714,"#82AE14"],[0.28093645484949831,"#80AE16"],[0.28428093645484948,"#7DAF18"],[0.28762541806020064,"#7BAF19"],[0.29096989966555181,"#79B01B"],[0.29431438127090304,"#76B01C"],[0.2976588628762542,"#74B11E"],[0.30100334448160537,"#71B11F"],[0.30434782608695654,"#6FB221"],[0.30769230769230771,"#6CB222"],[0.31103678929765888,"#69B223"],[0.31438127090301005,"#67B324"],[0.31772575250836121,"#64B326"],[0.32107023411371238,"#61B427"],[0.32441471571906355,"#5EB428"],[0.32775919732441472,"#5BB529"],[0.33110367892976589,"#57B52A"],[0.33444816053511706,"#54B52B"],[0.33779264214046822,"#50B62D"],[0.34113712374581939,"#4DB62E"],[0.34448160535117056,"#49B72F"],[0.34782608695652173,"#45B730"],[0.3511705685618729,"#40B731"],[0.35451505016722407,"#3BB832"],[0.35785953177257523,"#36B833"],[0.3612040133779264,"#30B834"],[0.36454849498327757,"#29B935"],[0.36789297658862874,"#21B936"],[0.37123745819397991,"#16BA37"],[0.37458193979933113,"#03BA38"],[0.3779264214046823,"#03BA3B"],[0.38127090301003347,"#07BA3E"],[0.38461538461538464,"#0ABB42"],[0.38795986622073581,"#0DBB45"],[0.39130434782608697,"#0FBB48"],[0.39464882943143814,"#11BB4B"],[0.39799331103678931,"#13BB4E"],[0.40133779264214048,"#14BB51"],[0.40468227424749165,"#16BC54"],[0.40802675585284282,"#17BC56"],[0.41137123745819398,"#18BC59"],[0.41471571906354515,"#19BC5C"],[0.41806020066889632,"#1ABC5F"],[0.42140468227424749,"#1ABD62"],[0.42474916387959866,"#1BBD64"],[0.42809364548494983,"#1BBD67"],[0.43143812709030099,"#1BBD6A"],[0.43478260869565216,"#1CBD6C"],[0.43812709030100333,"#1CBD6F"],[0.4414715719063545,"#1CBE72"],[0.44481605351170567,"#1CBE74"],[0.44816053511705684,"#1CBE77"],[0.451505016722408,"#1BBE7A"],[0.45484949832775917,"#1BBE7C"],[0.45819397993311034,"#1ABF7F"],[0.46153846153846151,"#1ABF81"],[0.46488294314381268,"#19BF84"],[0.46822742474916385,"#18BF87"],[0.47157190635451501,"#17BF89"],[0.47491638795986618,"#16C08C"],[0.47826086956521735,"#14C08E"],[0.48160535117056852,"#12C091"],[0.4849498327759198,"#10C093"],[0.48829431438127097,"#0EC096"],[0.49163879598662213,"#0AC199"],[0.4949832775919733,"#06C19B"],[0.49832775919732447,"#02C19E"],[0.50167224080267558,"#01C1A0"],[0.50501672240802675,"#04C1A2"],[0.50836120401337792,"#06C0A4"],[0.51170568561872909,"#09C0A5"],[0.51505016722408026,"#0BC0A7"],[0.51839464882943143,"#0DC0A9"],[0.52173913043478259,"#0EC0AB"],[0.52508361204013376,"#0FBFAD"],[0.52842809364548493,"#11BFAF"],[0.5317725752508361,"#12BFB0"],[0.53511705685618727,"#13BFB2"],[0.53846153846153844,"#13BFB4"],[0.5418060200668896,"#14BEB6"],[0.54515050167224077,"#15BEB8"],[0.54849498327759194,"#15BEB9"],[0.55183946488294311,"#15BEBB"],[0.55518394648829428,"#16BEBD"],[0.55852842809364545,"#16BDBF"],[0.56187290969899661,"#16BDC1"],[0.56521739130434778,"#16BDC2"],[0.56856187290969895,"#16BDC4"],[0.57190635451505012,"#16BCC6"],[0.57525083612040129,"#15BCC8"],[0.57859531772575246,"#15BCCA"],[0.58193979933110362,"#15BCCC"],[0.58528428093645479,"#14BCCD"],[0.58862876254180607,"#13BBCF"],[0.59197324414715724,"#13BBD1"],[0.59531772575250841,"#12BBD3"],[0.59866220735785958,"#11BBD5"],[0.60200668896321075,"#0FBBD6"],[0.60535117056856191,"#0EBAD8"],[0.60869565217391308,"#0CBADA"],[0.61204013377926425,"#0ABADC"],[0.61538461538461542,"#08BADE"],[0.61872909698996659,"#05B9E0"],[0.62207357859531776,"#03B9E1"],[0.62541806020066881,"#01B9E3"],[0.62876254180602009,"#0DB8E4"],[0.63210702341137137,"#15B7E5"],[0.63545150501672243,"#1BB7E5"],[0.63879598662207349,"#20B6E6"],[0.64214046822742477,"#24B5E7"],[0.64548494983277604,"#28B4E8"],[0.6488294314381271,"#2BB4E8"],[0.65217391304347816,"#2EB3E9"],[0.65551839464882944,"#31B2EA"],[0.65886287625418072,"#34B1EB"],[0.66220735785953178,"#37B1EB"],[0.66555183946488283,"#39B0EC"],[0.66889632107023411,"#3BAFED"],[0.67224080267558539,"#3EAEEE"],[0.67558528428093645,"#40AEEE"],[0.67892976588628773,"#42ADEF"],[0.68227424749163879,"#44ACF0"],[0.68561872909699006,"#46ABF1"],[0.68896321070234112,"#47ABF1"],[0.6923076923076924,"#49AAF2"],[0.69565217391304346,"#4BA9F3"],[0.69899665551839474,"#4CA8F4"],[0.7023411371237458,"#4EA8F4"],[0.70568561872909707,"#50A7F5"],[0.70903010033444813,"#51A6F6"],[0.71237458193979941,"#53A5F7"],[0.71571906354515047,"#54A4F7"],[0.71906354515050175,"#55A4F8"],[0.72240802675585281,"#57A3F9"],[0.72575250836120409,"#58A2FA"],[0.72909698996655514,"#59A1FA"],[0.73244147157190642,"#5BA0FB"],[0.73578595317725748,"#5CA0FC"],[0.73913043478260876,"#5D9FFD"],[0.74247491638795982,"#5E9EFD"],[0.7458193979933111,"#609DFE"],[0.74916387959866226,"#619CFF"],[0.75250836120401343,"#659BFF"],[0.7558528428093646,"#6A9BFF"],[0.75919732441471577,"#6F9AFF"],[0.76254180602006694,"#7399FF"],[0.76588628762541811,"#7798FE"],[0.76923076923076927,"#7C97FE"],[0.77257525083612044,"#8096FE"],[0.77591973244147161,"#8495FE"],[0.77926421404682278,"#8794FE"],[0.78260869565217395,"#8B94FE"],[0.78595317725752512,"#8F93FE"],[0.78929765886287628,"#9292FE"],[0.79264214046822745,"#9691FE"],[0.79598662207357862,"#9990FD"],[0.79933110367892979,"#9C8FFD"],[0.80267558528428096,"#9F8EFD"],[0.80602006688963213,"#A38DFD"],[0.80936454849498329,"#A68CFD"],[0.81270903010033446,"#A98AFD"],[0.81605351170568563,"#AC89FD"],[0.8193979933110368,"#AF88FD"],[0.82274247491638797,"#B287FD"],[0.82608695652173914,"#B486FD"],[0.8294314381270903,"#B785FC"],[0.83277591973244147,"#BA84FC"],[0.83612040133779264,"#BD82FC"],[0.83946488294314381,"#C081FC"],[0.84280936454849498,"#C280FC"],[0.84615384615384615,"#C57EFC"],[0.84949832775919731,"#C87DFC"],[0.85284280936454848,"#CA7CFC"],[0.85618729096989965,"#CD7AFC"],[0.85953177257525093,"#CF79FB"],[0.86287625418060199,"#D278FB"],[0.86622073578595327,"#D476FB"],[0.86956521739130432,"#D775FB"],[0.8729096989966556,"#D973FB"],[0.87625418060200666,"#DB72FA"],[0.87959866220735794,"#DD71F9"],[0.882943143812709,"#DE71F7"],[0.88628762541806028,"#DF71F6"],[0.88963210702341133,"#E070F4"],[0.89297658862876261,"#E170F3"],[0.89632107023411367,"#E26FF1"],[0.89966555183946495,"#E36FF0"],[0.90301003344481601,"#E56EEE"],[0.90635451505016729,"#E66EED"],[0.90969899665551834,"#E76DEB"],[0.91304347826086962,"#E86DEA"],[0.91638795986622068,"#E96DE8"],[0.91973244147157196,"#EA6CE7"],[0.92307692307692302,"#EB6CE5"],[0.9264214046822743,"#EC6BE4"],[0.92976588628762535,"#ED6BE2"],[0.93311036789297663,"#EE6AE1"],[0.93645484949832769,"#EF6ADF"],[0.93979933110367897,"#F069DE"],[0.94314381270903003,"#F169DC"],[0.94648829431438131,"#F168DB"],[0.94983277591973236,"#F268D9"],[0.95317725752508364,"#F368D8"],[0.9565217391304347,"#F467D6"],[0.95986622073578598,"#F567D5"],[0.96321070234113704,"#F666D3"],[0.96655518394648832,"#F766D2"],[0.9698996655518396,"#F865D0"],[0.97324414715719065,"#F965CF"],[0.97658862876254193,"#F964CD"],[0.97993311036789299,"#FA64CC"],[0.98327759197324427,"#FB63CA"],[0.98662207357859533,"#FC63C9"],[0.98996655518394661,"#FD62C7"],[0.99331103678929766,"#FD62C6"],[0.99665551839464894,"#FE61C4"],[1,"#FF61C3"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["2001","2006","2011","2016","2021"],"tickvals":[0.16777777777777778,0.37541666666666662,0.58305555555555555,0.79069444444444437,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1082.3499999999999,1382.6500000000001],"tickmode":"array","ticktext":["Q4","Q1","Q2","Q3"],"tickvals":[1369,1096,1186,1277],"categoryorder":"array","categoryarray":["Q4","Q1","Q2","Q3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.5099999998,6273769.8899999997],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1902e7e3689":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"1902e7e3689","visdat":{"1902e7e3689":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="ts-decomposition" class="level3" data-number="1.3.1"><h3 data-number="1.3.1" class="anchored" data-anchor-id="ts-decomposition">
<span class="header-section-number">1.3.1</span> TS Decomposition</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">model</span><span class="op">(</span>stl <span class="op">=</span> <span class="fu">STL</span><span class="op">(</span><span class="va">price</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">components</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c267fcce1113b7efa07f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c267fcce1113b7efa07f">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5,4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999,4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002,4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998,4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004,4269784.4000000004,4504199.5,4457000.9000000004,4458615,4402401.5,4520666,4464786.7999999998,4511463.5999999996,4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996,4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998,4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998,4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002,4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996,4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002,4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004,5022838,5170733.5,5237545.4000000004,5368843.5999999996,5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996,5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004,5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998,5542388.7000000002,5710754.5,5752936.4000000004,5862074.5999999996,5634257.5999999996,5839988.7000000002,5803635.4000000004,5995609.0999999996,5826518.0999999996,5927581.9000000004,5872816.4000000004,6082190.9000000004,5892094.5,6098930.0999999996,6034322.0999999996,6151323.5999999996,5947659.7999999998,6038713,6006224.7000000002,6089133.4000000004,5862462.9000000004,4813194.7000000002,5518073.9000000004,5876203.2999999998,5710343.2999999998,5905897.7999999998,5801172.5,5987417.5],"text":["date: 1997 Q1<br />.val: 3702397.80000","date: 1997 Q2<br />.val: 3896083.90000","date: 1997 Q3<br />.val: 3906063.00000","date: 1997 Q4<br />.val: 4038358.50000","date: 1998 Q1<br />.val: 4084303.50000","date: 1998 Q2<br />.val: 4134899.40000","date: 1998 Q3<br />.val: 4138199.80000","date: 1998 Q4<br />.val: 4146841.40000","date: 1999 Q1<br />.val: 4176243.30000","date: 1999 Q2<br />.val: 4232279.50000","date: 1999 Q3<br />.val: 4262620.60000","date: 1999 Q4<br />.val: 4287797.70000","date: 2000 Q1<br />.val: 4412426.30000","date: 2000 Q2<br />.val: 4465504.20000","date: 2000 Q3<br />.val: 4505221.10000","date: 2000 Q4<br />.val: 4428702.80000","date: 2001 Q1<br />.val: 4441058.20000","date: 2001 Q2<br />.val: 4468504.80000","date: 2001 Q3<br />.val: 4440265.00000","date: 2001 Q4<br />.val: 4381722.40000","date: 2002 Q1<br />.val: 4269784.40000","date: 2002 Q2<br />.val: 4504199.50000","date: 2002 Q3<br />.val: 4457000.90000","date: 2002 Q4<br />.val: 4458615.00000","date: 2003 Q1<br />.val: 4402401.50000","date: 2003 Q2<br />.val: 4520666.00000","date: 2003 Q3<br />.val: 4464786.80000","date: 2003 Q4<br />.val: 4511463.60000","date: 2004 Q1<br />.val: 4546253.90000","date: 2004 Q2<br />.val: 4692565.10000","date: 2004 Q3<br />.val: 4615345.00000","date: 2004 Q4<br />.val: 4683343.60000","date: 2005 Q1<br />.val: 4567922.10000","date: 2005 Q2<br />.val: 4804678.80000","date: 2005 Q3<br />.val: 4720817.70000","date: 2005 Q4<br />.val: 4835832.30000","date: 2006 Q1<br />.val: 4840642.70000","date: 2006 Q2<br />.val: 5029028.20000","date: 2006 Q3<br />.val: 4959002.20000","date: 2006 Q4<br />.val: 5010130.80000","date: 2007 Q1<br />.val: 4936399.30000","date: 2007 Q2<br />.val: 5127368.00000","date: 2007 Q3<br />.val: 5066708.80000","date: 2007 Q4<br />.val: 5120551.20000","date: 2008 Q1<br />.val: 4975730.40000","date: 2008 Q2<br />.val: 5249626.00000","date: 2008 Q3<br />.val: 5123968.20000","date: 2008 Q4<br />.val: 5092737.10000","date: 2009 Q1<br />.val: 4634314.80000","date: 2009 Q2<br />.val: 4706890.80000","date: 2009 Q3<br />.val: 4823052.40000","date: 2009 Q4<br />.val: 4990924.70000","date: 2010 Q1<br />.val: 4842967.70000","date: 2010 Q2<br />.val: 5045140.30000","date: 2010 Q3<br />.val: 5050199.50000","date: 2010 Q4<br />.val: 5169143.40000","date: 2011 Q1<br />.val: 5022838.00000","date: 2011 Q2<br />.val: 5170733.50000","date: 2011 Q3<br />.val: 5237545.40000","date: 2011 Q4<br />.val: 5368843.60000","date: 2012 Q1<br />.val: 5270945.10000","date: 2012 Q2<br />.val: 5380528.20000","date: 2012 Q3<br />.val: 5369752.10000","date: 2012 Q4<br />.val: 5517801.60000","date: 2013 Q1<br />.val: 5256450.30000","date: 2013 Q2<br />.val: 5473377.10000","date: 2013 Q3<br />.val: 5425704.10000","date: 2013 Q4<br />.val: 5567029.90000","date: 2014 Q1<br />.val: 5386945.60000","date: 2014 Q2<br />.val: 5580039.00000","date: 2014 Q3<br />.val: 5564547.10000","date: 2014 Q4<br />.val: 5734911.30000","date: 2015 Q1<br />.val: 5542388.70000","date: 2015 Q2<br />.val: 5710754.50000","date: 2015 Q3<br />.val: 5752936.40000","date: 2015 Q4<br />.val: 5862074.60000","date: 2016 Q1<br />.val: 5634257.60000","date: 2016 Q2<br />.val: 5839988.70000","date: 2016 Q3<br />.val: 5803635.40000","date: 2016 Q4<br />.val: 5995609.10000","date: 2017 Q1<br />.val: 5826518.10000","date: 2017 Q2<br />.val: 5927581.90000","date: 2017 Q3<br />.val: 5872816.40000","date: 2017 Q4<br />.val: 6082190.90000","date: 2018 Q1<br />.val: 5892094.50000","date: 2018 Q2<br />.val: 6098930.10000","date: 2018 Q3<br />.val: 6034322.10000","date: 2018 Q4<br />.val: 6151323.60000","date: 2019 Q1<br />.val: 5947659.80000","date: 2019 Q2<br />.val: 6038713.00000","date: 2019 Q3<br />.val: 6006224.70000","date: 2019 Q4<br />.val: 6089133.40000","date: 2020 Q1<br />.val: 5862462.90000","date: 2020 Q2<br />.val: 4813194.70000","date: 2020 Q3<br />.val: 5518073.90000","date: 2020 Q4<br />.val: 5876203.30000","date: 2021 Q1<br />.val: 5710343.30000","date: 2021 Q2<br />.val: 5905897.80000","date: 2021 Q3<br />.val: 5801172.50000","date: 2021 Q4<br />.val: 5987417.50000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[3750277.2449368061,3826573.8250097861,3898125.1883673109,3962837.0547033302,4021888.6320988256,4081388.2749637258,4127892.3334311824,4170643.0432970142,4204765.4110622779,4237913.2964053275,4270696.0216923263,4310158.2899254663,4357557.506164128,4393590.3314215541,4427030.8942838013,4442210.5749766631,4445935.8882504525,4438485.6543682255,4423109.6235508546,4424533.5728612226,4431646.3417199338,4442794.4031900615,4457841.1412273217,4458419.6958204992,4459603.9726022165,4466260.6279711071,4490723.5995795494,4531957.0768688563,4574043.006996816,4613335.0654204227,4645508.5884120725,4673674.5271166358,4701324.783906945,4732005.8440363016,4770992.0353492387,4829803.7051671417,4889171.5387249626,4938869.9487210158,4971754.8153784387,4995662.1778969578,5021479.695392821,5048635.7175399419,5067700.0674285879,5074975.2964173835,5066631.944151531,5058318.9199243579,5049092.9431202412,5041252.533837012,4971393.9338662736,4919992.8339746008,4838611.2171427011,4899874.4774962682,4954309.5758228796,5003303.166388032,5048501.5773228481,5092974.7437919173,5137673.9450000683,5185878.9228673307,5233607.4948589439,5276464.2782269642,5311652.8587929523,5345843.5752426125,5377027.601049982,5396190.7756882105,5414549.2655972224,5427190.0519248256,5447138.2717049271,5474894.9866167195,5507428.1233769413,5546152.8448920688,5585591.3773688972,5622190.4191858955,5654781.1067746235,5685410.8551945742,5712188.4343136465,5739581.2329783104,5770219.4419214688,5801296.836866538,5838985.6917749317,5865218.7223158712,5883571.6998928469,5902120.474002175,5924991.8017703518,5965410.6775662294,6007006.2650652165,6034070.0598138589,6049445.5421099737,6049781.4417613316,6038592.2696144711,6027115.6901180595,6007745.7623478752,5986987.5710574826,5822408.3014592137,5687733.7276410423,5541845.6135853957,5541845.6135853957,5683272.0560125895,5750778.905616466,5818035.3920971472,5883687.9414222408],"text":["date: 1997 Q1<br />.val: 3750277.24494","date: 1997 Q2<br />.val: 3826573.82501","date: 1997 Q3<br />.val: 3898125.18837","date: 1997 Q4<br />.val: 3962837.05470","date: 1998 Q1<br />.val: 4021888.63210","date: 1998 Q2<br />.val: 4081388.27496","date: 1998 Q3<br />.val: 4127892.33343","date: 1998 Q4<br />.val: 4170643.04330","date: 1999 Q1<br />.val: 4204765.41106","date: 1999 Q2<br />.val: 4237913.29641","date: 1999 Q3<br />.val: 4270696.02169","date: 1999 Q4<br />.val: 4310158.28993","date: 2000 Q1<br />.val: 4357557.50616","date: 2000 Q2<br />.val: 4393590.33142","date: 2000 Q3<br />.val: 4427030.89428","date: 2000 Q4<br />.val: 4442210.57498","date: 2001 Q1<br />.val: 4445935.88825","date: 2001 Q2<br />.val: 4438485.65437","date: 2001 Q3<br />.val: 4423109.62355","date: 2001 Q4<br />.val: 4424533.57286","date: 2002 Q1<br />.val: 4431646.34172","date: 2002 Q2<br />.val: 4442794.40319","date: 2002 Q3<br />.val: 4457841.14123","date: 2002 Q4<br />.val: 4458419.69582","date: 2003 Q1<br />.val: 4459603.97260","date: 2003 Q2<br />.val: 4466260.62797","date: 2003 Q3<br />.val: 4490723.59958","date: 2003 Q4<br />.val: 4531957.07687","date: 2004 Q1<br />.val: 4574043.00700","date: 2004 Q2<br />.val: 4613335.06542","date: 2004 Q3<br />.val: 4645508.58841","date: 2004 Q4<br />.val: 4673674.52712","date: 2005 Q1<br />.val: 4701324.78391","date: 2005 Q2<br />.val: 4732005.84404","date: 2005 Q3<br />.val: 4770992.03535","date: 2005 Q4<br />.val: 4829803.70517","date: 2006 Q1<br />.val: 4889171.53872","date: 2006 Q2<br />.val: 4938869.94872","date: 2006 Q3<br />.val: 4971754.81538","date: 2006 Q4<br />.val: 4995662.17790","date: 2007 Q1<br />.val: 5021479.69539","date: 2007 Q2<br />.val: 5048635.71754","date: 2007 Q3<br />.val: 5067700.06743","date: 2007 Q4<br />.val: 5074975.29642","date: 2008 Q1<br />.val: 5066631.94415","date: 2008 Q2<br />.val: 5058318.91992","date: 2008 Q3<br />.val: 5049092.94312","date: 2008 Q4<br />.val: 5041252.53384","date: 2009 Q1<br />.val: 4971393.93387","date: 2009 Q2<br />.val: 4919992.83397","date: 2009 Q3<br />.val: 4838611.21714","date: 2009 Q4<br />.val: 4899874.47750","date: 2010 Q1<br />.val: 4954309.57582","date: 2010 Q2<br />.val: 5003303.16639","date: 2010 Q3<br />.val: 5048501.57732","date: 2010 Q4<br />.val: 5092974.74379","date: 2011 Q1<br />.val: 5137673.94500","date: 2011 Q2<br />.val: 5185878.92287","date: 2011 Q3<br />.val: 5233607.49486","date: 2011 Q4<br />.val: 5276464.27823","date: 2012 Q1<br />.val: 5311652.85879","date: 2012 Q2<br />.val: 5345843.57524","date: 2012 Q3<br />.val: 5377027.60105","date: 2012 Q4<br />.val: 5396190.77569","date: 2013 Q1<br />.val: 5414549.26560","date: 2013 Q2<br />.val: 5427190.05192","date: 2013 Q3<br />.val: 5447138.27170","date: 2013 Q4<br />.val: 5474894.98662","date: 2014 Q1<br />.val: 5507428.12338","date: 2014 Q2<br />.val: 5546152.84489","date: 2014 Q3<br />.val: 5585591.37737","date: 2014 Q4<br />.val: 5622190.41919","date: 2015 Q1<br />.val: 5654781.10677","date: 2015 Q2<br />.val: 5685410.85519","date: 2015 Q3<br />.val: 5712188.43431","date: 2015 Q4<br />.val: 5739581.23298","date: 2016 Q1<br />.val: 5770219.44192","date: 2016 Q2<br />.val: 5801296.83687","date: 2016 Q3<br />.val: 5838985.69177","date: 2016 Q4<br />.val: 5865218.72232","date: 2017 Q1<br />.val: 5883571.69989","date: 2017 Q2<br />.val: 5902120.47400","date: 2017 Q3<br />.val: 5924991.80177","date: 2017 Q4<br />.val: 5965410.67757","date: 2018 Q1<br />.val: 6007006.26507","date: 2018 Q2<br />.val: 6034070.05981","date: 2018 Q3<br />.val: 6049445.54211","date: 2018 Q4<br />.val: 6049781.44176","date: 2019 Q1<br />.val: 6038592.26961","date: 2019 Q2<br />.val: 6027115.69012","date: 2019 Q3<br />.val: 6007745.76235","date: 2019 Q4<br />.val: 5986987.57106","date: 2020 Q1<br />.val: 5822408.30146","date: 2020 Q2<br />.val: 5687733.72764","date: 2020 Q3<br />.val: 5541845.61359","date: 2020 Q4<br />.val: 5541845.61359","date: 2021 Q1<br />.val: 5683272.05601","date: 2021 Q2<br />.val: 5750778.90562","date: 2021 Q3<br />.val: 5818035.39210","date: 2021 Q4<br />.val: 5883687.94142"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-35685.174961509183,58151.225274071534,-2912.059451161851,-19485.493555256216,-35605.206459538706,58298.080411709998,-3764.949645006332,-18846.8930781288,-35545.988834790958,58400.022526318033,-4678.6115222539211,-18258.161943655032,-34828.10106909326,58656.127445384634,-6966.3205019868219,-16989.33759480184,-33983.600959452611,59104.224719221202,-8969.3906099570413,-15383.361193098141,-36014.431775814752,61783.940127982481,-13342.220570229998,-10603.778477332206,-38238.024201222419,64624.441290859446,-17132.772227455276,-5043.5199709658882,-47830.841830133882,69048.292761051765,-18829.75992969982,4363.5016212195769,-58566.005757617706,72639.603017173824,-21001.882159957455,13472.9277457471,-68365.418286258646,72052.810154506704,-20073.451444231425,24804.494632306294,-78933.178047474968,71187.448960100563,-18755.04237498188,37167.470962750827,-89043.361686712306,62126.115119617345,-13703.672519810698,51484.566162987961,-99074.309157977652,52976.137994236109,-8624.3339247959047,66186.54726060915,-107973.67345506935,45303.405064082799,-7990.6044968068618,79557.376373637657,-115817.91182397479,37806.360785685167,-8192.6069363652023,91261.048252911409,-119703.81905601424,36066.881954829332,-11145.732661672801,98929.624279723852,-123515.92545467521,34402.93831561898,-14283.314401860009,106209.25711107292,-124220.74164920326,34375.556693818879,-19607.300448997768,110267.33923691412,-124168.13169355465,34707.874710485077,-25135.116952013512,113608.79976861921,-121257.05988986223,32935.392548850155,-25244.882224992511,112232.04636537995,-118307.54086843089,31447.782587520371,-24953.66638707116,111277.4358440241,-117441.23776265523,30974.740316603067,-24494.433573379629,110432.53546102261,-116558.16643293409,30508.21760305472,-24014.355336100485,109623.44424769592,-115898.91210455399,30210.842453572215,-23771.713585395224,109084.16826505733,-115258.2461243705,29901.535370913803,-23525.998439783591,108561.86470996324],"text":["date: 1997 Q1<br />.val:  -35685.17496","date: 1997 Q2<br />.val:   58151.22527","date: 1997 Q3<br />.val:   -2912.05945","date: 1997 Q4<br />.val:  -19485.49356","date: 1998 Q1<br />.val:  -35605.20646","date: 1998 Q2<br />.val:   58298.08041","date: 1998 Q3<br />.val:   -3764.94965","date: 1998 Q4<br />.val:  -18846.89308","date: 1999 Q1<br />.val:  -35545.98883","date: 1999 Q2<br />.val:   58400.02253","date: 1999 Q3<br />.val:   -4678.61152","date: 1999 Q4<br />.val:  -18258.16194","date: 2000 Q1<br />.val:  -34828.10107","date: 2000 Q2<br />.val:   58656.12745","date: 2000 Q3<br />.val:   -6966.32050","date: 2000 Q4<br />.val:  -16989.33759","date: 2001 Q1<br />.val:  -33983.60096","date: 2001 Q2<br />.val:   59104.22472","date: 2001 Q3<br />.val:   -8969.39061","date: 2001 Q4<br />.val:  -15383.36119","date: 2002 Q1<br />.val:  -36014.43178","date: 2002 Q2<br />.val:   61783.94013","date: 2002 Q3<br />.val:  -13342.22057","date: 2002 Q4<br />.val:  -10603.77848","date: 2003 Q1<br />.val:  -38238.02420","date: 2003 Q2<br />.val:   64624.44129","date: 2003 Q3<br />.val:  -17132.77223","date: 2003 Q4<br />.val:   -5043.51997","date: 2004 Q1<br />.val:  -47830.84183","date: 2004 Q2<br />.val:   69048.29276","date: 2004 Q3<br />.val:  -18829.75993","date: 2004 Q4<br />.val:    4363.50162","date: 2005 Q1<br />.val:  -58566.00576","date: 2005 Q2<br />.val:   72639.60302","date: 2005 Q3<br />.val:  -21001.88216","date: 2005 Q4<br />.val:   13472.92775","date: 2006 Q1<br />.val:  -68365.41829","date: 2006 Q2<br />.val:   72052.81015","date: 2006 Q3<br />.val:  -20073.45144","date: 2006 Q4<br />.val:   24804.49463","date: 2007 Q1<br />.val:  -78933.17805","date: 2007 Q2<br />.val:   71187.44896","date: 2007 Q3<br />.val:  -18755.04237","date: 2007 Q4<br />.val:   37167.47096","date: 2008 Q1<br />.val:  -89043.36169","date: 2008 Q2<br />.val:   62126.11512","date: 2008 Q3<br />.val:  -13703.67252","date: 2008 Q4<br />.val:   51484.56616","date: 2009 Q1<br />.val:  -99074.30916","date: 2009 Q2<br />.val:   52976.13799","date: 2009 Q3<br />.val:   -8624.33392","date: 2009 Q4<br />.val:   66186.54726","date: 2010 Q1<br />.val: -107973.67346","date: 2010 Q2<br />.val:   45303.40506","date: 2010 Q3<br />.val:   -7990.60450","date: 2010 Q4<br />.val:   79557.37637","date: 2011 Q1<br />.val: -115817.91182","date: 2011 Q2<br />.val:   37806.36079","date: 2011 Q3<br />.val:   -8192.60694","date: 2011 Q4<br />.val:   91261.04825","date: 2012 Q1<br />.val: -119703.81906","date: 2012 Q2<br />.val:   36066.88195","date: 2012 Q3<br />.val:  -11145.73266","date: 2012 Q4<br />.val:   98929.62428","date: 2013 Q1<br />.val: -123515.92545","date: 2013 Q2<br />.val:   34402.93832","date: 2013 Q3<br />.val:  -14283.31440","date: 2013 Q4<br />.val:  106209.25711","date: 2014 Q1<br />.val: -124220.74165","date: 2014 Q2<br />.val:   34375.55669","date: 2014 Q3<br />.val:  -19607.30045","date: 2014 Q4<br />.val:  110267.33924","date: 2015 Q1<br />.val: -124168.13169","date: 2015 Q2<br />.val:   34707.87471","date: 2015 Q3<br />.val:  -25135.11695","date: 2015 Q4<br />.val:  113608.79977","date: 2016 Q1<br />.val: -121257.05989","date: 2016 Q2<br />.val:   32935.39255","date: 2016 Q3<br />.val:  -25244.88222","date: 2016 Q4<br />.val:  112232.04637","date: 2017 Q1<br />.val: -118307.54087","date: 2017 Q2<br />.val:   31447.78259","date: 2017 Q3<br />.val:  -24953.66639","date: 2017 Q4<br />.val:  111277.43584","date: 2018 Q1<br />.val: -117441.23776","date: 2018 Q2<br />.val:   30974.74032","date: 2018 Q3<br />.val:  -24494.43357","date: 2018 Q4<br />.val:  110432.53546","date: 2019 Q1<br />.val: -116558.16643","date: 2019 Q2<br />.val:   30508.21760","date: 2019 Q3<br />.val:  -24014.35534","date: 2019 Q4<br />.val:  109623.44425","date: 2020 Q1<br />.val: -115898.91210","date: 2020 Q2<br />.val:   30210.84245","date: 2020 Q3<br />.val:  -23771.71359","date: 2020 Q4<br />.val:  109084.16827","date: 2021 Q1<br />.val: -115258.24612","date: 2021 Q2<br />.val:   29901.53537","date: 2021 Q3<br />.val:  -23525.99844","date: 2021 Q4<br />.val:  108561.86471"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-12194.269975297153,11358.849716142286,10849.871083850972,95006.93885192601,98020.074360712897,-4786.9553754357621,14072.416213823948,-4954.7502188854851,7023.877772513777,-64033.818931645714,-3396.8101700730622,-4102.4279818106443,89696.894904965535,13257.741133061238,85156.526218185201,3481.5626181382686,29105.91270900052,-29085.079087446444,26124.767059102654,-27427.81166812405,-125847.50994411856,-378.84331804420799,12501.979342908598,10799.082656833343,-18964.448400993831,-10219.069261966273,-8804.0273520946503,-15449.956897891127,20041.734833317809,10181.741818524897,-11333.828482372686,5305.5712621444836,-74836.678149327636,33.352946524508297,-29172.453189280815,-7444.3329128893092,19836.579561295919,18105.441124477424,7320.8360657924786,-10335.872529264539,-6147.2173453457654,7544.8334999578074,17763.774946393445,8408.4326198659837,-1858.1824648184702,129180.96495602466,88578.929399569519,0,-238004.82470829599,-266078.17196883727,-6934.4832179052755,24863.675243122503,-3368.2023678096011,-3466.2714521149173,9688.5271739587188,-3388.7201655544341,981.96682390663773,-52951.783653016202,12130.512077421881,1118.2735201241449,78996.060263061896,-1382.2571974415332,3870.231611690484,22681.200032065623,-34583.040142547339,11784.109759555198,-7150.8573030671105,-14074.343727791682,3738.2182722613215,-489.40158588718623,-1436.9769198996946,2453.5415771901608,11775.724918931723,-9364.2299050595611,65883.082638367079,8884.5672530699521,-14704.782031606883,5756.4705846123397,-10105.409549938515,18158.331318748184,61253.94097558409,-5986.3565896954387,-27221.735383280553,5502.7865897472948,2529.4726974386722,33885.299869537354,9370.9914634050801,-8890.3772223545238,25625.696818462573,-18910.907721114345,22493.292988225818,-7477.6153051778674,155953.5106453402,-904749.8700946141,0,225273.51814954635,142329.49011178128,125217.35901261959,6663.1063426360488,-4832.3061322038993],"text":["date: 1997 Q1<br />.val:  -12194.26998","date: 1997 Q2<br />.val:   11358.84972","date: 1997 Q3<br />.val:   10849.87108","date: 1997 Q4<br />.val:   95006.93885","date: 1998 Q1<br />.val:   98020.07436","date: 1998 Q2<br />.val:   -4786.95538","date: 1998 Q3<br />.val:   14072.41621","date: 1998 Q4<br />.val:   -4954.75022","date: 1999 Q1<br />.val:    7023.87777","date: 1999 Q2<br />.val:  -64033.81893","date: 1999 Q3<br />.val:   -3396.81017","date: 1999 Q4<br />.val:   -4102.42798","date: 2000 Q1<br />.val:   89696.89490","date: 2000 Q2<br />.val:   13257.74113","date: 2000 Q3<br />.val:   85156.52622","date: 2000 Q4<br />.val:    3481.56262","date: 2001 Q1<br />.val:   29105.91271","date: 2001 Q2<br />.val:  -29085.07909","date: 2001 Q3<br />.val:   26124.76706","date: 2001 Q4<br />.val:  -27427.81167","date: 2002 Q1<br />.val: -125847.50994","date: 2002 Q2<br />.val:    -378.84332","date: 2002 Q3<br />.val:   12501.97934","date: 2002 Q4<br />.val:   10799.08266","date: 2003 Q1<br />.val:  -18964.44840","date: 2003 Q2<br />.val:  -10219.06926","date: 2003 Q3<br />.val:   -8804.02735","date: 2003 Q4<br />.val:  -15449.95690","date: 2004 Q1<br />.val:   20041.73483","date: 2004 Q2<br />.val:   10181.74182","date: 2004 Q3<br />.val:  -11333.82848","date: 2004 Q4<br />.val:    5305.57126","date: 2005 Q1<br />.val:  -74836.67815","date: 2005 Q2<br />.val:      33.35295","date: 2005 Q3<br />.val:  -29172.45319","date: 2005 Q4<br />.val:   -7444.33291","date: 2006 Q1<br />.val:   19836.57956","date: 2006 Q2<br />.val:   18105.44112","date: 2006 Q3<br />.val:    7320.83607","date: 2006 Q4<br />.val:  -10335.87253","date: 2007 Q1<br />.val:   -6147.21735","date: 2007 Q2<br />.val:    7544.83350","date: 2007 Q3<br />.val:   17763.77495","date: 2007 Q4<br />.val:    8408.43262","date: 2008 Q1<br />.val:   -1858.18246","date: 2008 Q2<br />.val:  129180.96496","date: 2008 Q3<br />.val:   88578.92940","date: 2008 Q4<br />.val:       0.00000","date: 2009 Q1<br />.val: -238004.82471","date: 2009 Q2<br />.val: -266078.17197","date: 2009 Q3<br />.val:   -6934.48322","date: 2009 Q4<br />.val:   24863.67524","date: 2010 Q1<br />.val:   -3368.20237","date: 2010 Q2<br />.val:   -3466.27145","date: 2010 Q3<br />.val:    9688.52717","date: 2010 Q4<br />.val:   -3388.72017","date: 2011 Q1<br />.val:     981.96682","date: 2011 Q2<br />.val:  -52951.78365","date: 2011 Q3<br />.val:   12130.51208","date: 2011 Q4<br />.val:    1118.27352","date: 2012 Q1<br />.val:   78996.06026","date: 2012 Q2<br />.val:   -1382.25720","date: 2012 Q3<br />.val:    3870.23161","date: 2012 Q4<br />.val:   22681.20003","date: 2013 Q1<br />.val:  -34583.04014","date: 2013 Q2<br />.val:   11784.10976","date: 2013 Q3<br />.val:   -7150.85730","date: 2013 Q4<br />.val:  -14074.34373","date: 2014 Q1<br />.val:    3738.21827","date: 2014 Q2<br />.val:    -489.40159","date: 2014 Q3<br />.val:   -1436.97692","date: 2014 Q4<br />.val:    2453.54158","date: 2015 Q1<br />.val:   11775.72492","date: 2015 Q2<br />.val:   -9364.22991","date: 2015 Q3<br />.val:   65883.08264","date: 2015 Q4<br />.val:    8884.56725","date: 2016 Q1<br />.val:  -14704.78203","date: 2016 Q2<br />.val:    5756.47058","date: 2016 Q3<br />.val:  -10105.40955","date: 2016 Q4<br />.val:   18158.33132","date: 2017 Q1<br />.val:   61253.94098","date: 2017 Q2<br />.val:   -5986.35659","date: 2017 Q3<br />.val:  -27221.73538","date: 2017 Q4<br />.val:    5502.78659","date: 2018 Q1<br />.val:    2529.47270","date: 2018 Q2<br />.val:   33885.29987","date: 2018 Q3<br />.val:    9370.99146","date: 2018 Q4<br />.val:   -8890.37722","date: 2019 Q1<br />.val:   25625.69682","date: 2019 Q2<br />.val:  -18910.90772","date: 2019 Q3<br />.val:   22493.29299","date: 2019 Q4<br />.val:   -7477.61531","date: 2020 Q1<br />.val:  155953.51065","date: 2020 Q2<br />.val: -904749.87009","date: 2020 Q3<br />.val:       0.00000","date: 2020 Q4<br />.val:  225273.51815","date: 2021 Q1<br />.val:  142329.49011","date: 2021 Q2<br />.val:  125217.35901","date: 2021 Q3<br />.val:    6663.10634","date: 2021 Q4<br />.val:   -4832.30613"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[4807945.9292910881,5045775.4707089104,5045775.4707089104,4807945.9292910881,4807945.9292910881],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[4781114.5726401582,5018944.1140579805,5018944.1140579805,4781114.5726401582,4781114.5726401582],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-124220.74164920326,113608.79976861921,113608.79976861921,-124220.74164920326,-124220.74164920326],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-458652.94668144512,-220823.40526362264,-220823.40526362264,-458652.94668144512,-458652.94668144512],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":18.99543378995434,"b":40.182648401826491,"l":51.872146118721474},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9025.75,19371.25],"tickmode":"array","ticktext":["2000 Q1","2010 Q1","2020 Q1"],"tickvals":[10957,14610,18262],"categoryorder":"array","categoryarray":["2000 Q1","2010 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"price","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.5099999998,6273769.8899999997],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[3635302.0350955799,6164756.6516025579],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-136112.21872009439,125500.27683951033],"tickmode":"array","ticktext":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"tickvals":[-100000,-50000,0,50000,100000],"categoryorder":"array","categoryarray":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-961251.03950682213,281774.68756175437],"tickmode":"array","ticktext":["-9e+05","-6e+05","-3e+05","0e+00"],"tickvals":[-900000,-600000,-300000,0],"categoryorder":"array","categoryarray":["-9e+05","-6e+05","-3e+05","0e+00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"190218941f31":{"x":{},"y":{},"type":"scatter"},"190211021352":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"190218941f31","visdat":{"190218941f31":["function (y) ","x"],"190211021352":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>The STL decomposition shows that the variance of the seasonal component has been increasing. We could try using a <strong>log transformation</strong> to counter this.</p>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Log of the Real GDP of Mexico"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">model</span><span class="op">(</span>stl <span class="op">=</span> <span class="fu">STL</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="fu">season</span><span class="op">(</span>window <span class="op">=</span> <span class="st">"periodic"</span><span class="op">)</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">components</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f59cda0ffd861b34c582" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f59cda0ffd861b34c582">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[15.124491221772157,15.175482478420287,15.178040519320948,15.211348855489106,15.222661769903164,15.23497355724434,15.235771420317244,15.237857493983071,15.244922668341729,15.258251294762877,15.265394693428794,15.271283802448208,15.299935277534624,15.311892688649808,15.320747526621583,15.303617277470252,15.306403239344863,15.312564413988975,15.306224617312033,15.292952447062387,15.267073892126774,15.320520741781639,15.309986653858221,15.31034873765271,15.29766074545087,15.32416988608693,15.311732021992574,15.322132182114167,15.329814133132844,15.361489920548486,15.344897179354668,15.359522857244334,15.334568976757511,15.385100751117829,15.367492584082582,15.391563812696189,15.3925580591333,15.430737322615016,15.416715109109003,15.426972580504676,15.412146736757412,15.450103025057565,15.438202012903293,15.448772647471172,15.420082731869051,15.473667393935015,15.449439735890511,15.44332598466398,15.348998914338697,15.364538120624045,15.388917563599181,15.423131761181052,15.393038251943345,15.43393602109575,15.434938305421738,15.45821754610329,15.429505670569641,15.458525112630031,15.471363511432719,15.496123098788573,15.477720240302169,15.498297105757441,15.496292301546092,15.52349007805679,15.474966508992798,15.515406369634395,15.506658236987494,15.532372238087094,15.499489103226681,15.53470632358038,15.531926155732155,15.562082841991826,15.527936139080175,15.557861709505373,15.565220960682636,15.584014126204071,15.544375948772934,15.580239419871031,15.573995072267342,15.60653794261713,15.577930141486812,15.595126913781115,15.585844872309886,15.620875534428277,15.589122095132577,15.623623920317687,15.612974078118333,15.632177836138499,15.598508389230414,15.613701467736144,15.608306939412993,15.622016330710062,15.584080363358439,15.386871600407003,15.523539426203216,15.586421414043631,15.557789702416846,15.591462036700115,15.573570610258457,15.605170741900745],"text":["date: 1997 Q1<br />.val: 15.1244912218","date: 1997 Q2<br />.val: 15.1754824784","date: 1997 Q3<br />.val: 15.1780405193","date: 1997 Q4<br />.val: 15.2113488555","date: 1998 Q1<br />.val: 15.2226617699","date: 1998 Q2<br />.val: 15.2349735572","date: 1998 Q3<br />.val: 15.2357714203","date: 1998 Q4<br />.val: 15.2378574940","date: 1999 Q1<br />.val: 15.2449226683","date: 1999 Q2<br />.val: 15.2582512948","date: 1999 Q3<br />.val: 15.2653946934","date: 1999 Q4<br />.val: 15.2712838024","date: 2000 Q1<br />.val: 15.2999352775","date: 2000 Q2<br />.val: 15.3118926886","date: 2000 Q3<br />.val: 15.3207475266","date: 2000 Q4<br />.val: 15.3036172775","date: 2001 Q1<br />.val: 15.3064032393","date: 2001 Q2<br />.val: 15.3125644140","date: 2001 Q3<br />.val: 15.3062246173","date: 2001 Q4<br />.val: 15.2929524471","date: 2002 Q1<br />.val: 15.2670738921","date: 2002 Q2<br />.val: 15.3205207418","date: 2002 Q3<br />.val: 15.3099866539","date: 2002 Q4<br />.val: 15.3103487377","date: 2003 Q1<br />.val: 15.2976607455","date: 2003 Q2<br />.val: 15.3241698861","date: 2003 Q3<br />.val: 15.3117320220","date: 2003 Q4<br />.val: 15.3221321821","date: 2004 Q1<br />.val: 15.3298141331","date: 2004 Q2<br />.val: 15.3614899205","date: 2004 Q3<br />.val: 15.3448971794","date: 2004 Q4<br />.val: 15.3595228572","date: 2005 Q1<br />.val: 15.3345689768","date: 2005 Q2<br />.val: 15.3851007511","date: 2005 Q3<br />.val: 15.3674925841","date: 2005 Q4<br />.val: 15.3915638127","date: 2006 Q1<br />.val: 15.3925580591","date: 2006 Q2<br />.val: 15.4307373226","date: 2006 Q3<br />.val: 15.4167151091","date: 2006 Q4<br />.val: 15.4269725805","date: 2007 Q1<br />.val: 15.4121467368","date: 2007 Q2<br />.val: 15.4501030251","date: 2007 Q3<br />.val: 15.4382020129","date: 2007 Q4<br />.val: 15.4487726475","date: 2008 Q1<br />.val: 15.4200827319","date: 2008 Q2<br />.val: 15.4736673939","date: 2008 Q3<br />.val: 15.4494397359","date: 2008 Q4<br />.val: 15.4433259847","date: 2009 Q1<br />.val: 15.3489989143","date: 2009 Q2<br />.val: 15.3645381206","date: 2009 Q3<br />.val: 15.3889175636","date: 2009 Q4<br />.val: 15.4231317612","date: 2010 Q1<br />.val: 15.3930382519","date: 2010 Q2<br />.val: 15.4339360211","date: 2010 Q3<br />.val: 15.4349383054","date: 2010 Q4<br />.val: 15.4582175461","date: 2011 Q1<br />.val: 15.4295056706","date: 2011 Q2<br />.val: 15.4585251126","date: 2011 Q3<br />.val: 15.4713635114","date: 2011 Q4<br />.val: 15.4961230988","date: 2012 Q1<br />.val: 15.4777202403","date: 2012 Q2<br />.val: 15.4982971058","date: 2012 Q3<br />.val: 15.4962923015","date: 2012 Q4<br />.val: 15.5234900781","date: 2013 Q1<br />.val: 15.4749665090","date: 2013 Q2<br />.val: 15.5154063696","date: 2013 Q3<br />.val: 15.5066582370","date: 2013 Q4<br />.val: 15.5323722381","date: 2014 Q1<br />.val: 15.4994891032","date: 2014 Q2<br />.val: 15.5347063236","date: 2014 Q3<br />.val: 15.5319261557","date: 2014 Q4<br />.val: 15.5620828420","date: 2015 Q1<br />.val: 15.5279361391","date: 2015 Q2<br />.val: 15.5578617095","date: 2015 Q3<br />.val: 15.5652209607","date: 2015 Q4<br />.val: 15.5840141262","date: 2016 Q1<br />.val: 15.5443759488","date: 2016 Q2<br />.val: 15.5802394199","date: 2016 Q3<br />.val: 15.5739950723","date: 2016 Q4<br />.val: 15.6065379426","date: 2017 Q1<br />.val: 15.5779301415","date: 2017 Q2<br />.val: 15.5951269138","date: 2017 Q3<br />.val: 15.5858448723","date: 2017 Q4<br />.val: 15.6208755344","date: 2018 Q1<br />.val: 15.5891220951","date: 2018 Q2<br />.val: 15.6236239203","date: 2018 Q3<br />.val: 15.6129740781","date: 2018 Q4<br />.val: 15.6321778361","date: 2019 Q1<br />.val: 15.5985083892","date: 2019 Q2<br />.val: 15.6137014677","date: 2019 Q3<br />.val: 15.6083069394","date: 2019 Q4<br />.val: 15.6220163307","date: 2020 Q1<br />.val: 15.5840803634","date: 2020 Q2<br />.val: 15.3868716004","date: 2020 Q3<br />.val: 15.5235394262","date: 2020 Q4<br />.val: 15.5864214140","date: 2021 Q1<br />.val: 15.5577897024","date: 2021 Q2<br />.val: 15.5914620367","date: 2021 Q3<br />.val: 15.5735706103","date: 2021 Q4<br />.val: 15.6051707419"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[15.144066448639904,15.162999814323994,15.181743211453604,15.199536923040601,15.213772969519486,15.22570342634417,15.233229471431994,15.240787843111708,15.247389370797562,15.255522317265912,15.260522631814721,15.271978864704341,15.286010350519861,15.29957542178226,15.308838651200226,15.310963891552696,15.309416230343128,15.306996792317721,15.299507376572405,15.295253420351411,15.296634952671136,15.300845927733905,15.306622889646011,15.309910669969998,15.311049415450954,15.313128141954579,15.317424120004661,15.326716528257297,15.336470981836174,15.345619657173902,15.34937089600281,15.352154815435265,15.35850966891612,15.365742641066547,15.376201602104409,15.388981629955742,15.402255233602652,15.413226565468888,15.419123740158838,15.423479447492669,15.429243312314512,15.435141343678271,15.438566921283812,15.440735044553914,15.444947243521607,15.446183156395875,15.445340264225781,15.433610115975315,15.419464243336478,15.409348604474657,15.393374222729133,15.404872522614475,15.415331306264827,15.425264775682139,15.434933852117613,15.442733644570914,15.449690254006544,15.458730523378433,15.470164758945172,15.481910527414547,15.489353566499313,15.494862059263811,15.498420414604,15.500503128686912,15.503355401091429,15.505442578276234,15.510662362865775,15.516027113265789,15.521312600766478,15.527579797211525,15.535519592964668,15.542324013246105,15.548729738473742,15.555303889474926,15.561399521563006,15.566247607167753,15.569247821456894,15.572556084447422,15.58024344598628,15.587059390337227,15.590409286724109,15.59225673111724,15.595743725137261,15.60148278388486,15.608505736766388,15.612835469525011,15.615793917808432,15.616132799407069,15.613985221537851,15.61151316057142,15.60892831039282,15.607339291326689,15.603442186076844,15.593616320539187,15.585919323992105,15.575460962449478,15.57739921997201,15.580431053118259,15.584772391420092,15.589200719023104],"text":["date: 1997 Q1<br />.val: 15.1440664486","date: 1997 Q2<br />.val: 15.1629998143","date: 1997 Q3<br />.val: 15.1817432115","date: 1997 Q4<br />.val: 15.1995369230","date: 1998 Q1<br />.val: 15.2137729695","date: 1998 Q2<br />.val: 15.2257034263","date: 1998 Q3<br />.val: 15.2332294714","date: 1998 Q4<br />.val: 15.2407878431","date: 1999 Q1<br />.val: 15.2473893708","date: 1999 Q2<br />.val: 15.2555223173","date: 1999 Q3<br />.val: 15.2605226318","date: 1999 Q4<br />.val: 15.2719788647","date: 2000 Q1<br />.val: 15.2860103505","date: 2000 Q2<br />.val: 15.2995754218","date: 2000 Q3<br />.val: 15.3088386512","date: 2000 Q4<br />.val: 15.3109638916","date: 2001 Q1<br />.val: 15.3094162303","date: 2001 Q2<br />.val: 15.3069967923","date: 2001 Q3<br />.val: 15.2995073766","date: 2001 Q4<br />.val: 15.2952534204","date: 2002 Q1<br />.val: 15.2966349527","date: 2002 Q2<br />.val: 15.3008459277","date: 2002 Q3<br />.val: 15.3066228896","date: 2002 Q4<br />.val: 15.3099106700","date: 2003 Q1<br />.val: 15.3110494155","date: 2003 Q2<br />.val: 15.3131281420","date: 2003 Q3<br />.val: 15.3174241200","date: 2003 Q4<br />.val: 15.3267165283","date: 2004 Q1<br />.val: 15.3364709818","date: 2004 Q2<br />.val: 15.3456196572","date: 2004 Q3<br />.val: 15.3493708960","date: 2004 Q4<br />.val: 15.3521548154","date: 2005 Q1<br />.val: 15.3585096689","date: 2005 Q2<br />.val: 15.3657426411","date: 2005 Q3<br />.val: 15.3762016021","date: 2005 Q4<br />.val: 15.3889816300","date: 2006 Q1<br />.val: 15.4022552336","date: 2006 Q2<br />.val: 15.4132265655","date: 2006 Q3<br />.val: 15.4191237402","date: 2006 Q4<br />.val: 15.4234794475","date: 2007 Q1<br />.val: 15.4292433123","date: 2007 Q2<br />.val: 15.4351413437","date: 2007 Q3<br />.val: 15.4385669213","date: 2007 Q4<br />.val: 15.4407350446","date: 2008 Q1<br />.val: 15.4449472435","date: 2008 Q2<br />.val: 15.4461831564","date: 2008 Q3<br />.val: 15.4453402642","date: 2008 Q4<br />.val: 15.4336101160","date: 2009 Q1<br />.val: 15.4194642433","date: 2009 Q2<br />.val: 15.4093486045","date: 2009 Q3<br />.val: 15.3933742227","date: 2009 Q4<br />.val: 15.4048725226","date: 2010 Q1<br />.val: 15.4153313063","date: 2010 Q2<br />.val: 15.4252647757","date: 2010 Q3<br />.val: 15.4349338521","date: 2010 Q4<br />.val: 15.4427336446","date: 2011 Q1<br />.val: 15.4496902540","date: 2011 Q2<br />.val: 15.4587305234","date: 2011 Q3<br />.val: 15.4701647589","date: 2011 Q4<br />.val: 15.4819105274","date: 2012 Q1<br />.val: 15.4893535665","date: 2012 Q2<br />.val: 15.4948620593","date: 2012 Q3<br />.val: 15.4984204146","date: 2012 Q4<br />.val: 15.5005031287","date: 2013 Q1<br />.val: 15.5033554011","date: 2013 Q2<br />.val: 15.5054425783","date: 2013 Q3<br />.val: 15.5106623629","date: 2013 Q4<br />.val: 15.5160271133","date: 2014 Q1<br />.val: 15.5213126008","date: 2014 Q2<br />.val: 15.5275797972","date: 2014 Q3<br />.val: 15.5355195930","date: 2014 Q4<br />.val: 15.5423240132","date: 2015 Q1<br />.val: 15.5487297385","date: 2015 Q2<br />.val: 15.5553038895","date: 2015 Q3<br />.val: 15.5613995216","date: 2015 Q4<br />.val: 15.5662476072","date: 2016 Q1<br />.val: 15.5692478215","date: 2016 Q2<br />.val: 15.5725560844","date: 2016 Q3<br />.val: 15.5802434460","date: 2016 Q4<br />.val: 15.5870593903","date: 2017 Q1<br />.val: 15.5904092867","date: 2017 Q2<br />.val: 15.5922567311","date: 2017 Q3<br />.val: 15.5957437251","date: 2017 Q4<br />.val: 15.6014827839","date: 2018 Q1<br />.val: 15.6085057368","date: 2018 Q2<br />.val: 15.6128354695","date: 2018 Q3<br />.val: 15.6157939178","date: 2018 Q4<br />.val: 15.6161327994","date: 2019 Q1<br />.val: 15.6139852215","date: 2019 Q2<br />.val: 15.6115131606","date: 2019 Q3<br />.val: 15.6089283104","date: 2019 Q4<br />.val: 15.6073392913","date: 2020 Q1<br />.val: 15.6034421861","date: 2020 Q2<br />.val: 15.5936163205","date: 2020 Q3<br />.val: 15.5859193240","date: 2020 Q4<br />.val: 15.5754609624","date: 2021 Q1<br />.val: 15.5773992200","date: 2021 Q2<br />.val: 15.5804310531","date: 2021 Q3<br />.val: 15.5847723914","date: 2021 Q4<br />.val: 15.5892007190"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677,-0.017996655108923291,0.0095452348717542639,-0.0017210522200625869,0.010172493130730677],"text":["date: 1997 Q1<br />.val: -0.0179966551","date: 1997 Q2<br />.val:  0.0095452349","date: 1997 Q3<br />.val: -0.0017210522","date: 1997 Q4<br />.val:  0.0101724931","date: 1998 Q1<br />.val: -0.0179966551","date: 1998 Q2<br />.val:  0.0095452349","date: 1998 Q3<br />.val: -0.0017210522","date: 1998 Q4<br />.val:  0.0101724931","date: 1999 Q1<br />.val: -0.0179966551","date: 1999 Q2<br />.val:  0.0095452349","date: 1999 Q3<br />.val: -0.0017210522","date: 1999 Q4<br />.val:  0.0101724931","date: 2000 Q1<br />.val: -0.0179966551","date: 2000 Q2<br />.val:  0.0095452349","date: 2000 Q3<br />.val: -0.0017210522","date: 2000 Q4<br />.val:  0.0101724931","date: 2001 Q1<br />.val: -0.0179966551","date: 2001 Q2<br />.val:  0.0095452349","date: 2001 Q3<br />.val: -0.0017210522","date: 2001 Q4<br />.val:  0.0101724931","date: 2002 Q1<br />.val: -0.0179966551","date: 2002 Q2<br />.val:  0.0095452349","date: 2002 Q3<br />.val: -0.0017210522","date: 2002 Q4<br />.val:  0.0101724931","date: 2003 Q1<br />.val: -0.0179966551","date: 2003 Q2<br />.val:  0.0095452349","date: 2003 Q3<br />.val: -0.0017210522","date: 2003 Q4<br />.val:  0.0101724931","date: 2004 Q1<br />.val: -0.0179966551","date: 2004 Q2<br />.val:  0.0095452349","date: 2004 Q3<br />.val: -0.0017210522","date: 2004 Q4<br />.val:  0.0101724931","date: 2005 Q1<br />.val: -0.0179966551","date: 2005 Q2<br />.val:  0.0095452349","date: 2005 Q3<br />.val: -0.0017210522","date: 2005 Q4<br />.val:  0.0101724931","date: 2006 Q1<br />.val: -0.0179966551","date: 2006 Q2<br />.val:  0.0095452349","date: 2006 Q3<br />.val: -0.0017210522","date: 2006 Q4<br />.val:  0.0101724931","date: 2007 Q1<br />.val: -0.0179966551","date: 2007 Q2<br />.val:  0.0095452349","date: 2007 Q3<br />.val: -0.0017210522","date: 2007 Q4<br />.val:  0.0101724931","date: 2008 Q1<br />.val: -0.0179966551","date: 2008 Q2<br />.val:  0.0095452349","date: 2008 Q3<br />.val: -0.0017210522","date: 2008 Q4<br />.val:  0.0101724931","date: 2009 Q1<br />.val: -0.0179966551","date: 2009 Q2<br />.val:  0.0095452349","date: 2009 Q3<br />.val: -0.0017210522","date: 2009 Q4<br />.val:  0.0101724931","date: 2010 Q1<br />.val: -0.0179966551","date: 2010 Q2<br />.val:  0.0095452349","date: 2010 Q3<br />.val: -0.0017210522","date: 2010 Q4<br />.val:  0.0101724931","date: 2011 Q1<br />.val: -0.0179966551","date: 2011 Q2<br />.val:  0.0095452349","date: 2011 Q3<br />.val: -0.0017210522","date: 2011 Q4<br />.val:  0.0101724931","date: 2012 Q1<br />.val: -0.0179966551","date: 2012 Q2<br />.val:  0.0095452349","date: 2012 Q3<br />.val: -0.0017210522","date: 2012 Q4<br />.val:  0.0101724931","date: 2013 Q1<br />.val: -0.0179966551","date: 2013 Q2<br />.val:  0.0095452349","date: 2013 Q3<br />.val: -0.0017210522","date: 2013 Q4<br />.val:  0.0101724931","date: 2014 Q1<br />.val: -0.0179966551","date: 2014 Q2<br />.val:  0.0095452349","date: 2014 Q3<br />.val: -0.0017210522","date: 2014 Q4<br />.val:  0.0101724931","date: 2015 Q1<br />.val: -0.0179966551","date: 2015 Q2<br />.val:  0.0095452349","date: 2015 Q3<br />.val: -0.0017210522","date: 2015 Q4<br />.val:  0.0101724931","date: 2016 Q1<br />.val: -0.0179966551","date: 2016 Q2<br />.val:  0.0095452349","date: 2016 Q3<br />.val: -0.0017210522","date: 2016 Q4<br />.val:  0.0101724931","date: 2017 Q1<br />.val: -0.0179966551","date: 2017 Q2<br />.val:  0.0095452349","date: 2017 Q3<br />.val: -0.0017210522","date: 2017 Q4<br />.val:  0.0101724931","date: 2018 Q1<br />.val: -0.0179966551","date: 2018 Q2<br />.val:  0.0095452349","date: 2018 Q3<br />.val: -0.0017210522","date: 2018 Q4<br />.val:  0.0101724931","date: 2019 Q1<br />.val: -0.0179966551","date: 2019 Q2<br />.val:  0.0095452349","date: 2019 Q3<br />.val: -0.0017210522","date: 2019 Q4<br />.val:  0.0101724931","date: 2020 Q1<br />.val: -0.0179966551","date: 2020 Q2<br />.val:  0.0095452349","date: 2020 Q3<br />.val: -0.0017210522","date: 2020 Q4<br />.val:  0.0101724931","date: 2021 Q1<br />.val: -0.0179966551","date: 2021 Q2<br />.val:  0.0095452349","date: 2021 Q3<br />.val: -0.0017210522","date: 2021 Q4<br />.val:  0.0101724931"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-0.0015785717588236992,0.0029374292245378797,-0.0019816399125929252,0.0016394393177758815,0.026885455492601906,-0.00027510397158536648,0.0042630011053130801,-0.013102842259366199,0.015529952653091428,-0.0068162573747905242,0.0065931138341355222,-0.010867555386862904,0.031921582123686676,0.0027720319957929007,0.01362992764141957,-0.017519107213173513,0.014983664110658879,-0.0039776132005009401,0.0084382929596902301,-0.012473466419754331,-0.011564405435438019,0.010129579175979231,0.0050848164322729872,-0.0097344254480180581,0.0046079851088389745,0.0014965092605958574,-0.0039710457920243414,-0.014756839273859512,0.011339806405594288,0.0063250285028288999,-0.0027526644280797541,-0.0028044513216602951,-0.0059440370496854911,0.0098128751795272251,-0.0069879658017644175,-0.0075903103902827951,0.0082994806395717546,0.0079655222743735266,-0.00068757882977266149,-0.0066793601187224994,0.00090007955182436206,0.005416446507538808,0.0013561438395441883,-0.0021348902134725734,-0.0068678565436322003,0.017939002667384685,0.0058205238847932605,-0.0004566244420640686,-0.052468673888856898,-0.05435571872236622,-0.0027356069098889435,0.0080867454358468649,-0.0042963992125581996,-0.0008739894581442087,0.0017255055241882644,0.0053114084016456786,-0.002187928327979094,-0.009750645620156817,0.0029198047076093303,0.004040078243296108,0.0063633289117799308,-0.0061101883781251587,-0.0004070608378459184,0.012814456239148342,-0.010392236989707371,0.00041855648640520826,-0.0022830736582175604,0.0061726316905748035,-0.0038268424308736115,-0.0024187085028994915,-0.0018723850124509056,0.0095863356149905599,-0.0027969442846433878,-0.0069874148413084924,0.0055424913396926456,0.0075940259055879977,-0.0068752175750361744,-0.001861899448146076,-0.0045273214988750254,0.0093060591491731515,0.0055175098716269133,-0.0066750522078802277,-0.0081778006073118803,0.0092202574126876158,-0.0013869865248867796,0.0012432159209208038,-0.0010987874700365552,0.0058725436007005527,0.0025198228014868818,-0.0073569277070308914,0.0010996812402357392,0.0045045462526438484,-0.0013651676094816878,-0.21628995500393877,-0.060658845568825726,0.00078795846342316622,-0.0016128624462403707,0.0014857487101007649,-0.0094807289415719254,0.0057975297469106124],"text":["date: 1997 Q1<br />.val: -0.0015785718","date: 1997 Q2<br />.val:  0.0029374292","date: 1997 Q3<br />.val: -0.0019816399","date: 1997 Q4<br />.val:  0.0016394393","date: 1998 Q1<br />.val:  0.0268854555","date: 1998 Q2<br />.val: -0.0002751040","date: 1998 Q3<br />.val:  0.0042630011","date: 1998 Q4<br />.val: -0.0131028423","date: 1999 Q1<br />.val:  0.0155299527","date: 1999 Q2<br />.val: -0.0068162574","date: 1999 Q3<br />.val:  0.0065931138","date: 1999 Q4<br />.val: -0.0108675554","date: 2000 Q1<br />.val:  0.0319215821","date: 2000 Q2<br />.val:  0.0027720320","date: 2000 Q3<br />.val:  0.0136299276","date: 2000 Q4<br />.val: -0.0175191072","date: 2001 Q1<br />.val:  0.0149836641","date: 2001 Q2<br />.val: -0.0039776132","date: 2001 Q3<br />.val:  0.0084382930","date: 2001 Q4<br />.val: -0.0124734664","date: 2002 Q1<br />.val: -0.0115644054","date: 2002 Q2<br />.val:  0.0101295792","date: 2002 Q3<br />.val:  0.0050848164","date: 2002 Q4<br />.val: -0.0097344254","date: 2003 Q1<br />.val:  0.0046079851","date: 2003 Q2<br />.val:  0.0014965093","date: 2003 Q3<br />.val: -0.0039710458","date: 2003 Q4<br />.val: -0.0147568393","date: 2004 Q1<br />.val:  0.0113398064","date: 2004 Q2<br />.val:  0.0063250285","date: 2004 Q3<br />.val: -0.0027526644","date: 2004 Q4<br />.val: -0.0028044513","date: 2005 Q1<br />.val: -0.0059440370","date: 2005 Q2<br />.val:  0.0098128752","date: 2005 Q3<br />.val: -0.0069879658","date: 2005 Q4<br />.val: -0.0075903104","date: 2006 Q1<br />.val:  0.0082994806","date: 2006 Q2<br />.val:  0.0079655223","date: 2006 Q3<br />.val: -0.0006875788","date: 2006 Q4<br />.val: -0.0066793601","date: 2007 Q1<br />.val:  0.0009000796","date: 2007 Q2<br />.val:  0.0054164465","date: 2007 Q3<br />.val:  0.0013561438","date: 2007 Q4<br />.val: -0.0021348902","date: 2008 Q1<br />.val: -0.0068678565","date: 2008 Q2<br />.val:  0.0179390027","date: 2008 Q3<br />.val:  0.0058205239","date: 2008 Q4<br />.val: -0.0004566244","date: 2009 Q1<br />.val: -0.0524686739","date: 2009 Q2<br />.val: -0.0543557187","date: 2009 Q3<br />.val: -0.0027356069","date: 2009 Q4<br />.val:  0.0080867454","date: 2010 Q1<br />.val: -0.0042963992","date: 2010 Q2<br />.val: -0.0008739895","date: 2010 Q3<br />.val:  0.0017255055","date: 2010 Q4<br />.val:  0.0053114084","date: 2011 Q1<br />.val: -0.0021879283","date: 2011 Q2<br />.val: -0.0097506456","date: 2011 Q3<br />.val:  0.0029198047","date: 2011 Q4<br />.val:  0.0040400782","date: 2012 Q1<br />.val:  0.0063633289","date: 2012 Q2<br />.val: -0.0061101884","date: 2012 Q3<br />.val: -0.0004070608","date: 2012 Q4<br />.val:  0.0128144562","date: 2013 Q1<br />.val: -0.0103922370","date: 2013 Q2<br />.val:  0.0004185565","date: 2013 Q3<br />.val: -0.0022830737","date: 2013 Q4<br />.val:  0.0061726317","date: 2014 Q1<br />.val: -0.0038268424","date: 2014 Q2<br />.val: -0.0024187085","date: 2014 Q3<br />.val: -0.0018723850","date: 2014 Q4<br />.val:  0.0095863356","date: 2015 Q1<br />.val: -0.0027969443","date: 2015 Q2<br />.val: -0.0069874148","date: 2015 Q3<br />.val:  0.0055424913","date: 2015 Q4<br />.val:  0.0075940259","date: 2016 Q1<br />.val: -0.0068752176","date: 2016 Q2<br />.val: -0.0018618994","date: 2016 Q3<br />.val: -0.0045273215","date: 2016 Q4<br />.val:  0.0093060591","date: 2017 Q1<br />.val:  0.0055175099","date: 2017 Q2<br />.val: -0.0066750522","date: 2017 Q3<br />.val: -0.0081778006","date: 2017 Q4<br />.val:  0.0092202574","date: 2018 Q1<br />.val: -0.0013869865","date: 2018 Q2<br />.val:  0.0012432159","date: 2018 Q3<br />.val: -0.0010987875","date: 2018 Q4<br />.val:  0.0058725436","date: 2019 Q1<br />.val:  0.0025198228","date: 2019 Q2<br />.val: -0.0073569277","date: 2019 Q3<br />.val:  0.0010996812","date: 2019 Q4<br />.val:  0.0045045463","date: 2020 Q1<br />.val: -0.0013651676","date: 2020 Q2<br />.val: -0.2162899550","date: 2020 Q3<br />.val: -0.0606588456","date: 2020 Q4<br />.val:  0.0007879585","date: 2021 Q1<br />.val: -0.0016128624","date: 2021 Q2<br />.val:  0.0014857487","date: 2021 Q3<br />.val: -0.0094807289","date: 2021 Q4<br />.val:  0.0057975297"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[15.3642499548355,15.392419103075156,15.392419103075156,15.3642499548355,15.3642499548355],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[15.366015049903659,15.394184198143314,15.394184198143314,15.366015049903659,15.366015049903659],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-0.017996655108923291,0.010172493130730677,0.010172493130730677,-0.017996655108923291,-0.017996655108923291],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-0.10626876055995303,-0.078099612320299064,-0.078099612320299064,-0.10626876055995303,-0.10626876055995303],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":18.99543378995434,"b":40.182648401826491,"l":34.337899543379002},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9025.75,19371.25],"tickmode":"array","ticktext":["2000 Q1","2010 Q1","2020 Q1"],"tickvals":[10957,14610,18262],"categoryorder":"array","categoryarray":["2000 Q1","2010 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"log(price)","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[15.09910689105384,15.657562166856817],"tickmode":"array","ticktext":["15.1","15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.100000000000001,15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.1","15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[15.120463131101546,15.639736116945427],"tickmode":"array","ticktext":["15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.019405112520905991,0.011580950542713376],"tickmode":"array","ticktext":["-0.01","0.00","0.01"],"tickvals":[-0.01,0,0.0099999999999999985],"categoryorder":"array","categoryarray":["-0.01","0.00","0.01"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.22870053186032005,0.044332158980067947],"tickmode":"array","ticktext":["-0.20","-0.15","-0.10","-0.05","0.00"],"tickvals":[-0.20000000000000001,-0.15000000000000002,-0.10000000000000001,-0.049999999999999961,0],"categoryorder":"array","categoryarray":["-0.20","-0.15","-0.10","-0.05","0.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"19027c29b6c4":{"x":{},"y":{},"type":"scatter"},"190258b9ada":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"19027c29b6c4","visdat":{"19027c29b6c4":["function (y) ","x"],"190258b9ada":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="model-specification" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="model-specification">
<span class="header-section-number">1.4</span> Model Specification</h2>
<p>We will <strong>fit</strong> two models to our time series: <em>Seasonal Naïve</em>, and the <em>Drift</em> model. We will also use the log transformation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">&lt;-</span> <span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">model</span><span class="op">(</span></span>
<span>    snaive <span class="op">=</span> <span class="fu">SNAIVE</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    drift  <span class="op">=</span> <span class="fu">RW</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="fu">drift</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Benchmark models
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have four different benchmark models that we’ll use to compare against the rest of the more complex models:</p>
<ul>
<li>Mean (<code>MEAN( &lt;.y&gt; )</code>)</li>
<li>Naïve (<code>NAIVE( &lt;.y&gt; )</code>)</li>
<li>Seasonal Naïve (<code>SNAIVE( &lt;.y&gt; )</code>)</li>
<li>Drift (<code>RW( &lt;.y&gt; ~ drift())</code>)</li>
</ul>
<p>where <code>&lt;.y&gt;</code> is just a placeholder for the variable to model.</p>
<p>Choose wisely which of these to use in each case, according to the exploratory analysis performed.</p>
</div>
</div>
</div>
</section><section id="residuals-diagnostics" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="residuals-diagnostics">
<span class="header-section-number">1.5</span> Residuals Diagnostics</h2>
<section id="visual-analysis" class="level3" data-number="1.5.1"><h3 data-number="1.5.1" class="anchored" data-anchor-id="visual-analysis">
<span class="header-section-number">1.5.1</span> Visual analysis</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">snaive</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gg_tsresiduals</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Residuals Diagnostics for the Seasonal Naïve Model"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">drift</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gg_tsresiduals</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Residuals Diagnostics for the Drift Model"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-13-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here we expect to see:</p>
<ul>
<li>A time series with no apparent patterns (no trend and/or seasonality), with a mean close to zero.</li>
<li>In the <strong>ACF</strong>, we’d expect no lags with significant autocorrelation.</li>
<li>Normally distributed residuals.</li>
</ul>
</div>
</div>
</div>
</section><section id="portmanteau-tests-of-autocorrelation" class="level3" data-number="1.5.2"><h3 data-number="1.5.2" class="anchored" data-anchor-id="portmanteau-tests-of-autocorrelation">
<span class="header-section-number">1.5.2</span> Portmanteau tests of autocorrelation</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">features</span><span class="op">(</span><span class="va">.innov</span>, <span class="va">ljung_box</span>, lag <span class="op">=</span> <span class="fl">24</span>, dof <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"126.9670","4":"5.551115e-16"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"45.9094","4":"4.539298e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Residuals interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Both models produce sub optimal residuals:</p>
<ul>
<li><p>The SNAIVE correctly detects the seasonality, however, its residuals are still autocorrelated. Moreover, the residuals are not normally distributed.</p></li>
<li><p>The drift model doesn’t account for the seasonality, and their distribution is a little bit skewed.</p></li>
</ul>
<p>Hence, we will perform our forecasts using the <strong>bootstrapping</strong> method.</p>
</div>
</div>
<p>We can compute some error metrics on the training set using the <code>accuracy()</code> function:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_train_accu</span> <span class="op">&lt;-</span> <span class="fu">accuracy</span><span class="op">(</span><span class="va">gdp_fit</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">MAPE</span><span class="op">)</span></span>
<span><span class="va">gdp_train_accu</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">:</span><span class="va">.type</span>, <span class="va">MAPE</span>, <span class="va">RMSE</span>, <span class="va">MAE</span>, <span class="va">MASE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.466151","5":"188182.6","6":"127478.5","7":"0.7787146"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.244547","5":"239051.9","6":"163703.8","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The <code>accuracy()</code> function
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <code>accuracy()</code> function can be used to compute error metrics in the training data, or in the test set. What differs is the data that is given to it:</p>
<ul>
<li><p>For the training metrics, you need to use the <strong><code>mable</code></strong> (the table of models, that we usually store in <code>_fit</code>).</p></li>
<li><p>For the forecasting error metrics, we need the <strong><code>fable</code></strong> (the forecasts table, usually stored as <code>_fc</code> or <code>_fcst</code>), and the <strong>complete set of data</strong> (both the training and test set together).</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>For this analysis, we are focusing on the <strong>MAPE</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> metric. The drift model <strong>(2.47%)</strong> seems to have a better fit with the training set than the snaive model <strong>(3.24%)</strong>.</p>
</div>
</div>
</div>
</section></section><section id="modeling-using-decomposition" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="modeling-using-decomposition">
<span class="header-section-number">1.6</span> Modeling using decomposition</h2>
<p>We will perform a forecast using decomposition, to see if we can improve our results so far.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit_dcmp</span> <span class="op">&lt;-</span> <span class="va">gdp_train</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">model</span><span class="op">(</span></span>
<span>        stlf <span class="op">=</span> <span class="fu">decomposition_model</span><span class="op">(</span></span>
<span>          <span class="fu">STL</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="fu">season</span><span class="op">(</span>window <span class="op">=</span> <span class="st">"periodic"</span><span class="op">)</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          <span class="fu">RW</span><span class="op">(</span><span class="va">season_adjust</span> <span class="op">~</span> <span class="fu">drift</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span><span class="va">gdp_fit_dcmp</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note on <code>decomposition_model()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Remember, when using decomposition models, we need to do the following:</p>
<ol type="1">
<li><p>Specify what type of decomposition we want to use and customize it as needed.</p></li>
<li><p>Fit a model for the seasonally adjusted data; <code>season_adjust</code>.</p></li>
<li><p>Fit a model for the seasonal component. <strong>R</strong> uses a <code>SNAIVE()</code> model by default to model the seasonality. If you wish to model it using a different model, you have specify it.</p></li>
</ol>
<ul>
<li>The name of the seasonal component depends on the type of seasonality present in the time series. If it has a yearly seasonality, the component is called <code>season_year</code>. It could also be called <code>season_week</code>, <code>season_day</code>, and so on.</li>
</ul>
</div>
</div>
</div>
<p>We can join this new model with the models we trained before. This way we can have them all in the same <code>mable</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">&lt;-</span> <span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">gdp_fit_dcmp</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(symbol)`</code></pre>
</div>
</div>
<section id="residuals-diagnostics-1" class="level3" data-number="1.6.1"><h3 data-number="1.6.1" class="anchored" data-anchor-id="residuals-diagnostics-1">
<span class="header-section-number">1.6.1</span> Residuals diagnostics</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">accuracy</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">:</span><span class="va">.type</span>, <span class="va">MAPE</span>, <span class="va">RMSE</span>, <span class="va">MAE</span>, <span class="va">MASE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">MAPE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"Training","4":"1.658860","5":"169268.6","6":"82540.1","7":"0.5042039"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.466151","5":"188182.6","6":"127478.5","7":"0.7787146"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.244547","5":"239051.9","6":"163703.8","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">stlf</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gg_tsresiduals</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">features</span><span class="op">(</span><span class="va">.innov</span>, <span class="va">ljung_box</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"13.599971","4":"2.261890e-04"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"23.897842","4":"1.015856e-06"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"7.650703","4":"5.675021e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>The MAPE seems to improve with this decomposition model. Also, the residual diagnostics do not show any seasonality present in them. However, the residuals are still autocorrelated, as the <em>Ljung-Box</em> test suggests.</p>
</div>
</div>
</div>
</section></section><section id="forecasting-on-the-test-set" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="forecasting-on-the-test-set">
<span class="header-section-number">1.7</span> Forecasting on the test set</h2>
<p>Once we have our models, we can produce forecasts. We will forecast our test data and check our forecasts’ performance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc</span> <span class="op">&lt;-</span> <span class="va">gdp_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">forecast</span><span class="op">(</span>h <span class="op">=</span> <span class="va">gdp_h_fc</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">gdp_fc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q1","4":"<dist>","5":"5716588"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q2","4":"<dist>","5":"5912357"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q3","4":"<dist>","5":"5807517"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q4","4":"<dist>","5":"5993966"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q1","4":"<dist>","5":"5722834"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q2","4":"<dist>","5":"5918816"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q3","4":"<dist>","5":"5813861"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q4","4":"<dist>","5":"6000514"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q1","4":"<dist>","5":"5729079"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q2","4":"<dist>","5":"5925275"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q3","4":"<dist>","5":"5820206"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q4","4":"<dist>","5":"6007062"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2025 Q1","4":"<dist>","5":"5735324"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q1","4":"<dist>","5":"6020505"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q2","4":"<dist>","5":"6053851"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q3","4":"<dist>","5":"6087459"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q4","4":"<dist>","5":"6121332"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q1","4":"<dist>","5":"6155470"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q2","4":"<dist>","5":"6189876"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q3","4":"<dist>","5":"6224552"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q4","4":"<dist>","5":"6259502"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q1","4":"<dist>","5":"6294725"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q2","4":"<dist>","5":"6330226"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q3","4":"<dist>","5":"6366007"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q4","4":"<dist>","5":"6402068"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2025 Q1","4":"<dist>","5":"6438414"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q1","4":"<dist>","5":"5850858"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q2","4":"<dist>","5":"6045038"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q3","4":"<dist>","5":"6007984"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q4","4":"<dist>","5":"6111125"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q1","4":"<dist>","5":"5971988"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q2","4":"<dist>","5":"6170440"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q3","4":"<dist>","5":"6132867"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q4","4":"<dist>","5":"6238405"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q1","4":"<dist>","5":"6096618"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q2","4":"<dist>","5":"6299467"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q3","4":"<dist>","5":"6261362"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q4","4":"<dist>","5":"6369368"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q1","4":"<dist>","5":"6224856"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.model</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">.model</span> <span class="op">==</span> <span class="st">"stlf"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-23-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We now estimate the forecast errors:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">accuracy</span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.model</span><span class="op">:</span><span class="va">.type</span>, <span class="va">MAPE</span>, <span class="va">RMSE</span>, <span class="va">MAE</span>, <span class="va">MASE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">MAPE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["symbol"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"drift","2":"NGDPRNSAXDCMXQ","3":"Test","4":"1.512318","5":"110795.5","6":"94103.53","7":"0.5748402"},{"1":"stlf","2":"NGDPRNSAXDCMXQ","3":"Test","4":"1.534414","5":"111013.4","6":"96525.69","7":"0.5896362"},{"1":"snaive","2":"NGDPRNSAXDCMXQ","3":"Test","4":"6.047157","5":"400375.8","6":"379370.25","7":"2.3174186"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="forecasting-the-future" class="level2" data-number="1.8"><h2 data-number="1.8" class="anchored" data-anchor-id="forecasting-the-future">
<span class="header-section-number">1.8</span> Forecasting the future</h2>
<p>We now refit our model using the whole dataset. We will only model the STL decomposition model, because the other two didn’t get a strong fit.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fit2</span> <span class="op">&lt;-</span> <span class="va">gdp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">model</span><span class="op">(</span></span>
<span>    stlf <span class="op">=</span> <span class="fu">decomposition_model</span><span class="op">(</span></span>
<span>          <span class="fu">STL</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="fu">season</span><span class="op">(</span>window <span class="op">=</span> <span class="st">"periodic"</span><span class="op">)</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          <span class="fu">RW</span><span class="op">(</span><span class="va">season_adjust</span> <span class="op">~</span> <span class="fu">drift</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">gdp_fit2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc_fut</span> <span class="op">&lt;-</span> <span class="va">gdp_fit2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">forecast</span><span class="op">(</span>h <span class="op">=</span> <span class="va">gdp_h_fc</span><span class="op">)</span></span>
<span><span class="va">gdp_fc_fut</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q2","4":"<dist>","5":"6438609"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q3","4":"<dist>","5":"6407042"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q4","4":"<dist>","5":"6530053"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q1","4":"<dist>","5":"6358869"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q2","4":"<dist>","5":"6572200"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q3","4":"<dist>","5":"6540188"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q4","4":"<dist>","5":"6665969"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q1","4":"<dist>","5":"6491429"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q2","4":"<dist>","5":"6709423"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q3","4":"<dist>","5":"6676955"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q4","4":"<dist>","5":"6805583"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q1","4":"<dist>","5":"6627598"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q2","4":"<dist>","5":"6850382"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gdp_fc_fut</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="forecasting_workflow_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># save(gdp_fc_fut, file = "equipo1.RData")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1">
<p>This will make it very convenient when calling your variables. RStudio will display all the options starting with <code>gdp_</code>. We will usually use the following suffixes:</p>
<ul>
<li>
<code>_train</code>: training set</li>
<li>
<code>_fit</code>: the <code>mable</code> (table of models)</li>
<li>
<code>_aug</code>: the augmented table with fitted values and residuals</li>
<li>
<code>_dcmp</code>: for the <code>dable</code> (decomposition table), containing the components and the seasonally adjusted series of a TS decomposition.</li>
<li>
<code>_fc</code> or <code>_fcst</code>: for the <code>fable</code> (forecasts table) that has our forecasts. <img src="https://c.tenor.com/qjBICGJwxgIAAAAC/convenient-thats-convenient.gif" class="img-fluid" data-fig-aling="center">
</li>
</ul>
<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a>
</li>
<li id="fn2">
<p>The Mean Absolute Percentage Error is a percentage error metric widely used in professional environments.</p>
<p>Let</p>
<p><span class="math display">
e_t = y_t - \hat{y}_t
</span></p>
<p>be the error or residual.</p>
<p>Then the MAPE would be computed as</p>
<p><span class="math display">
MAPE = \frac{1}{T}\sum_{t=1}^T|\frac{e_t}{y_t}|
</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a>
</li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/pbenavidesh\.github\.io\/narsil\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../docs/modules/module_1/03_fcst/forecasting.html" class="pagination-link" aria-label="1.3 Forecasting principles">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">1.3 Forecasting principles</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../docs/modules/module_2/01_ets/ets.html" class="pagination-link" aria-label="2.1 Exponential Smoothing">
        <span class="nav-page-text">2.1 Exponential Smoothing</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/pbenavidesh/narsil/edit/main/docs/modules/forecasting_workflow.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/pbenavidesh/narsil/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>