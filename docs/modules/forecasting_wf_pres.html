<!DOCTYPE html>
<html lang="en"><head>
<link href="../../logo.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-57476271c5f0467c372e20ff5d25630e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Pablo Benavides">
  <meta name="dcterms.date" content="2022-09-30">
  <title>Time Series Forecasting – The Forecasting Workflow using fable</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #383a42;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #383a42; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #50a14f; } /* Annotation */
    code span.at { color: #a626a4; } /* Attribute */
    code span.bn { color: #986801; } /* BaseN */
    code span.bu { color: #a626a4; } /* BuiltIn */
    code span.cf { color: #a626a4; } /* ControlFlow */
    code span.ch { color: #50a14f; } /* Char */
    code span.cn { color: #986801; } /* Constant */
    code span.co { color: #a0a1a7; font-style: italic; } /* Comment */
    code span.cv { color: #e45649; font-style: italic; } /* CommentVar */
    code span.do { color: #e45649; } /* Documentation */
    code span.dt { color: #a626a4; } /* DataType */
    code span.dv { color: #986801; } /* DecVal */
    code span.er { color: #f44747; text-decoration: underline; } /* Error */
    code span.ex { color: #4078f2; font-weight: bold; } /* Extension */
    code span.fl { color: #986801; } /* Float */
    code span.fu { color: #4078f2; } /* Function */
    code span.im { color: #50a14f; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #a626a4; } /* Keyword */
    code span.op { color: #a626a4; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #a626a4; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #0184bc; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #50a14f; } /* String */
    code span.va { color: #e45649; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-df339bf3fc0b303c1eb98c039f20d912.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
  <script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
  <script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
  <script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
  <script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
  <link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
  <script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
  <link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
  <script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta property="og:site_name" content="Time Series Forecasting">
<meta name="twitter:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta name="twitter:creator" content="@PabsBenavides">
<meta name="twitter:card" content="summary">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">The Forecasting Workflow using <code>fable</code></h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Pablo Benavides 
</div>
</div>
</div>

  <p class="date">2022-09-30</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>

<li><a href="#/introduction" id="/toc-introduction">Introduction</a>
<ul>
<li><a href="#/packages" id="/toc-packages"><span class="header-section-number">0.1</span> Packages</a></li>
</ul></li>
<li><a href="#/forecasting-workflow" id="/toc-forecasting-workflow"><span class="header-section-number">1</span> Forecasting Workflow</a>
<ul>
<li><a href="#/data" id="/toc-data"><span class="header-section-number">1.1</span> Data</a>
<ul>
<li><a href="#/import-data" id="/toc-import-data"><span class="header-section-number">1.1.1</span> Import data</a></li>
<li><a href="#/wrangle-data" id="/toc-wrangle-data"><span class="header-section-number">1.1.2</span> Wrangle data</a></li>
</ul></li>
<li><a href="#/traintest-split" id="/toc-traintest-split"><span class="header-section-number">1.2</span> Train/Test Split</a></li>
<li><a href="#/visualization-and-eda" id="/toc-visualization-and-eda"><span class="header-section-number">1.3</span> Visualization and EDA</a>
<ul>
<li><a href="#/ts-decomposition" id="/toc-ts-decomposition"><span class="header-section-number">1.3.1</span> TS Decomposition</a></li>
</ul></li>
<li><a href="#/model-specification" id="/toc-model-specification"><span class="header-section-number">1.4</span> Model Specification</a></li>
<li><a href="#/residuals-diagnostics" id="/toc-residuals-diagnostics"><span class="header-section-number">1.5</span> Residuals Diagnostics</a>
<ul>
<li><a href="#/visual-analysis" id="/toc-visual-analysis"><span class="header-section-number">1.5.1</span> Visual analysis</a></li>
<li><a href="#/portmanteau-tests-of-autocorrelation" id="/toc-portmanteau-tests-of-autocorrelation"><span class="header-section-number">1.5.2</span> Portmanteau tests of autocorrelation</a></li>
</ul></li>
<li><a href="#/modeling-using-decomposition" id="/toc-modeling-using-decomposition"><span class="header-section-number">1.6</span> Modeling using decomposition</a>
<ul>
<li><a href="#/residuals-diagnostics-1" id="/toc-residuals-diagnostics-1"><span class="header-section-number">1.6.1</span> Residuals diagnostics</a></li>
</ul></li>
<li><a href="#/forecasting-on-the-test-set" id="/toc-forecasting-on-the-test-set"><span class="header-section-number">1.7</span> Forecasting on the test set</a></li>
<li><a href="#/forecasting-the-future" id="/toc-forecasting-the-future"><span class="header-section-number">1.8</span> Forecasting the future</a></li>
</ul></li>
</ul>
</nav>
</section>
<section class="slide level2">

<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://tidyverts.org/images/fable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="https://tidyverts.org/images/fable.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</section>
<section>
<section id="introduction" class="title-slide slide level1 unnumbered center">
<h1>Introduction</h1>

</section>
<section id="packages" class="slide level2" data-number="0.1">
<h2><span class="header-section-number">0.1</span> Packages</h2>
<p>It is recommended to load all the packages at the beginning of your file. We will be using the <code>tidyverts</code> ecosystem for the whole forecasting workflow.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(feasts)</span>
<span id="cb1-4"><a></a><span class="fu">library</span>(fable)</span>
<span id="cb1-5"><a></a><span class="fu">library</span>(tsibbledata)</span>
<span id="cb1-6"><a></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1-7"><a></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Do not load unnecesary packages into your environment. It could lead to conflicts between functions and unwanted results.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="forecasting-workflow" class="title-slide slide level1 center" data-number="1">
<h1><span class="header-section-number">1</span> Forecasting Workflow</h1>

</section>
<section id="data" class="slide level2 scrollable" data-number="1.1">
<h2><span class="header-section-number">1.1</span> Data</h2>
<p>We will work with the Real Gross Domestic Product (GDP) for Mexico. The data is downloaded from <a href="https://fred.stlouisfed.org/series/NGDPRNSAXDCMXQ">FRED</a>. The time series id is <code>NGDPRNSAXDCMXQ</code>.</p>
<h3 data-number="1.1.1" id="import-data"><span class="header-section-number">1.1.1</span> Import data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>gdp <span class="ot">&lt;-</span> tidyquant<span class="sc">::</span><span class="fu">tq_get</span>(</span>
<span id="cb2-2"><a></a>  <span class="at">x    =</span> <span class="st">"NGDPRNSAXDCMXQ"</span>,</span>
<span id="cb2-3"><a></a>  <span class="at">get  =</span> <span class="st">"economic.data"</span>,</span>
<span id="cb2-4"><a></a>  <span class="at">from =</span> <span class="st">"1997-01-01"</span></span>
<span id="cb2-5"><a></a>)</span>
<span id="cb2-6"><a></a></span>
<span id="cb2-7"><a></a>gdp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["date"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997-01-01","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997-04-01","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997-07-01","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997-10-01","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998-01-01","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998-04-01","3":"4134900"},{"1":"NGDPRNSAXDCMXQ","2":"1998-07-01","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998-10-01","3":"4146842"},{"1":"NGDPRNSAXDCMXQ","2":"1999-01-01","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999-04-01","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999-07-01","3":"4262620"},{"1":"NGDPRNSAXDCMXQ","2":"1999-10-01","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000-01-01","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000-04-01","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000-07-01","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000-10-01","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001-01-01","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001-04-01","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001-07-01","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001-10-01","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002-01-01","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002-04-01","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002-07-01","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002-10-01","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003-01-01","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003-04-01","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003-07-01","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003-10-01","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004-01-01","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004-04-01","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004-07-01","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004-10-01","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005-01-01","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005-04-01","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005-07-01","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005-10-01","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006-01-01","3":"4840642"},{"1":"NGDPRNSAXDCMXQ","2":"2006-04-01","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006-07-01","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006-10-01","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007-01-01","3":"4936400"},{"1":"NGDPRNSAXDCMXQ","2":"2007-04-01","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007-07-01","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007-10-01","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008-01-01","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008-04-01","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008-07-01","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008-10-01","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009-01-01","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009-04-01","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009-07-01","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009-10-01","3":"4990924"},{"1":"NGDPRNSAXDCMXQ","2":"2010-01-01","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010-04-01","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010-07-01","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010-10-01","3":"5169144"},{"1":"NGDPRNSAXDCMXQ","2":"2011-01-01","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011-04-01","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011-07-01","3":"5237546"},{"1":"NGDPRNSAXDCMXQ","2":"2011-10-01","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012-01-01","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012-04-01","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012-07-01","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012-10-01","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013-01-01","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013-04-01","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013-07-01","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013-10-01","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014-01-01","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014-04-01","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014-07-01","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014-10-01","3":"5734912"},{"1":"NGDPRNSAXDCMXQ","2":"2015-01-01","3":"5542388"},{"1":"NGDPRNSAXDCMXQ","2":"2015-04-01","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015-07-01","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015-10-01","3":"5862074"},{"1":"NGDPRNSAXDCMXQ","2":"2016-01-01","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016-04-01","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016-07-01","3":"5803636"},{"1":"NGDPRNSAXDCMXQ","2":"2016-10-01","3":"5995608"},{"1":"NGDPRNSAXDCMXQ","2":"2017-01-01","3":"5826518"},{"1":"NGDPRNSAXDCMXQ","2":"2017-04-01","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017-07-01","3":"5872816"},{"1":"NGDPRNSAXDCMXQ","2":"2017-10-01","3":"6082192"},{"1":"NGDPRNSAXDCMXQ","2":"2018-01-01","3":"5892097"},{"1":"NGDPRNSAXDCMXQ","2":"2018-04-01","3":"6098932"},{"1":"NGDPRNSAXDCMXQ","2":"2018-07-01","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018-10-01","3":"6151319"},{"1":"NGDPRNSAXDCMXQ","2":"2019-01-01","3":"5947650"},{"1":"NGDPRNSAXDCMXQ","2":"2019-04-01","3":"6038705"},{"1":"NGDPRNSAXDCMXQ","2":"2019-07-01","3":"6006225"},{"1":"NGDPRNSAXDCMXQ","2":"2019-10-01","3":"6089150"},{"1":"NGDPRNSAXDCMXQ","2":"2020-01-01","3":"5862506"},{"1":"NGDPRNSAXDCMXQ","2":"2020-04-01","3":"4813222"},{"1":"NGDPRNSAXDCMXQ","2":"2020-07-01","3":"5518064"},{"1":"NGDPRNSAXDCMXQ","2":"2020-10-01","3":"5876143"},{"1":"NGDPRNSAXDCMXQ","2":"2021-01-01","3":"5710210"},{"1":"NGDPRNSAXDCMXQ","2":"2021-04-01","3":"5905829"},{"1":"NGDPRNSAXDCMXQ","2":"2021-07-01","3":"5801183"},{"1":"NGDPRNSAXDCMXQ","2":"2021-10-01","3":"5987609"},{"1":"NGDPRNSAXDCMXQ","2":"2022-01-01","3":"5861010"},{"1":"NGDPRNSAXDCMXQ","2":"2022-04-01","3":"6077842"},{"1":"NGDPRNSAXDCMXQ","2":"2022-07-01","3":"6072366"},{"1":"NGDPRNSAXDCMXQ","2":"2022-10-01","3":"6262165"},{"1":"NGDPRNSAXDCMXQ","2":"2023-01-01","3":"6084749"},{"1":"NGDPRNSAXDCMXQ","2":"2023-04-01","3":"6286473"},{"1":"NGDPRNSAXDCMXQ","2":"2023-07-01","3":"6287328"},{"1":"NGDPRNSAXDCMXQ","2":"2023-10-01","3":"6414734"},{"1":"NGDPRNSAXDCMXQ","2":"2024-01-01","3":"6172962"},{"1":"NGDPRNSAXDCMXQ","2":"2024-04-01","3":"6427776"},{"1":"NGDPRNSAXDCMXQ","2":"2024-07-01","3":"6390892"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<h3 data-number="1.1.2" id="wrangle-data"><span class="header-section-number">1.1.2</span> Wrangle data</h3>
<p>There are some issues with our data:</p>
<ol type="1">
<li>It is loaded into a <code>tibble</code> object. We need to convert it to a <strong><code>tsibble</code></strong>.</li>
</ol>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>We can use <code>as_tsibble()</code> to do so.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Our data is <strong>quarterly</strong>, but it is loaded in a <code>YYYY-MM-DD</code> format. We need to change it to a <code>YYYY QQ</code> format.</li>
</ol>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>There are some functions that help us achieve this, such as</p>
<ul>
<li><code>yearquarter()</code></li>
<li><code>yearmonth()</code></li>
<li><code>yearweek()</code></li>
<li><code>year()</code></li>
</ul>
<p>depending on the time series’ period.</p>
</div>
</div>
</div>
<p>We will overwrite our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>gdp <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">yearquarter</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a></a>  <span class="fu">as_tsibble</span>(</span>
<span id="cb3-4"><a></a>    <span class="at">index =</span> date,</span>
<span id="cb3-5"><a></a>    <span class="at">key   =</span> symbol</span>
<span id="cb3-6"><a></a>  )</span>
<span id="cb3-7"><a></a></span>
<span id="cb3-8"><a></a>gdp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134900"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146842"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262620"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840642"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936400"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990924"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169144"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237546"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734912"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542388"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862074"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803636"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995608"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826518"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872816"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082192"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892097"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098932"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151319"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947650"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038705"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006225"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089150"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862506"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813222"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518064"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876143"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q1","3":"5710210"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q2","3":"5905829"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q3","3":"5801183"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q4","3":"5987609"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q1","3":"5861010"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q2","3":"6077842"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q3","3":"6072366"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q4","3":"6262165"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q1","3":"6084749"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q2","3":"6286473"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q3","3":"6287328"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q4","3":"6414734"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q1","3":"6172962"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q2","3":"6427776"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q3","3":"6390892"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>We always need to specify the <code>index</code> argument, as it is our <strong>date</strong> variable.</p></li>
<li><p>The <code>key</code> argument is necessary whenever we have more than one time series in our data frame and is made up of <strong>one or more columns</strong> that uniquely identify each time series .</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="traintest-split" class="slide level2 scrollable" data-number="1.2">
<h2><span class="header-section-number">1.2</span> Train/Test Split</h2>
<p>We will split our data in two sets: a training set, and a test set, in order to evaluate our forecasts’ accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>gdp_train <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a></a>  <span class="fu">filter_index</span>(. <span class="sc">~</span> <span class="st">"2020 Q4"</span>)</span>
<span id="cb4-3"><a></a></span>
<span id="cb4-4"><a></a>gdp_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134900"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146842"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262620"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840642"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936400"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990924"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169144"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237546"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734912"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542388"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862074"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803636"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995608"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826518"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872816"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082192"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892097"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098932"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151319"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947650"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038705"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006225"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089150"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862506"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813222"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518064"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876143"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>For all our variables, it is strongly recommended to follow the same notation process, and write our code using <a href="https://en.wikipedia.org/wiki/Snake_case"><strong>snake_case</strong></a>. Here, we called our data <code>gdp</code>, therefore, all the following variables will be called starting with <strong><code>gdp_</code></strong><sup>1</sup>, such as <code>gdp_train</code> for our training set.</p>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>This will make it very convenient when calling your variables. RStudio will display all the options starting with <code>gdp_</code>. We will usually use the following suffixes:</p>
<ul>
<li><code>_train</code>: training set</li>
<li><code>_fit</code>: the <code>mable</code> (table of models)</li>
<li><code>_aug</code>: the augmented table with fitted values and residuals</li>
<li><code>_dcmp</code>: for the <code>dable</code> (decomposition table), containing the components and the seasonally adjusted series of a TS decomposition.</li>
<li><code>_fc</code> or <code>_fcst</code>: for the <code>fable</code> (forecasts table) that has our forecasts. <img data-src="https://c.tenor.com/qjBICGJwxgIAAAAC/convenient-thats-convenient.gif" data-fig-aling="center"></li>
</ul>
</li></ol></aside></section>
<section id="visualization-and-eda" class="slide level2" data-number="1.3">
<h2><span class="header-section-number">1.3</span> Visualization and EDA</h2>
<p>When performing time series analysis/forecasting, one of the first things to do is to create a time series plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>p <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a></a>  <span class="fu">autoplot</span>(price) <span class="sc">+</span></span>
<span id="cb5-3"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb5-4"><a></a>    <span class="at">title =</span> <span class="st">"Time series plot of the Real GDP for Mexico"</span>,</span>
<span id="cb5-5"><a></a>    <span class="at">y =</span> <span class="st">"GDP"</span></span>
<span id="cb5-6"><a></a>  )</span>
<span id="cb5-7"><a></a> </span>
<span id="cb5-8"><a></a><span class="fu">ggplotly</span>(p, <span class="at">dynamicTicks =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a></a>  <span class="fu">rangeslider</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2c6e5aa132747e30202d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2c6e5aa132747e30202d">{"x":{"data":[{"x":["1997-01-01","1997-04-01","1997-07-01","1997-10-01","1998-01-01","1998-04-01","1998-07-01","1998-10-01","1999-01-01","1999-04-01","1999-07-01","1999-10-01","2000-01-01","2000-04-01","2000-07-01","2000-10-01","2001-01-01","2001-04-01","2001-07-01","2001-10-01","2002-01-01","2002-04-01","2002-07-01","2002-10-01","2003-01-01","2003-04-01","2003-07-01","2003-10-01","2004-01-01","2004-04-01","2004-07-01","2004-10-01","2005-01-01","2005-04-01","2005-07-01","2005-10-01","2006-01-01","2006-04-01","2006-07-01","2006-10-01","2007-01-01","2007-04-01","2007-07-01","2007-10-01","2008-01-01","2008-04-01","2008-07-01","2008-10-01","2009-01-01","2009-04-01","2009-07-01","2009-10-01","2010-01-01","2010-04-01","2010-07-01","2010-10-01","2011-01-01","2011-04-01","2011-07-01","2011-10-01","2012-01-01","2012-04-01","2012-07-01","2012-10-01","2013-01-01","2013-04-01","2013-07-01","2013-10-01","2014-01-01","2014-04-01","2014-07-01","2014-10-01","2015-01-01","2015-04-01","2015-07-01","2015-10-01","2016-01-01","2016-04-01","2016-07-01","2016-10-01","2017-01-01","2017-04-01","2017-07-01","2017-10-01","2018-01-01","2018-04-01","2018-07-01","2018-10-01","2019-01-01","2019-04-01","2019-07-01","2019-10-01","2020-01-01","2020-04-01","2020-07-01","2020-10-01"],"y":[3702397.75,3896084,3906063,4038358.5,4084303.5,4134899.5,4138199.75,4146841.5,4176243.25,4232279.5,4262620.5,4287797.5,4412426.5,4465504,4505221,4428703,4441058,4468505,4440265,4381722.5,4269784.5,4504199.5,4457001,4458615,4402401.5,4520666,4464787,4511463.5,4546254,4692565,4615345,4683343.5,4567922,4804679,4720817.5,4835832.5,4840642.5,5029028,4959002,5010131,4936399.5,5127368,5066709,5120551,4975730.5,5249626,5123968,5092737,4634315,4706891,4823052.5,4990924.5,4842967.5,5045140.5,5050199.5,5169143.5,5022838,5170733.5,5237545.5,5368843.5,5270945,5380528,5369752,5517801.5,5256450.5,5473377,5425704,5567030,5386945.5,5580039,5564547,5734911.5,5542388.5,5710754.5,5752936.5,5862074.5,5634258,5839989,5803635.5,5995608.5,5826517.5,5927581.5,5872816.5,6082192,5892097,6098932.5,6034322,6151319,5947650.5,6038705,6006225,6089150.5,5862506,4813221.5,5518064,5876143],"text":["date: 1997 Q1<br />price: 3702398","date: 1997 Q2<br />price: 3896084","date: 1997 Q3<br />price: 3906063","date: 1997 Q4<br />price: 4038358","date: 1998 Q1<br />price: 4084304","date: 1998 Q2<br />price: 4134900","date: 1998 Q3<br />price: 4138200","date: 1998 Q4<br />price: 4146842","date: 1999 Q1<br />price: 4176243","date: 1999 Q2<br />price: 4232280","date: 1999 Q3<br />price: 4262620","date: 1999 Q4<br />price: 4287798","date: 2000 Q1<br />price: 4412426","date: 2000 Q2<br />price: 4465504","date: 2000 Q3<br />price: 4505221","date: 2000 Q4<br />price: 4428703","date: 2001 Q1<br />price: 4441058","date: 2001 Q2<br />price: 4468505","date: 2001 Q3<br />price: 4440265","date: 2001 Q4<br />price: 4381722","date: 2002 Q1<br />price: 4269784","date: 2002 Q2<br />price: 4504200","date: 2002 Q3<br />price: 4457001","date: 2002 Q4<br />price: 4458615","date: 2003 Q1<br />price: 4402402","date: 2003 Q2<br />price: 4520666","date: 2003 Q3<br />price: 4464787","date: 2003 Q4<br />price: 4511464","date: 2004 Q1<br />price: 4546254","date: 2004 Q2<br />price: 4692565","date: 2004 Q3<br />price: 4615345","date: 2004 Q4<br />price: 4683344","date: 2005 Q1<br />price: 4567922","date: 2005 Q2<br />price: 4804679","date: 2005 Q3<br />price: 4720818","date: 2005 Q4<br />price: 4835832","date: 2006 Q1<br />price: 4840642","date: 2006 Q2<br />price: 5029028","date: 2006 Q3<br />price: 4959002","date: 2006 Q4<br />price: 5010131","date: 2007 Q1<br />price: 4936400","date: 2007 Q2<br />price: 5127368","date: 2007 Q3<br />price: 5066709","date: 2007 Q4<br />price: 5120551","date: 2008 Q1<br />price: 4975730","date: 2008 Q2<br />price: 5249626","date: 2008 Q3<br />price: 5123968","date: 2008 Q4<br />price: 5092737","date: 2009 Q1<br />price: 4634315","date: 2009 Q2<br />price: 4706891","date: 2009 Q3<br />price: 4823052","date: 2009 Q4<br />price: 4990924","date: 2010 Q1<br />price: 4842968","date: 2010 Q2<br />price: 5045140","date: 2010 Q3<br />price: 5050200","date: 2010 Q4<br />price: 5169144","date: 2011 Q1<br />price: 5022838","date: 2011 Q2<br />price: 5170734","date: 2011 Q3<br />price: 5237546","date: 2011 Q4<br />price: 5368844","date: 2012 Q1<br />price: 5270945","date: 2012 Q2<br />price: 5380528","date: 2012 Q3<br />price: 5369752","date: 2012 Q4<br />price: 5517802","date: 2013 Q1<br />price: 5256450","date: 2013 Q2<br />price: 5473377","date: 2013 Q3<br />price: 5425704","date: 2013 Q4<br />price: 5567030","date: 2014 Q1<br />price: 5386946","date: 2014 Q2<br />price: 5580039","date: 2014 Q3<br />price: 5564547","date: 2014 Q4<br />price: 5734912","date: 2015 Q1<br />price: 5542388","date: 2015 Q2<br />price: 5710754","date: 2015 Q3<br />price: 5752936","date: 2015 Q4<br />price: 5862074","date: 2016 Q1<br />price: 5634258","date: 2016 Q2<br />price: 5839989","date: 2016 Q3<br />price: 5803636","date: 2016 Q4<br />price: 5995608","date: 2017 Q1<br />price: 5826518","date: 2017 Q2<br />price: 5927582","date: 2017 Q3<br />price: 5872816","date: 2017 Q4<br />price: 6082192","date: 2018 Q1<br />price: 5892097","date: 2018 Q2<br />price: 6098932","date: 2018 Q3<br />price: 6034322","date: 2018 Q4<br />price: 6151319","date: 2019 Q1<br />price: 5947650","date: 2019 Q2<br />price: 6038705","date: 2019 Q3<br />price: 6006225","date: 2019 Q4<br />price: 6089150","date: 2020 Q1<br />price: 5862506","date: 2020 Q2<br />price: 4813222","date: 2020 Q3<br />price: 5518064","date: 2020 Q4<br />price: 5876143"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time series plot of the Real GDP for Mexico","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"tickmode":"auto","ticktext":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"tickvals":[10957,12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"date [1Q]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f","rangeslider":{"visible":true}},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[3579951.6875,6273765.0625],"tickmode":"auto","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"GDP","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"18315ab43fdb":{"x":{},"y":{},"type":"scatter"}},"cur_data":"18315ab43fdb","visdat":{"18315ab43fdb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>Our data exhibits an upward <em>linear trend</em> (with some economic cycles), and strong <em>yearly seasonality</em>.</p>
</div>
</div>
</div>
<p>We will explore it further with a season plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a></a>  <span class="fu">gg_season</span>(price) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a></a>  <span class="fu">ggplotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6c0ca124f2553eecab59" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6c0ca124f2553eecab59">{"x":{"data":[{"x":[1096,1186,1277,1369],"y":[3702397.75,3896084,3906063,4038358.5],"text":["date: 1973 Q1<br />price: 3702398<br />unclass(id):  1<br />id: 1997","date: 1973 Q2<br />price: 3896084<br />unclass(id):  1<br />id: 1997","date: 1973 Q3<br />price: 3906063<br />unclass(id):  1<br />id: 1997","date: 1973 Q4<br />price: 4038358<br />unclass(id):  1<br />id: 1997"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4084303.5,4134899.5,4138199.75,4146841.5],"text":["date: 1973 Q1<br />price: 4084304<br />unclass(id):  2<br />id: 1998","date: 1973 Q2<br />price: 4134900<br />unclass(id):  2<br />id: 1998","date: 1973 Q3<br />price: 4138200<br />unclass(id):  2<br />id: 1998","date: 1973 Q4<br />price: 4146842<br />unclass(id):  2<br />id: 1998"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(236,129,82,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4176243.25,4232279.5,4262620.5,4287797.5],"text":["date: 1973 Q1<br />price: 4176243<br />unclass(id):  3<br />id: 1999","date: 1973 Q2<br />price: 4232280<br />unclass(id):  3<br />id: 1999","date: 1973 Q3<br />price: 4262620<br />unclass(id):  3<br />id: 1999","date: 1973 Q4<br />price: 4287798<br />unclass(id):  3<br />id: 1999"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(223,139,51,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4412426.5,4465504,4505221,4428703],"text":["date: 1973 Q1<br />price: 4412426<br />unclass(id):  4<br />id: 2000","date: 1973 Q2<br />price: 4465504<br />unclass(id):  4<br />id: 2000","date: 1973 Q3<br />price: 4505221<br />unclass(id):  4<br />id: 2000","date: 1973 Q4<br />price: 4428703<br />unclass(id):  4<br />id: 2000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(208,147,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4441058,4468505,4440265,4381722.5],"text":["date: 1973 Q1<br />price: 4441058<br />unclass(id):  5<br />id: 2001","date: 1973 Q2<br />price: 4468505<br />unclass(id):  5<br />id: 2001","date: 1973 Q3<br />price: 4440265<br />unclass(id):  5<br />id: 2001","date: 1973 Q4<br />price: 4381722<br />unclass(id):  5<br />id: 2001"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(188,157,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4269784.5,4504199.5,4457001,4458615],"text":["date: 1973 Q1<br />price: 4269784<br />unclass(id):  6<br />id: 2002","date: 1973 Q2<br />price: 4504200<br />unclass(id):  6<br />id: 2002","date: 1973 Q3<br />price: 4457001<br />unclass(id):  6<br />id: 2002","date: 1973 Q4<br />price: 4458615<br />unclass(id):  6<br />id: 2002"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(165,165,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4402401.5,4520666,4464787,4511463.5],"text":["date: 1973 Q1<br />price: 4402402<br />unclass(id):  7<br />id: 2003","date: 1973 Q2<br />price: 4520666<br />unclass(id):  7<br />id: 2003","date: 1973 Q3<br />price: 4464787<br />unclass(id):  7<br />id: 2003","date: 1973 Q4<br />price: 4511464<br />unclass(id):  7<br />id: 2003"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(140,172,9,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4546254,4692565,4615345,4683343.5],"text":["date: 1973 Q1<br />price: 4546254<br />unclass(id):  8<br />id: 2004","date: 1973 Q2<br />price: 4692565<br />unclass(id):  8<br />id: 2004","date: 1973 Q3<br />price: 4615345<br />unclass(id):  8<br />id: 2004","date: 1973 Q4<br />price: 4683344<br />unclass(id):  8<br />id: 2004"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(111,178,33,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4567922,4804679,4720817.5,4835832.5],"text":["date: 1973 Q1<br />price: 4567922<br />unclass(id):  9<br />id: 2005","date: 1973 Q2<br />price: 4804679<br />unclass(id):  9<br />id: 2005","date: 1973 Q3<br />price: 4720818<br />unclass(id):  9<br />id: 2005","date: 1973 Q4<br />price: 4835832<br />unclass(id):  9<br />id: 2005"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(69,183,48,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4840642.5,5029028,4959002,5010131],"text":["date: 1973 Q1<br />price: 4840642<br />unclass(id): 10<br />id: 2006","date: 1973 Q2<br />price: 5029028<br />unclass(id): 10<br />id: 2006","date: 1973 Q3<br />price: 4959002<br />unclass(id): 10<br />id: 2006","date: 1973 Q4<br />price: 5010131<br />unclass(id): 10<br />id: 2006"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(15,187,72,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4936399.5,5127368,5066709,5120551],"text":["date: 1973 Q1<br />price: 4936400<br />unclass(id): 11<br />id: 2007","date: 1973 Q2<br />price: 5127368<br />unclass(id): 11<br />id: 2007","date: 1973 Q3<br />price: 5066709<br />unclass(id): 11<br />id: 2007","date: 1973 Q4<br />price: 5120551<br />unclass(id): 11<br />id: 2007"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(28,189,108,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4975730.5,5249626,5123968,5092737],"text":["date: 1973 Q1<br />price: 4975730<br />unclass(id): 12<br />id: 2008","date: 1973 Q2<br />price: 5249626<br />unclass(id): 12<br />id: 2008","date: 1973 Q3<br />price: 5123968<br />unclass(id): 12<br />id: 2008","date: 1973 Q4<br />price: 5092737<br />unclass(id): 12<br />id: 2008"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(20,192,142,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4634315,4706891,4823052.5,4990924.5],"text":["date: 1973 Q1<br />price: 4634315<br />unclass(id): 13<br />id: 2009","date: 1973 Q2<br />price: 4706891<br />unclass(id): 13<br />id: 2009","date: 1973 Q3<br />price: 4823052<br />unclass(id): 13<br />id: 2009","date: 1973 Q4<br />price: 4990924<br />unclass(id): 13<br />id: 2009"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(14,192,171,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4842967.5,5045140.5,5050199.5,5169143.5],"text":["date: 1973 Q1<br />price: 4842968<br />unclass(id): 14<br />id: 2010","date: 1973 Q2<br />price: 5045140<br />unclass(id): 14<br />id: 2010","date: 1973 Q3<br />price: 5050200<br />unclass(id): 14<br />id: 2010","date: 1973 Q4<br />price: 5169144<br />unclass(id): 14<br />id: 2010"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(22,189,194,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5022838,5170733.5,5237545.5,5368843.5],"text":["date: 1973 Q1<br />price: 5022838<br />unclass(id): 15<br />id: 2011","date: 1973 Q2<br />price: 5170734<br />unclass(id): 15<br />id: 2011","date: 1973 Q3<br />price: 5237546<br />unclass(id): 15<br />id: 2011","date: 1973 Q4<br />price: 5368844<br />unclass(id): 15<br />id: 2011"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(12,186,218,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5270945,5380528,5369752,5517801.5],"text":["date: 1973 Q1<br />price: 5270945<br />unclass(id): 16<br />id: 2012","date: 1973 Q2<br />price: 5380528<br />unclass(id): 16<br />id: 2012","date: 1973 Q3<br />price: 5369752<br />unclass(id): 16<br />id: 2012","date: 1973 Q4<br />price: 5517802<br />unclass(id): 16<br />id: 2012"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(46,179,233,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5256450.5,5473377,5425704,5567030],"text":["date: 1973 Q1<br />price: 5256450<br />unclass(id): 17<br />id: 2013","date: 1973 Q2<br />price: 5473377<br />unclass(id): 17<br />id: 2013","date: 1973 Q3<br />price: 5425704<br />unclass(id): 17<br />id: 2013","date: 1973 Q4<br />price: 5567030<br />unclass(id): 17<br />id: 2013"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(75,169,243,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5386945.5,5580039,5564547,5734911.5],"text":["date: 1973 Q1<br />price: 5386946<br />unclass(id): 18<br />id: 2014","date: 1973 Q2<br />price: 5580039<br />unclass(id): 18<br />id: 2014","date: 1973 Q3<br />price: 5564547<br />unclass(id): 18<br />id: 2014","date: 1973 Q4<br />price: 5734912<br />unclass(id): 18<br />id: 2014"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(93,159,253,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5542388.5,5710754.5,5752936.5,5862074.5],"text":["date: 1973 Q1<br />price: 5542388<br />unclass(id): 19<br />id: 2015","date: 1973 Q2<br />price: 5710754<br />unclass(id): 19<br />id: 2015","date: 1973 Q3<br />price: 5752936<br />unclass(id): 19<br />id: 2015","date: 1973 Q4<br />price: 5862074<br />unclass(id): 19<br />id: 2015"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(139,148,254,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5634258,5839989,5803635.5,5995608.5],"text":["date: 1973 Q1<br />price: 5634258<br />unclass(id): 20<br />id: 2016","date: 1973 Q2<br />price: 5839989<br />unclass(id): 20<br />id: 2016","date: 1973 Q3<br />price: 5803636<br />unclass(id): 20<br />id: 2016","date: 1973 Q4<br />price: 5995608<br />unclass(id): 20<br />id: 2016"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(180,134,253,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5826517.5,5927581.5,5872816.5,6082192],"text":["date: 1973 Q1<br />price: 5826518<br />unclass(id): 21<br />id: 2017","date: 1973 Q2<br />price: 5927582<br />unclass(id): 21<br />id: 2017","date: 1973 Q3<br />price: 5872816<br />unclass(id): 21<br />id: 2017","date: 1973 Q4<br />price: 6082192<br />unclass(id): 21<br />id: 2017"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(215,117,251,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5892097,6098932.5,6034322,6151319],"text":["date: 1973 Q1<br />price: 5892097<br />unclass(id): 22<br />id: 2018","date: 1973 Q2<br />price: 6098932<br />unclass(id): 22<br />id: 2018","date: 1973 Q3<br />price: 6034322<br />unclass(id): 22<br />id: 2018","date: 1973 Q4<br />price: 6151319<br />unclass(id): 22<br />id: 2018"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(232,109,234,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5947650.5,6038705,6006225,6089150.5],"text":["date: 1973 Q1<br />price: 5947650<br />unclass(id): 23<br />id: 2019","date: 1973 Q2<br />price: 6038705<br />unclass(id): 23<br />id: 2019","date: 1973 Q3<br />price: 6006225<br />unclass(id): 23<br />id: 2019","date: 1973 Q4<br />price: 6089150<br />unclass(id): 23<br />id: 2019"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(244,103,214,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5862506,4813221.5,5518064,5876143],"text":["date: 1973 Q1<br />price: 5862506<br />unclass(id): 24<br />id: 2020","date: 1973 Q2<br />price: 4813222<br />unclass(id): 24<br />id: 2020","date: 1973 Q3<br />price: 5518064<br />unclass(id): 24<br />id: 2020","date: 1973 Q4<br />price: 5876143<br />unclass(id): 24<br />id: 2020"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,97,195,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1369],"y":[4000000],"name":"da3493f51f6cbd60bb9b3328af4d19e8","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F8766D"],[0.0033444816053511683,"#F7776B"],[0.0066889632107023367,"#F67869"],[0.010033444816053515,"#F57967"],[0.013377926421404684,"#F47A65"],[0.016722408026755852,"#F47A63"],[0.020066889632107031,"#F37B61"],[0.023411371237458199,"#F27C5F"],[0.026755852842809368,"#F17D5D"],[0.030100334448160536,"#F07E5B"],[0.033444816053511704,"#EF7F59"],[0.03678929765886288,"#EE7F56"],[0.040133779264214048,"#ED8054"],[0.043478260869565216,"#EC8152"],[0.046822742474916398,"#EB8250"],[0.050167224080267574,"#EA834E"],[0.053511705685618735,"#E9834C"],[0.05685618729096989,"#E88449"],[0.060200668896321072,"#E78547"],[0.06354515050167224,"#E68645"],[0.066889632107023408,"#E58642"],[0.070234113712374577,"#E48740"],[0.073578595317725759,"#E3883D"],[0.076923076923076913,"#E2883B"],[0.080267558528428096,"#E18938"],[0.083612040133779278,"#E08A36"],[0.086956521739130432,"#DF8B33"],[0.090301003344481615,"#DE8B30"],[0.093645484949832797,"#DD8C2D"],[0.096989966555183951,"#DC8D2A"],[0.10033444816053513,"#DB8D27"],[0.10367892976588629,"#DA8E24"],[0.10702341137123747,"#D98F20"],[0.11036789297658864,"#D88F1C"],[0.11371237458193981,"#D79017"],[0.11705685618729098,"#D69112"],[0.12040133779264214,"#D5910B"],[0.12374581939799331,"#D39203"],[0.12709030100334448,"#D29200"],[0.13043478260869565,"#D09300"],[0.13377926421404682,"#CF9400"],[0.13712374581939801,"#CD9500"],[0.14046822742474915,"#CC9600"],[0.14381270903010038,"#CA9600"],[0.14715719063545152,"#C99700"],[0.15050167224080269,"#C79800"],[0.15384615384615383,"#C59800"],[0.157190635451505,"#C49900"],[0.16053511705685619,"#C29A00"],[0.16387959866220739,"#C19B00"],[0.16722408026755856,"#BF9B00"],[0.17056856187290972,"#BD9C00"],[0.17391304347826086,"#BC9D00"],[0.17725752508361206,"#BA9D00"],[0.18060200668896323,"#B89E00"],[0.1839464882943144,"#B79F00"],[0.18729096989966559,"#B59F00"],[0.19063545150501673,"#B3A000"],[0.1939799331103679,"#B2A000"],[0.19732441471571907,"#B0A100"],[0.20066889632107027,"#AEA200"],[0.20401337792642141,"#ACA200"],[0.20735785953177258,"#ABA300"],[0.21070234113712377,"#A9A300"],[0.21404682274247494,"#A7A400"],[0.21739130434782608,"#A5A500"],[0.22073578595317728,"#A4A500"],[0.22408026755852845,"#A2A600"],[0.22742474916387961,"#A0A600"],[0.23076923076923081,"#9EA700"],[0.23411371237458195,"#9CA700"],[0.23745819397993312,"#9AA800"],[0.24080267558528429,"#98A900"],[0.24414715719063548,"#96A900"],[0.24749163879598662,"#94AA00"],[0.25083612040133779,"#93AA01"],[0.25418060200668896,"#91AB03"],[0.25752508361204013,"#8EAB06"],[0.2608695652173913,"#8CAC09"],[0.26421404682274252,"#8AAC0C"],[0.26755852842809363,"#88AD0E"],[0.2709030100334448,"#86AD10"],[0.27424749163879603,"#84AE12"],[0.27759197324414719,"#82AE14"],[0.28093645484949831,"#80AE16"],[0.28428093645484953,"#7DAF18"],[0.2876254180602007,"#7BAF19"],[0.29096989966555187,"#79B01B"],[0.29431438127090304,"#76B01C"],[0.2976588628762542,"#74B11E"],[0.30100334448160537,"#71B11F"],[0.30434782608695654,"#6FB221"],[0.30769230769230765,"#6CB222"],[0.31103678929765882,"#69B223"],[0.31438127090300999,"#67B324"],[0.31772575250836121,"#64B326"],[0.32107023411371238,"#61B427"],[0.32441471571906355,"#5EB428"],[0.32775919732441477,"#5BB529"],[0.33110367892976594,"#57B52A"],[0.33444816053511711,"#54B52B"],[0.33779264214046828,"#50B62D"],[0.34113712374581945,"#4DB62E"],[0.34448160535117056,"#49B72F"],[0.34782608695652173,"#45B730"],[0.3511705685618729,"#40B731"],[0.35451505016722412,"#3BB832"],[0.35785953177257529,"#36B833"],[0.36120401337792646,"#30B834"],[0.36454849498327763,"#29B935"],[0.3678929765886288,"#21B936"],[0.37123745819397991,"#16BA37"],[0.37458193979933119,"#03BA38"],[0.3779264214046823,"#03BA3B"],[0.38127090301003347,"#07BA3E"],[0.38461538461538464,"#0ABB42"],[0.38795986622073581,"#0DBB45"],[0.39130434782608697,"#0FBB48"],[0.39464882943143814,"#11BB4B"],[0.39799331103678937,"#13BB4E"],[0.40133779264214053,"#14BB51"],[0.40468227424749165,"#16BC54"],[0.40802675585284282,"#17BC56"],[0.41137123745819398,"#18BC59"],[0.41471571906354515,"#19BC5C"],[0.41806020066889638,"#1ABC5F"],[0.42140468227424754,"#1ABD62"],[0.42474916387959871,"#1BBD64"],[0.42809364548494988,"#1BBD67"],[0.43143812709030099,"#1BBD6A"],[0.43478260869565216,"#1CBD6C"],[0.43812709030100333,"#1CBD6F"],[0.44147157190635455,"#1CBE72"],[0.44481605351170572,"#1CBE74"],[0.44816053511705689,"#1CBE77"],[0.45150501672240806,"#1BBE7A"],[0.45484949832775923,"#1BBE7C"],[0.45819397993311034,"#1ABF7F"],[0.46153846153846162,"#1ABF81"],[0.46488294314381273,"#19BF84"],[0.4682274247491639,"#18BF87"],[0.47157190635451507,"#17BF89"],[0.47491638795986624,"#16C08C"],[0.47826086956521741,"#14C08E"],[0.48160535117056857,"#12C091"],[0.4849498327759198,"#10C093"],[0.48829431438127097,"#0EC096"],[0.49163879598662208,"#0AC199"],[0.49498327759197325,"#06C19B"],[0.49832775919732442,"#02C19E"],[0.50167224080267558,"#01C1A0"],[0.50501672240802686,"#04C1A2"],[0.50836120401337792,"#06C0A4"],[0.51170568561872909,"#09C0A5"],[0.51505016722408026,"#0BC0A7"],[0.51839464882943143,"#0DC0A9"],[0.52173913043478259,"#0EC0AB"],[0.52508361204013387,"#0FBFAD"],[0.52842809364548504,"#11BFAF"],[0.53177257525083621,"#12BFB0"],[0.53511705685618727,"#13BFB2"],[0.53846153846153844,"#13BFB4"],[0.5418060200668896,"#14BEB6"],[0.54515050167224077,"#15BEB8"],[0.54849498327759205,"#15BEB9"],[0.55183946488294322,"#15BEBB"],[0.55518394648829439,"#16BEBD"],[0.55852842809364556,"#16BDBF"],[0.56187290969899661,"#16BDC1"],[0.56521739130434778,"#16BDC2"],[0.56856187290969906,"#16BDC4"],[0.57190635451505023,"#16BCC6"],[0.5752508361204014,"#15BCC8"],[0.57859531772575257,"#15BCCA"],[0.58193979933110374,"#15BCCC"],[0.5852842809364549,"#14BCCD"],[0.58862876254180607,"#13BBCF"],[0.59197324414715724,"#13BBD1"],[0.59531772575250841,"#12BBD3"],[0.59866220735785958,"#11BBD5"],[0.60200668896321075,"#0FBBD6"],[0.60535117056856191,"#0EBAD8"],[0.60869565217391308,"#0CBADA"],[0.61204013377926425,"#0ABADC"],[0.61538461538461542,"#08BADE"],[0.61872909698996659,"#05B9E0"],[0.62207357859531776,"#03B9E1"],[0.62541806020066892,"#01B9E3"],[0.62876254180602009,"#0DB8E4"],[0.63210702341137126,"#15B7E5"],[0.63545150501672243,"#1BB7E5"],[0.6387959866220736,"#20B6E6"],[0.64214046822742477,"#24B5E7"],[0.64548494983277593,"#28B4E8"],[0.6488294314381271,"#2BB4E8"],[0.65217391304347827,"#2EB3E9"],[0.65551839464882955,"#31B2EA"],[0.65886287625418061,"#34B1EB"],[0.66220735785953189,"#37B1EB"],[0.66555183946488294,"#39B0EC"],[0.66889632107023422,"#3BAFED"],[0.67224080267558517,"#3EAEEE"],[0.67558528428093656,"#40AEEE"],[0.67892976588628773,"#42ADEF"],[0.6822742474916389,"#44ACF0"],[0.68561872909698995,"#46ABF1"],[0.68896321070234112,"#47ABF1"],[0.69230769230769229,"#49AAF2"],[0.69565217391304346,"#4BA9F3"],[0.69899665551839463,"#4CA8F4"],[0.7023411371237458,"#4EA8F4"],[0.70568561872909696,"#50A7F5"],[0.70903010033444824,"#51A6F6"],[0.71237458193979941,"#53A5F7"],[0.71571906354515058,"#54A4F7"],[0.71906354515050175,"#55A4F8"],[0.72240802675585292,"#57A3F9"],[0.72575250836120409,"#58A2FA"],[0.72909698996655525,"#59A1FA"],[0.73244147157190642,"#5BA0FB"],[0.73578595317725759,"#5CA0FC"],[0.73913043478260865,"#5D9FFD"],[0.74247491638795982,"#5E9EFD"],[0.74581939799331098,"#609DFE"],[0.74916387959866237,"#619CFF"],[0.75250836120401343,"#659BFF"],[0.7558528428093646,"#6A9BFF"],[0.75919732441471577,"#6F9AFF"],[0.76254180602006694,"#7399FF"],[0.76588628762541811,"#7798FE"],[0.76923076923076927,"#7C97FE"],[0.77257525083612044,"#8096FE"],[0.77591973244147161,"#8495FE"],[0.77926421404682278,"#8794FE"],[0.78260869565217395,"#8B94FE"],[0.78595317725752512,"#8F93FE"],[0.78929765886287628,"#9292FE"],[0.79264214046822756,"#9691FE"],[0.79598662207357873,"#9990FD"],[0.7993311036789299,"#9C8FFD"],[0.80267558528428107,"#9F8EFD"],[0.80602006688963213,"#A38DFD"],[0.80936454849498329,"#A68CFD"],[0.81270903010033446,"#A98AFD"],[0.81605351170568563,"#AC89FD"],[0.8193979933110368,"#AF88FD"],[0.82274247491638797,"#B287FD"],[0.82608695652173914,"#B486FD"],[0.8294314381270903,"#B785FC"],[0.83277591973244147,"#BA84FC"],[0.83612040133779275,"#BD82FC"],[0.83946488294314392,"#C081FC"],[0.84280936454849509,"#C280FC"],[0.84615384615384626,"#C57EFC"],[0.84949832775919742,"#C87DFC"],[0.85284280936454859,"#CA7CFC"],[0.85618729096989976,"#CD7AFC"],[0.85953177257525082,"#CF79FB"],[0.86287625418060199,"#D278FB"],[0.86622073578595316,"#D476FB"],[0.86956521739130432,"#D775FB"],[0.87290969899665549,"#D973FB"],[0.87625418060200666,"#DB72FA"],[0.87959866220735794,"#DD71F9"],[0.88294314381270911,"#DE71F7"],[0.88628762541806028,"#DF71F6"],[0.88963210702341144,"#E070F4"],[0.89297658862876261,"#E170F3"],[0.89632107023411378,"#E26FF1"],[0.89966555183946495,"#E36FF0"],[0.90301003344481612,"#E56EEE"],[0.90635451505016729,"#E66EED"],[0.90969899665551845,"#E76DEB"],[0.91304347826086951,"#E86DEA"],[0.91638795986622068,"#E96DE8"],[0.91973244147157185,"#EA6CE7"],[0.92307692307692324,"#EB6CE5"],[0.92642140468227441,"#EC6BE4"],[0.92976588628762546,"#ED6BE2"],[0.93311036789297663,"#EE6AE1"],[0.9364548494983278,"#EF6ADF"],[0.93979933110367897,"#F069DE"],[0.94314381270903014,"#F169DC"],[0.94648829431438131,"#F168DB"],[0.94983277591973247,"#F268D9"],[0.95317725752508364,"#F368D8"],[0.95652173913043481,"#F467D6"],[0.95986622073578598,"#F567D5"],[0.96321070234113715,"#F666D3"],[0.96655518394648843,"#F766D2"],[0.9698996655518396,"#F865D0"],[0.97324414715719076,"#F965CF"],[0.97658862876254193,"#F964CD"],[0.9799331103678931,"#FA64CC"],[0.98327759197324416,"#FB63CA"],[0.98662207357859533,"#FC63C9"],[0.98996655518394649,"#FD62C7"],[0.99331103678929766,"#FD62C6"],[0.99665551839464883,"#FE61C4"],[1,"#FF61C3"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["2001","2006","2011","2016"],"tickvals":[0.17499999999999999,0.39166666666666666,0.60833333333333339,0.82499999999999996],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1082.3499999999999,1382.6500000000001],"tickmode":"array","ticktext":["Q4","Q1","Q2","Q3"],"tickvals":[1369,1096,1186,1277],"categoryorder":"array","categoryarray":["Q4","Q1","Q2","Q3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.6875,6273765.0625],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"183124d1d9fa":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"183124d1d9fa","visdat":{"183124d1d9fa":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<h3 data-number="1.3.1" id="ts-decomposition"><span class="header-section-number">1.3.1</span> TS Decomposition</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(price, <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a></a>  <span class="fu">autoplot</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a></a>  <span class="fu">ggplotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-403524ccfc0d16a70863" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-403524ccfc0d16a70863">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[3702397.75,3896084,3906063,4038358.5,4084303.5,4134899.5,4138199.75,4146841.5,4176243.25,4232279.5,4262620.5,4287797.5,4412426.5,4465504,4505221,4428703,4441058,4468505,4440265,4381722.5,4269784.5,4504199.5,4457001,4458615,4402401.5,4520666,4464787,4511463.5,4546254,4692565,4615345,4683343.5,4567922,4804679,4720817.5,4835832.5,4840642.5,5029028,4959002,5010131,4936399.5,5127368,5066709,5120551,4975730.5,5249626,5123968,5092737,4634315,4706891,4823052.5,4990924.5,4842967.5,5045140.5,5050199.5,5169143.5,5022838,5170733.5,5237545.5,5368843.5,5270945,5380528,5369752,5517801.5,5256450.5,5473377,5425704,5567030,5386945.5,5580039,5564547,5734911.5,5542388.5,5710754.5,5752936.5,5862074.5,5634258,5839989,5803635.5,5995608.5,5826517.5,5927581.5,5872816.5,6082192,5892097,6098932.5,6034322,6151319,5947650.5,6038705,6006225,6089150.5,5862506,4813221.5,5518064,5876143],"text":["date: 1997 Q1<br />.val:  3702397.7500","date: 1997 Q2<br />.val:  3896084.0000","date: 1997 Q3<br />.val:  3906063.0000","date: 1997 Q4<br />.val:  4038358.5000","date: 1998 Q1<br />.val:  4084303.5000","date: 1998 Q2<br />.val:  4134899.5000","date: 1998 Q3<br />.val:  4138199.7500","date: 1998 Q4<br />.val:  4146841.5000","date: 1999 Q1<br />.val:  4176243.2500","date: 1999 Q2<br />.val:  4232279.5000","date: 1999 Q3<br />.val:  4262620.5000","date: 1999 Q4<br />.val:  4287797.5000","date: 2000 Q1<br />.val:  4412426.5000","date: 2000 Q2<br />.val:  4465504.0000","date: 2000 Q3<br />.val:  4505221.0000","date: 2000 Q4<br />.val:  4428703.0000","date: 2001 Q1<br />.val:  4441058.0000","date: 2001 Q2<br />.val:  4468505.0000","date: 2001 Q3<br />.val:  4440265.0000","date: 2001 Q4<br />.val:  4381722.5000","date: 2002 Q1<br />.val:  4269784.5000","date: 2002 Q2<br />.val:  4504199.5000","date: 2002 Q3<br />.val:  4457001.0000","date: 2002 Q4<br />.val:  4458615.0000","date: 2003 Q1<br />.val:  4402401.5000","date: 2003 Q2<br />.val:  4520666.0000","date: 2003 Q3<br />.val:  4464787.0000","date: 2003 Q4<br />.val:  4511463.5000","date: 2004 Q1<br />.val:  4546254.0000","date: 2004 Q2<br />.val:  4692565.0000","date: 2004 Q3<br />.val:  4615345.0000","date: 2004 Q4<br />.val:  4683343.5000","date: 2005 Q1<br />.val:  4567922.0000","date: 2005 Q2<br />.val:  4804679.0000","date: 2005 Q3<br />.val:  4720817.5000","date: 2005 Q4<br />.val:  4835832.5000","date: 2006 Q1<br />.val:  4840642.5000","date: 2006 Q2<br />.val:  5029028.0000","date: 2006 Q3<br />.val:  4959002.0000","date: 2006 Q4<br />.val:  5010131.0000","date: 2007 Q1<br />.val:  4936399.5000","date: 2007 Q2<br />.val:  5127368.0000","date: 2007 Q3<br />.val:  5066709.0000","date: 2007 Q4<br />.val:  5120551.0000","date: 2008 Q1<br />.val:  4975730.5000","date: 2008 Q2<br />.val:  5249626.0000","date: 2008 Q3<br />.val:  5123968.0000","date: 2008 Q4<br />.val:  5092737.0000","date: 2009 Q1<br />.val:  4634315.0000","date: 2009 Q2<br />.val:  4706891.0000","date: 2009 Q3<br />.val:  4823052.5000","date: 2009 Q4<br />.val:  4990924.5000","date: 2010 Q1<br />.val:  4842967.5000","date: 2010 Q2<br />.val:  5045140.5000","date: 2010 Q3<br />.val:  5050199.5000","date: 2010 Q4<br />.val:  5169143.5000","date: 2011 Q1<br />.val:  5022838.0000","date: 2011 Q2<br />.val:  5170733.5000","date: 2011 Q3<br />.val:  5237545.5000","date: 2011 Q4<br />.val:  5368843.5000","date: 2012 Q1<br />.val:  5270945.0000","date: 2012 Q2<br />.val:  5380528.0000","date: 2012 Q3<br />.val:  5369752.0000","date: 2012 Q4<br />.val:  5517801.5000","date: 2013 Q1<br />.val:  5256450.5000","date: 2013 Q2<br />.val:  5473377.0000","date: 2013 Q3<br />.val:  5425704.0000","date: 2013 Q4<br />.val:  5567030.0000","date: 2014 Q1<br />.val:  5386945.5000","date: 2014 Q2<br />.val:  5580039.0000","date: 2014 Q3<br />.val:  5564547.0000","date: 2014 Q4<br />.val:  5734911.5000","date: 2015 Q1<br />.val:  5542388.5000","date: 2015 Q2<br />.val:  5710754.5000","date: 2015 Q3<br />.val:  5752936.5000","date: 2015 Q4<br />.val:  5862074.5000","date: 2016 Q1<br />.val:  5634258.0000","date: 2016 Q2<br />.val:  5839989.0000","date: 2016 Q3<br />.val:  5803635.5000","date: 2016 Q4<br />.val:  5995608.5000","date: 2017 Q1<br />.val:  5826517.5000","date: 2017 Q2<br />.val:  5927581.5000","date: 2017 Q3<br />.val:  5872816.5000","date: 2017 Q4<br />.val:  6082192.0000","date: 2018 Q1<br />.val:  5892097.0000","date: 2018 Q2<br />.val:  6098932.5000","date: 2018 Q3<br />.val:  6034322.0000","date: 2018 Q4<br />.val:  6151319.0000","date: 2019 Q1<br />.val:  5947650.5000","date: 2019 Q2<br />.val:  6038705.0000","date: 2019 Q3<br />.val:  6006225.0000","date: 2019 Q4<br />.val:  6089150.5000","date: 2020 Q1<br />.val:  5862506.0000","date: 2020 Q2<br />.val:  4813221.5000","date: 2020 Q3<br />.val:  5518064.0000","date: 2020 Q4<br />.val:  5876143.0000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[3748623.1008546865,3826602.5145186144,3899775.1332595171,3965504.915663017,4024418.5056491168,4086180.0870475047,4129404.6224186369,4166886.7636462469,4197286.0481398311,4230877.5551285828,4264447.6926571485,4309663.1231657891,4359847.0434448579,4395601.3869875763,4429132.6882809857,4442630.4893182544,4445716.8120874707,4438415.3201205693,4423234.7514351718,4425995.5460828012,4433164.8010216318,4444157.3832774246,4458792.9279866973,4458540.4046117635,4459684.1328225844,4466391.3744181171,4490910.6338524781,4532061.2185874516,4574112.0077136336,4613410.6953427326,4645615.7830205616,4673758.5580829978,4701389.603712853,4732030.8363123117,4770923.7137451926,4829675.5384172359,4889126.1827772176,4938884.1312891366,4971749.8456920423,4995632.0244334405,5021485.2845055209,5048637.9293507896,5067626.2075625127,5074642.6193300914,5066006.4631911144,5057696.0673784222,5048416.1499483008,5040525.9322426505,4970670.0327092065,4919514.3678680398,4837972.3280952359,4899438.9350811699,4954410.8196546184,5003489.870420428,5048584.9549154602,5091737.7166929469,5134369.4449366871,5182501.8895994006,5230418.4370135646,5275159.6333433539,5311894.4751230786,5346241.9138993695,5377199.3542857897,5395959.8635886321,5414340.6232180828,5427055.9268739419,5447042.8703178028,5474673.907686403,5507404.9247813653,5546182.5714752534,5585652.7373295687,5622203.2156608878,5655828.1811783491,5687865.7234644303,5714615.0399273345,5742205.8948596716,5771427.1518122396,5801582.0495972941,5839889.7410261668,5868795.2498924322,5887735.3532282431,5907015.4818013813,5928865.2205480626,5966368.3297310984,6007161.4922373109,6033417.2612528931,6048998.5163625665,6049870.980917831,6038998.1788141485,6027656.6858375734,6009320.8780758819,5992196.0401121583,5972034.2758534355,5956078.778734237,5942611.7856467087,5930178.1993120126],"text":["date: 1997 Q1<br />.val:  3748623.1009","date: 1997 Q2<br />.val:  3826602.5145","date: 1997 Q3<br />.val:  3899775.1333","date: 1997 Q4<br />.val:  3965504.9157","date: 1998 Q1<br />.val:  4024418.5056","date: 1998 Q2<br />.val:  4086180.0870","date: 1998 Q3<br />.val:  4129404.6224","date: 1998 Q4<br />.val:  4166886.7636","date: 1999 Q1<br />.val:  4197286.0481","date: 1999 Q2<br />.val:  4230877.5551","date: 1999 Q3<br />.val:  4264447.6927","date: 1999 Q4<br />.val:  4309663.1232","date: 2000 Q1<br />.val:  4359847.0434","date: 2000 Q2<br />.val:  4395601.3870","date: 2000 Q3<br />.val:  4429132.6883","date: 2000 Q4<br />.val:  4442630.4893","date: 2001 Q1<br />.val:  4445716.8121","date: 2001 Q2<br />.val:  4438415.3201","date: 2001 Q3<br />.val:  4423234.7514","date: 2001 Q4<br />.val:  4425995.5461","date: 2002 Q1<br />.val:  4433164.8010","date: 2002 Q2<br />.val:  4444157.3833","date: 2002 Q3<br />.val:  4458792.9280","date: 2002 Q4<br />.val:  4458540.4046","date: 2003 Q1<br />.val:  4459684.1328","date: 2003 Q2<br />.val:  4466391.3744","date: 2003 Q3<br />.val:  4490910.6339","date: 2003 Q4<br />.val:  4532061.2186","date: 2004 Q1<br />.val:  4574112.0077","date: 2004 Q2<br />.val:  4613410.6953","date: 2004 Q3<br />.val:  4645615.7830","date: 2004 Q4<br />.val:  4673758.5581","date: 2005 Q1<br />.val:  4701389.6037","date: 2005 Q2<br />.val:  4732030.8363","date: 2005 Q3<br />.val:  4770923.7137","date: 2005 Q4<br />.val:  4829675.5384","date: 2006 Q1<br />.val:  4889126.1828","date: 2006 Q2<br />.val:  4938884.1313","date: 2006 Q3<br />.val:  4971749.8457","date: 2006 Q4<br />.val:  4995632.0244","date: 2007 Q1<br />.val:  5021485.2845","date: 2007 Q2<br />.val:  5048637.9294","date: 2007 Q3<br />.val:  5067626.2076","date: 2007 Q4<br />.val:  5074642.6193","date: 2008 Q1<br />.val:  5066006.4632","date: 2008 Q2<br />.val:  5057696.0674","date: 2008 Q3<br />.val:  5048416.1499","date: 2008 Q4<br />.val:  5040525.9322","date: 2009 Q1<br />.val:  4970670.0327","date: 2009 Q2<br />.val:  4919514.3679","date: 2009 Q3<br />.val:  4837972.3281","date: 2009 Q4<br />.val:  4899438.9351","date: 2010 Q1<br />.val:  4954410.8197","date: 2010 Q2<br />.val:  5003489.8704","date: 2010 Q3<br />.val:  5048584.9549","date: 2010 Q4<br />.val:  5091737.7167","date: 2011 Q1<br />.val:  5134369.4449","date: 2011 Q2<br />.val:  5182501.8896","date: 2011 Q3<br />.val:  5230418.4370","date: 2011 Q4<br />.val:  5275159.6333","date: 2012 Q1<br />.val:  5311894.4751","date: 2012 Q2<br />.val:  5346241.9139","date: 2012 Q3<br />.val:  5377199.3543","date: 2012 Q4<br />.val:  5395959.8636","date: 2013 Q1<br />.val:  5414340.6232","date: 2013 Q2<br />.val:  5427055.9269","date: 2013 Q3<br />.val:  5447042.8703","date: 2013 Q4<br />.val:  5474673.9077","date: 2014 Q1<br />.val:  5507404.9248","date: 2014 Q2<br />.val:  5546182.5715","date: 2014 Q3<br />.val:  5585652.7373","date: 2014 Q4<br />.val:  5622203.2157","date: 2015 Q1<br />.val:  5655828.1812","date: 2015 Q2<br />.val:  5687865.7235","date: 2015 Q3<br />.val:  5714615.0399","date: 2015 Q4<br />.val:  5742205.8949","date: 2016 Q1<br />.val:  5771427.1518","date: 2016 Q2<br />.val:  5801582.0496","date: 2016 Q3<br />.val:  5839889.7410","date: 2016 Q4<br />.val:  5868795.2499","date: 2017 Q1<br />.val:  5887735.3532","date: 2017 Q2<br />.val:  5907015.4818","date: 2017 Q3<br />.val:  5928865.2205","date: 2017 Q4<br />.val:  5966368.3297","date: 2018 Q1<br />.val:  6007161.4922","date: 2018 Q2<br />.val:  6033417.2613","date: 2018 Q3<br />.val:  6048998.5164","date: 2018 Q4<br />.val:  6049870.9809","date: 2019 Q1<br />.val:  6038998.1788","date: 2019 Q2<br />.val:  6027656.6858","date: 2019 Q3<br />.val:  6009320.8781","date: 2019 Q4<br />.val:  5992196.0401","date: 2020 Q1<br />.val:  5972034.2759","date: 2020 Q2<br />.val:  5956078.7787","date: 2020 Q3<br />.val:  5942611.7856","date: 2020 Q4<br />.val:  5930178.1993"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[-31287.756013892969,52599.826609157157,-2601.6238737033,-18633.290074316326,-31370.742011487007,52978.559040050051,-3464.3919643782556,-18052.650886094794,-31472.611840115627,53316.528430530212,-4382.9183950265178,-17519.408782003931,-31019.173954960224,53864.349487181273,-6551.4278671293014,-16390.128189564904,-30427.547325059666,54634.85413615148,-8391.1422386939739,-14878.807503476943,-33535.670328038832,58802.545177315566,-13069.41245569575,-10264.746551261105,-36827.807551309787,63127.415548451805,-17183.889063903094,-4898.6814077389745,-46898.856812989201,68153.350499326159,-18932.914273327431,4561.9708807856914,-58173.900509982646,72286.888341210986,-21207.950008984069,13687.079659440054,-68027.034008962757,71584.649609931905,-20181.607455567369,25138.679682476784,-78669.103896340806,70592.968058100305,-18749.248924867523,37678.467960286842,-88466.085359593562,60551.890478593908,-13318.585754105959,52211.067757349389,-98137.087633582574,50425.171562024807,-7905.7336423213437,67032.181492302974,-107057.41619822859,42951.240525770299,-7302.0121604375527,80226.132693836364,-114920.92828610519,35695.95597688781,-7458.6680289394044,91860.13491530357,-119011.41758273472,34108.746189352823,-10150.349667181474,99082.575365247001,-122926.26042960184,32645.361268365683,-13026.365561741473,105887.93947722987,-123385.20836765799,32706.050690289634,-18278.743797530391,109506.02638094198,-123071.33517321399,33129.039254263138,-23755.753830969636,112353.16394763144,-119936.76584288677,31429.63231706735,-23648.685020956051,110688.74143226338,-116865.11650917168,29973.545221911405,-23114.648840389113,109531.35521472098,-116053.28908235604,29593.49317932739,-23202.678099562512,109306.56340269871,-115246.1755973446,29179.198002615682,-23310.305098860321,109083.95475152311,-114671.26947615648,28885.100139310991,-23263.530171279504,108782.38292293301],"text":["date: 1997 Q1<br />.val:   -31287.7560","date: 1997 Q2<br />.val:    52599.8266","date: 1997 Q3<br />.val:    -2601.6239","date: 1997 Q4<br />.val:   -18633.2901","date: 1998 Q1<br />.val:   -31370.7420","date: 1998 Q2<br />.val:    52978.5590","date: 1998 Q3<br />.val:    -3464.3920","date: 1998 Q4<br />.val:   -18052.6509","date: 1999 Q1<br />.val:   -31472.6118","date: 1999 Q2<br />.val:    53316.5284","date: 1999 Q3<br />.val:    -4382.9184","date: 1999 Q4<br />.val:   -17519.4088","date: 2000 Q1<br />.val:   -31019.1740","date: 2000 Q2<br />.val:    53864.3495","date: 2000 Q3<br />.val:    -6551.4279","date: 2000 Q4<br />.val:   -16390.1282","date: 2001 Q1<br />.val:   -30427.5473","date: 2001 Q2<br />.val:    54634.8541","date: 2001 Q3<br />.val:    -8391.1422","date: 2001 Q4<br />.val:   -14878.8075","date: 2002 Q1<br />.val:   -33535.6703","date: 2002 Q2<br />.val:    58802.5452","date: 2002 Q3<br />.val:   -13069.4125","date: 2002 Q4<br />.val:   -10264.7466","date: 2003 Q1<br />.val:   -36827.8076","date: 2003 Q2<br />.val:    63127.4155","date: 2003 Q3<br />.val:   -17183.8891","date: 2003 Q4<br />.val:    -4898.6814","date: 2004 Q1<br />.val:   -46898.8568","date: 2004 Q2<br />.val:    68153.3505","date: 2004 Q3<br />.val:   -18932.9143","date: 2004 Q4<br />.val:     4561.9709","date: 2005 Q1<br />.val:   -58173.9005","date: 2005 Q2<br />.val:    72286.8883","date: 2005 Q3<br />.val:   -21207.9500","date: 2005 Q4<br />.val:    13687.0797","date: 2006 Q1<br />.val:   -68027.0340","date: 2006 Q2<br />.val:    71584.6496","date: 2006 Q3<br />.val:   -20181.6075","date: 2006 Q4<br />.val:    25138.6797","date: 2007 Q1<br />.val:   -78669.1039","date: 2007 Q2<br />.val:    70592.9681","date: 2007 Q3<br />.val:   -18749.2489","date: 2007 Q4<br />.val:    37678.4680","date: 2008 Q1<br />.val:   -88466.0854","date: 2008 Q2<br />.val:    60551.8905","date: 2008 Q3<br />.val:   -13318.5858","date: 2008 Q4<br />.val:    52211.0678","date: 2009 Q1<br />.val:   -98137.0876","date: 2009 Q2<br />.val:    50425.1716","date: 2009 Q3<br />.val:    -7905.7336","date: 2009 Q4<br />.val:    67032.1815","date: 2010 Q1<br />.val:  -107057.4162","date: 2010 Q2<br />.val:    42951.2405","date: 2010 Q3<br />.val:    -7302.0122","date: 2010 Q4<br />.val:    80226.1327","date: 2011 Q1<br />.val:  -114920.9283","date: 2011 Q2<br />.val:    35695.9560","date: 2011 Q3<br />.val:    -7458.6680","date: 2011 Q4<br />.val:    91860.1349","date: 2012 Q1<br />.val:  -119011.4176","date: 2012 Q2<br />.val:    34108.7462","date: 2012 Q3<br />.val:   -10150.3497","date: 2012 Q4<br />.val:    99082.5754","date: 2013 Q1<br />.val:  -122926.2604","date: 2013 Q2<br />.val:    32645.3613","date: 2013 Q3<br />.val:   -13026.3656","date: 2013 Q4<br />.val:   105887.9395","date: 2014 Q1<br />.val:  -123385.2084","date: 2014 Q2<br />.val:    32706.0507","date: 2014 Q3<br />.val:   -18278.7438","date: 2014 Q4<br />.val:   109506.0264","date: 2015 Q1<br />.val:  -123071.3352","date: 2015 Q2<br />.val:    33129.0393","date: 2015 Q3<br />.val:   -23755.7538","date: 2015 Q4<br />.val:   112353.1639","date: 2016 Q1<br />.val:  -119936.7658","date: 2016 Q2<br />.val:    31429.6323","date: 2016 Q3<br />.val:   -23648.6850","date: 2016 Q4<br />.val:   110688.7414","date: 2017 Q1<br />.val:  -116865.1165","date: 2017 Q2<br />.val:    29973.5452","date: 2017 Q3<br />.val:   -23114.6488","date: 2017 Q4<br />.val:   109531.3552","date: 2018 Q1<br />.val:  -116053.2891","date: 2018 Q2<br />.val:    29593.4932","date: 2018 Q3<br />.val:   -23202.6781","date: 2018 Q4<br />.val:   109306.5634","date: 2019 Q1<br />.val:  -115246.1756","date: 2019 Q2<br />.val:    29179.1980","date: 2019 Q3<br />.val:   -23310.3051","date: 2019 Q4<br />.val:   109083.9548","date: 2020 Q1<br />.val:  -114671.2695","date: 2020 Q2<br />.val:    28885.1001","date: 2020 Q3<br />.val:   -23263.5302","date: 2020 Q4<br />.val:   108782.3829"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[-14937.594840793405,16881.658872228581,8889.4906141860411,91486.874411299359,91255.736362370197,-4259.1460875547491,12259.519545741379,-1992.6127601522021,10429.813700284809,-51914.583559113089,2555.7257378781214,-4346.2143837846816,83598.630510102026,16038.263525242917,82639.739586143754,2462.6388713102788,25768.735237589106,-24545.17425672058,25421.39080352243,-29394.238579324447,-129844.63069359306,1239.5715452600271,11277.484468998387,10339.341939497739,-20454.825271274894,-8852.7899665692821,-8939.7447885749862,-15699.037179712206,19040.84909935575,11000.954157941043,-11337.868747234344,5022.9710362162441,-75293.703202870674,361.275346477516,-28898.263736208901,-7530.1180766755715,19543.351231745444,18559.219100931659,7433.7617635251954,-10639.704115916975,-6416.680609180592,8137.1025911103934,17832.041362354532,8229.9127096217126,-1809.8778315205127,131378.04214298353,88870.435805805027,0,-238217.94507562369,-263048.53943006415,-7014.0944529147819,24453.383426527493,-4385.903456389904,-1300.6109461979941,8916.5572449769825,-2820.3493867833167,3389.4833494182676,-47464.345576288179,14585.731015374884,1823.7317413426936,78061.942459655926,177.33991127740592,2702.9953813916072,22759.061046120711,-34963.862788480707,13675.711857692339,-8312.5047560613602,-13531.847163632512,2925.7835862925276,1150.3778344569728,-2826.9935320382938,3202.2579581700265,9631.6539948647842,-10240.262718693353,62077.213903634809,7515.4411926968023,-17232.385969352908,6977.3180856388062,-12605.556005210616,16124.508675304241,55647.263280929066,-9407.5270232930779,-32934.071707673371,6292.3150541810319,988.79684504494071,35921.745567779057,8526.1617369959131,-7858.5443205293268,23898.496783195995,-18130.883840189315,20214.427022978663,-12129.494863681495,5142.9936227211729,-1171742.3788735475,-401284.25547542889,-162817.58223494608],"text":["date: 1997 Q1<br />.val:   -14937.5948","date: 1997 Q2<br />.val:    16881.6589","date: 1997 Q3<br />.val:     8889.4906","date: 1997 Q4<br />.val:    91486.8744","date: 1998 Q1<br />.val:    91255.7364","date: 1998 Q2<br />.val:    -4259.1461","date: 1998 Q3<br />.val:    12259.5195","date: 1998 Q4<br />.val:    -1992.6128","date: 1999 Q1<br />.val:    10429.8137","date: 1999 Q2<br />.val:   -51914.5836","date: 1999 Q3<br />.val:     2555.7257","date: 1999 Q4<br />.val:    -4346.2144","date: 2000 Q1<br />.val:    83598.6305","date: 2000 Q2<br />.val:    16038.2635","date: 2000 Q3<br />.val:    82639.7396","date: 2000 Q4<br />.val:     2462.6389","date: 2001 Q1<br />.val:    25768.7352","date: 2001 Q2<br />.val:   -24545.1743","date: 2001 Q3<br />.val:    25421.3908","date: 2001 Q4<br />.val:   -29394.2386","date: 2002 Q1<br />.val:  -129844.6307","date: 2002 Q2<br />.val:     1239.5715","date: 2002 Q3<br />.val:    11277.4845","date: 2002 Q4<br />.val:    10339.3419","date: 2003 Q1<br />.val:   -20454.8253","date: 2003 Q2<br />.val:    -8852.7900","date: 2003 Q3<br />.val:    -8939.7448","date: 2003 Q4<br />.val:   -15699.0372","date: 2004 Q1<br />.val:    19040.8491","date: 2004 Q2<br />.val:    11000.9542","date: 2004 Q3<br />.val:   -11337.8687","date: 2004 Q4<br />.val:     5022.9710","date: 2005 Q1<br />.val:   -75293.7032","date: 2005 Q2<br />.val:      361.2753","date: 2005 Q3<br />.val:   -28898.2637","date: 2005 Q4<br />.val:    -7530.1181","date: 2006 Q1<br />.val:    19543.3512","date: 2006 Q2<br />.val:    18559.2191","date: 2006 Q3<br />.val:     7433.7618","date: 2006 Q4<br />.val:   -10639.7041","date: 2007 Q1<br />.val:    -6416.6806","date: 2007 Q2<br />.val:     8137.1026","date: 2007 Q3<br />.val:    17832.0414","date: 2007 Q4<br />.val:     8229.9127","date: 2008 Q1<br />.val:    -1809.8778","date: 2008 Q2<br />.val:   131378.0421","date: 2008 Q3<br />.val:    88870.4358","date: 2008 Q4<br />.val:        0.0000","date: 2009 Q1<br />.val:  -238217.9451","date: 2009 Q2<br />.val:  -263048.5394","date: 2009 Q3<br />.val:    -7014.0945","date: 2009 Q4<br />.val:    24453.3834","date: 2010 Q1<br />.val:    -4385.9035","date: 2010 Q2<br />.val:    -1300.6109","date: 2010 Q3<br />.val:     8916.5572","date: 2010 Q4<br />.val:    -2820.3494","date: 2011 Q1<br />.val:     3389.4833","date: 2011 Q2<br />.val:   -47464.3456","date: 2011 Q3<br />.val:    14585.7310","date: 2011 Q4<br />.val:     1823.7317","date: 2012 Q1<br />.val:    78061.9425","date: 2012 Q2<br />.val:      177.3399","date: 2012 Q3<br />.val:     2702.9954","date: 2012 Q4<br />.val:    22759.0610","date: 2013 Q1<br />.val:   -34963.8628","date: 2013 Q2<br />.val:    13675.7119","date: 2013 Q3<br />.val:    -8312.5048","date: 2013 Q4<br />.val:   -13531.8472","date: 2014 Q1<br />.val:     2925.7836","date: 2014 Q2<br />.val:     1150.3778","date: 2014 Q3<br />.val:    -2826.9935","date: 2014 Q4<br />.val:     3202.2580","date: 2015 Q1<br />.val:     9631.6540","date: 2015 Q2<br />.val:   -10240.2627","date: 2015 Q3<br />.val:    62077.2139","date: 2015 Q4<br />.val:     7515.4412","date: 2016 Q1<br />.val:   -17232.3860","date: 2016 Q2<br />.val:     6977.3181","date: 2016 Q3<br />.val:   -12605.5560","date: 2016 Q4<br />.val:    16124.5087","date: 2017 Q1<br />.val:    55647.2633","date: 2017 Q2<br />.val:    -9407.5270","date: 2017 Q3<br />.val:   -32934.0717","date: 2017 Q4<br />.val:     6292.3151","date: 2018 Q1<br />.val:      988.7968","date: 2018 Q2<br />.val:    35921.7456","date: 2018 Q3<br />.val:     8526.1617","date: 2018 Q4<br />.val:    -7858.5443","date: 2019 Q1<br />.val:    23898.4968","date: 2019 Q2<br />.val:   -18130.8838","date: 2019 Q3<br />.val:    20214.4270","date: 2019 Q4<br />.val:   -12129.4949","date: 2020 Q1<br />.val:     5142.9936","date: 2020 Q2<br />.val: -1171742.3789","date: 2020 Q3<br />.val:  -401284.2555","date: 2020 Q4<br />.val:  -162817.5822"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[4808989.1888423553,5044727.5611576447,5044727.5611576447,4808989.1888423553,4808989.1888423553],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[4781377.854728614,5017116.2270439034,5017116.2270439034,4781377.854728614,4781377.854728614],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[-123385.20836765799,112353.16394763146,112353.16394763146,-123385.20836765799,-123385.20836765799],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[-638051.35452292673,-402312.98220763728,-402312.98220763728,-638051.35452292673,-638051.35452292673],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":18.99543378995434,"b":40.182648401826491,"l":51.872146118721474},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9235.1000000000004,18978.900000000001],"tickmode":"array","ticktext":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"tickvals":[10957,12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"price","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.6875,6273765.0625],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[3633560.7068515294,6164933.3749209885],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-135172.12698342247,124140.08256339593],"tickmode":"array","ticktext":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"tickvals":[-100000,-50000,0,50000,100000],"categoryorder":"array","categoryarray":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-1236898.3999243742,196534.06319381009],"tickmode":"array","ticktext":["-1000000","-750000","-500000","-250000","0"],"tickvals":[-1000000,-750000,-500000,-250000,0],"categoryorder":"array","categoryarray":["-1000000","-750000","-500000","-250000","0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"18312ce6531d":{"x":{},"y":{},"type":"scatter"},"18312463efeb":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"18312ce6531d","visdat":{"18312ce6531d":["function (y) ","x"],"18312463efeb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>The STL decomposition shows that the variance of the seasonal component has been increasing. We could try using a <strong>log transformation</strong> to counter this.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">autoplot</span>(<span class="fu">log</span>(price)) <span class="sc">+</span></span>
<span id="cb8-3"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Log of the Real GDP of Mexico"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-8-1.png" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a></a>  <span class="fu">autoplot</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a></a>  <span class="fu">ggplotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-392cd753540bdb7f4138" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-392cd753540bdb7f4138">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[15.124491208267395,15.175482504087086,15.178040519320948,15.211348855489106,15.222661769903164,15.234973581428724,15.235771408234696,15.237857518097812,15.244922656369248,15.258251294762877,15.265394669969048,15.271283755804216,15.29993532286116,15.311892643862031,15.320747504425112,15.303617322630203,15.306403194310551,15.312564458746674,15.306224617312033,15.292952469884462,15.26707391554716,15.320520741781639,15.309986676294834,15.31034873765271,15.29766074545087,15.32416988608693,15.311732066787545,15.322132159948412,15.329814155128975,15.36148989923818,15.344897179354668,15.359522835892069,15.334568954865718,15.385100792743918,15.36749254171704,15.391563854054116,15.392558017816471,15.4307372828459,15.416715068778307,15.426972620423793,15.412146777272772,15.450103025057565,15.438202052376647,15.448772608412876,15.420082751966603,15.473667393935015,15.449439696858262,15.443325965028173,15.348998957495022,15.36453816311494,15.388917584332939,15.423131721108316,15.393038210646351,15.433936060737858,15.434938305421738,15.458217565448855,15.429505670569641,15.458525112630031,15.471363530525631,15.496123080162587,15.477720221330239,15.498297068586369,15.496292282923259,15.52349005993363,15.474966547041289,15.51540635136414,15.506658218556707,15.532372256049992,15.499489084663285,15.53470632358038,15.531926137761241,15.562082876865947,15.527936102994651,15.557861709505373,15.565220978065064,15.584014109145263,15.544376019767201,15.580239471240992,15.573995089497922,15.60653784254389,15.577930038509352,15.595126846299971,15.585844889337492,15.620875715284143,15.589122519429823,15.623624313829254,15.612974061546463,15.632177088331682,15.598506825588984,15.61370014294967,15.608306989361171,15.622019138987508,15.584087715190305,15.386877168418907,15.523537632097327,15.586411152262968],"text":["date: 1997 Q1<br />.val:  1.512449e+01","date: 1997 Q2<br />.val:  1.517548e+01","date: 1997 Q3<br />.val:  1.517804e+01","date: 1997 Q4<br />.val:  1.521135e+01","date: 1998 Q1<br />.val:  1.522266e+01","date: 1998 Q2<br />.val:  1.523497e+01","date: 1998 Q3<br />.val:  1.523577e+01","date: 1998 Q4<br />.val:  1.523786e+01","date: 1999 Q1<br />.val:  1.524492e+01","date: 1999 Q2<br />.val:  1.525825e+01","date: 1999 Q3<br />.val:  1.526539e+01","date: 1999 Q4<br />.val:  1.527128e+01","date: 2000 Q1<br />.val:  1.529994e+01","date: 2000 Q2<br />.val:  1.531189e+01","date: 2000 Q3<br />.val:  1.532075e+01","date: 2000 Q4<br />.val:  1.530362e+01","date: 2001 Q1<br />.val:  1.530640e+01","date: 2001 Q2<br />.val:  1.531256e+01","date: 2001 Q3<br />.val:  1.530622e+01","date: 2001 Q4<br />.val:  1.529295e+01","date: 2002 Q1<br />.val:  1.526707e+01","date: 2002 Q2<br />.val:  1.532052e+01","date: 2002 Q3<br />.val:  1.530999e+01","date: 2002 Q4<br />.val:  1.531035e+01","date: 2003 Q1<br />.val:  1.529766e+01","date: 2003 Q2<br />.val:  1.532417e+01","date: 2003 Q3<br />.val:  1.531173e+01","date: 2003 Q4<br />.val:  1.532213e+01","date: 2004 Q1<br />.val:  1.532981e+01","date: 2004 Q2<br />.val:  1.536149e+01","date: 2004 Q3<br />.val:  1.534490e+01","date: 2004 Q4<br />.val:  1.535952e+01","date: 2005 Q1<br />.val:  1.533457e+01","date: 2005 Q2<br />.val:  1.538510e+01","date: 2005 Q3<br />.val:  1.536749e+01","date: 2005 Q4<br />.val:  1.539156e+01","date: 2006 Q1<br />.val:  1.539256e+01","date: 2006 Q2<br />.val:  1.543074e+01","date: 2006 Q3<br />.val:  1.541672e+01","date: 2006 Q4<br />.val:  1.542697e+01","date: 2007 Q1<br />.val:  1.541215e+01","date: 2007 Q2<br />.val:  1.545010e+01","date: 2007 Q3<br />.val:  1.543820e+01","date: 2007 Q4<br />.val:  1.544877e+01","date: 2008 Q1<br />.val:  1.542008e+01","date: 2008 Q2<br />.val:  1.547367e+01","date: 2008 Q3<br />.val:  1.544944e+01","date: 2008 Q4<br />.val:  1.544333e+01","date: 2009 Q1<br />.val:  1.534900e+01","date: 2009 Q2<br />.val:  1.536454e+01","date: 2009 Q3<br />.val:  1.538892e+01","date: 2009 Q4<br />.val:  1.542313e+01","date: 2010 Q1<br />.val:  1.539304e+01","date: 2010 Q2<br />.val:  1.543394e+01","date: 2010 Q3<br />.val:  1.543494e+01","date: 2010 Q4<br />.val:  1.545822e+01","date: 2011 Q1<br />.val:  1.542951e+01","date: 2011 Q2<br />.val:  1.545853e+01","date: 2011 Q3<br />.val:  1.547136e+01","date: 2011 Q4<br />.val:  1.549612e+01","date: 2012 Q1<br />.val:  1.547772e+01","date: 2012 Q2<br />.val:  1.549830e+01","date: 2012 Q3<br />.val:  1.549629e+01","date: 2012 Q4<br />.val:  1.552349e+01","date: 2013 Q1<br />.val:  1.547497e+01","date: 2013 Q2<br />.val:  1.551541e+01","date: 2013 Q3<br />.val:  1.550666e+01","date: 2013 Q4<br />.val:  1.553237e+01","date: 2014 Q1<br />.val:  1.549949e+01","date: 2014 Q2<br />.val:  1.553471e+01","date: 2014 Q3<br />.val:  1.553193e+01","date: 2014 Q4<br />.val:  1.556208e+01","date: 2015 Q1<br />.val:  1.552794e+01","date: 2015 Q2<br />.val:  1.555786e+01","date: 2015 Q3<br />.val:  1.556522e+01","date: 2015 Q4<br />.val:  1.558401e+01","date: 2016 Q1<br />.val:  1.554438e+01","date: 2016 Q2<br />.val:  1.558024e+01","date: 2016 Q3<br />.val:  1.557400e+01","date: 2016 Q4<br />.val:  1.560654e+01","date: 2017 Q1<br />.val:  1.557793e+01","date: 2017 Q2<br />.val:  1.559513e+01","date: 2017 Q3<br />.val:  1.558584e+01","date: 2017 Q4<br />.val:  1.562088e+01","date: 2018 Q1<br />.val:  1.558912e+01","date: 2018 Q2<br />.val:  1.562362e+01","date: 2018 Q3<br />.val:  1.561297e+01","date: 2018 Q4<br />.val:  1.563218e+01","date: 2019 Q1<br />.val:  1.559851e+01","date: 2019 Q2<br />.val:  1.561370e+01","date: 2019 Q3<br />.val:  1.560831e+01","date: 2019 Q4<br />.val:  1.562202e+01","date: 2020 Q1<br />.val:  1.558409e+01","date: 2020 Q2<br />.val:  1.538688e+01","date: 2020 Q3<br />.val:  1.552354e+01","date: 2020 Q4<br />.val:  1.558641e+01"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[15.143184551447096,15.162768184984111,15.182180508959712,15.200604217942514,15.214872884164929,15.226621244194551,15.23364588568332,15.240980565091091,15.247617214616122,15.255749078820749,15.261347244622007,15.273258489285793,15.287130289149955,15.300544470205734,15.308919219579048,15.310871252075788,15.309354482727871,15.306953711288418,15.299529968577017,15.295202698909318,15.29667759867943,15.300846696356247,15.306692466288892,15.309841109807527,15.31095987447029,15.313047951644796,15.317459243989081,15.32661189884324,15.336404426533207,15.345516122886046,15.349438382507612,15.352169626123343,15.358493456508807,15.36571463261321,15.376260886995075,15.388979438127937,15.402250620312563,15.413151175054876,15.419138286529892,15.42343186473034,15.4291660545735,15.435071494587193,15.438637835539229,15.440721779519627,15.444872302797737,15.446099311775772,15.445578397319647,15.434260223162978,15.419868860589343,15.409706330486603,15.393685544690026,15.404857363462643,15.41526923925424,15.425219315041062,15.434995568514777,15.44269545591942,15.449600290575161,15.458625204563024,15.470180868708123,15.481902765488691,15.48934555218008,15.494805442785204,15.498440004613254,15.500474100558941,15.503354309291485,15.505424369343375,15.510744425608566,15.516011260945994,15.521265886920871,15.527507884038698,15.535520832138205,15.542222020183203,15.548601864080076,15.555194677169343,15.561456954281267,15.566247204085942,15.569246139383983,15.572497934917926,15.580238964647574,15.586964173003215,15.590317315734987,15.592141124756887,15.595730435003379,15.601395279205658,15.608393097841279,15.612770105303182,15.615831051637588,15.616088267647442,15.613904025984649,15.611440407525134,15.609201176149094,15.607815789581398,15.586711346054695,15.558088499654026,15.529561833962461,15.499548627648137],"text":["date: 1997 Q1<br />.val:  1.514318e+01","date: 1997 Q2<br />.val:  1.516277e+01","date: 1997 Q3<br />.val:  1.518218e+01","date: 1997 Q4<br />.val:  1.520060e+01","date: 1998 Q1<br />.val:  1.521487e+01","date: 1998 Q2<br />.val:  1.522662e+01","date: 1998 Q3<br />.val:  1.523365e+01","date: 1998 Q4<br />.val:  1.524098e+01","date: 1999 Q1<br />.val:  1.524762e+01","date: 1999 Q2<br />.val:  1.525575e+01","date: 1999 Q3<br />.val:  1.526135e+01","date: 1999 Q4<br />.val:  1.527326e+01","date: 2000 Q1<br />.val:  1.528713e+01","date: 2000 Q2<br />.val:  1.530054e+01","date: 2000 Q3<br />.val:  1.530892e+01","date: 2000 Q4<br />.val:  1.531087e+01","date: 2001 Q1<br />.val:  1.530935e+01","date: 2001 Q2<br />.val:  1.530695e+01","date: 2001 Q3<br />.val:  1.529953e+01","date: 2001 Q4<br />.val:  1.529520e+01","date: 2002 Q1<br />.val:  1.529668e+01","date: 2002 Q2<br />.val:  1.530085e+01","date: 2002 Q3<br />.val:  1.530669e+01","date: 2002 Q4<br />.val:  1.530984e+01","date: 2003 Q1<br />.val:  1.531096e+01","date: 2003 Q2<br />.val:  1.531305e+01","date: 2003 Q3<br />.val:  1.531746e+01","date: 2003 Q4<br />.val:  1.532661e+01","date: 2004 Q1<br />.val:  1.533640e+01","date: 2004 Q2<br />.val:  1.534552e+01","date: 2004 Q3<br />.val:  1.534944e+01","date: 2004 Q4<br />.val:  1.535217e+01","date: 2005 Q1<br />.val:  1.535849e+01","date: 2005 Q2<br />.val:  1.536571e+01","date: 2005 Q3<br />.val:  1.537626e+01","date: 2005 Q4<br />.val:  1.538898e+01","date: 2006 Q1<br />.val:  1.540225e+01","date: 2006 Q2<br />.val:  1.541315e+01","date: 2006 Q3<br />.val:  1.541914e+01","date: 2006 Q4<br />.val:  1.542343e+01","date: 2007 Q1<br />.val:  1.542917e+01","date: 2007 Q2<br />.val:  1.543507e+01","date: 2007 Q3<br />.val:  1.543864e+01","date: 2007 Q4<br />.val:  1.544072e+01","date: 2008 Q1<br />.val:  1.544487e+01","date: 2008 Q2<br />.val:  1.544610e+01","date: 2008 Q3<br />.val:  1.544558e+01","date: 2008 Q4<br />.val:  1.543426e+01","date: 2009 Q1<br />.val:  1.541987e+01","date: 2009 Q2<br />.val:  1.540971e+01","date: 2009 Q3<br />.val:  1.539369e+01","date: 2009 Q4<br />.val:  1.540486e+01","date: 2010 Q1<br />.val:  1.541527e+01","date: 2010 Q2<br />.val:  1.542522e+01","date: 2010 Q3<br />.val:  1.543500e+01","date: 2010 Q4<br />.val:  1.544270e+01","date: 2011 Q1<br />.val:  1.544960e+01","date: 2011 Q2<br />.val:  1.545863e+01","date: 2011 Q3<br />.val:  1.547018e+01","date: 2011 Q4<br />.val:  1.548190e+01","date: 2012 Q1<br />.val:  1.548935e+01","date: 2012 Q2<br />.val:  1.549481e+01","date: 2012 Q3<br />.val:  1.549844e+01","date: 2012 Q4<br />.val:  1.550047e+01","date: 2013 Q1<br />.val:  1.550335e+01","date: 2013 Q2<br />.val:  1.550542e+01","date: 2013 Q3<br />.val:  1.551074e+01","date: 2013 Q4<br />.val:  1.551601e+01","date: 2014 Q1<br />.val:  1.552127e+01","date: 2014 Q2<br />.val:  1.552751e+01","date: 2014 Q3<br />.val:  1.553552e+01","date: 2014 Q4<br />.val:  1.554222e+01","date: 2015 Q1<br />.val:  1.554860e+01","date: 2015 Q2<br />.val:  1.555519e+01","date: 2015 Q3<br />.val:  1.556146e+01","date: 2015 Q4<br />.val:  1.556625e+01","date: 2016 Q1<br />.val:  1.556925e+01","date: 2016 Q2<br />.val:  1.557250e+01","date: 2016 Q3<br />.val:  1.558024e+01","date: 2016 Q4<br />.val:  1.558696e+01","date: 2017 Q1<br />.val:  1.559032e+01","date: 2017 Q2<br />.val:  1.559214e+01","date: 2017 Q3<br />.val:  1.559573e+01","date: 2017 Q4<br />.val:  1.560140e+01","date: 2018 Q1<br />.val:  1.560839e+01","date: 2018 Q2<br />.val:  1.561277e+01","date: 2018 Q3<br />.val:  1.561583e+01","date: 2018 Q4<br />.val:  1.561609e+01","date: 2019 Q1<br />.val:  1.561390e+01","date: 2019 Q2<br />.val:  1.561144e+01","date: 2019 Q3<br />.val:  1.560920e+01","date: 2019 Q4<br />.val:  1.560782e+01","date: 2020 Q1<br />.val:  1.558671e+01","date: 2020 Q2<br />.val:  1.555809e+01","date: 2020 Q3<br />.val:  1.552956e+01","date: 2020 Q4<br />.val:  1.549955e+01"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245,-0.016926226463230564,0.0092848069308166491,-0.0018024318078111736,0.0094438732447054245],"text":["date: 1997 Q1<br />.val: -1.692623e-02","date: 1997 Q2<br />.val:  9.284807e-03","date: 1997 Q3<br />.val: -1.802432e-03","date: 1997 Q4<br />.val:  9.443873e-03","date: 1998 Q1<br />.val: -1.692623e-02","date: 1998 Q2<br />.val:  9.284807e-03","date: 1998 Q3<br />.val: -1.802432e-03","date: 1998 Q4<br />.val:  9.443873e-03","date: 1999 Q1<br />.val: -1.692623e-02","date: 1999 Q2<br />.val:  9.284807e-03","date: 1999 Q3<br />.val: -1.802432e-03","date: 1999 Q4<br />.val:  9.443873e-03","date: 2000 Q1<br />.val: -1.692623e-02","date: 2000 Q2<br />.val:  9.284807e-03","date: 2000 Q3<br />.val: -1.802432e-03","date: 2000 Q4<br />.val:  9.443873e-03","date: 2001 Q1<br />.val: -1.692623e-02","date: 2001 Q2<br />.val:  9.284807e-03","date: 2001 Q3<br />.val: -1.802432e-03","date: 2001 Q4<br />.val:  9.443873e-03","date: 2002 Q1<br />.val: -1.692623e-02","date: 2002 Q2<br />.val:  9.284807e-03","date: 2002 Q3<br />.val: -1.802432e-03","date: 2002 Q4<br />.val:  9.443873e-03","date: 2003 Q1<br />.val: -1.692623e-02","date: 2003 Q2<br />.val:  9.284807e-03","date: 2003 Q3<br />.val: -1.802432e-03","date: 2003 Q4<br />.val:  9.443873e-03","date: 2004 Q1<br />.val: -1.692623e-02","date: 2004 Q2<br />.val:  9.284807e-03","date: 2004 Q3<br />.val: -1.802432e-03","date: 2004 Q4<br />.val:  9.443873e-03","date: 2005 Q1<br />.val: -1.692623e-02","date: 2005 Q2<br />.val:  9.284807e-03","date: 2005 Q3<br />.val: -1.802432e-03","date: 2005 Q4<br />.val:  9.443873e-03","date: 2006 Q1<br />.val: -1.692623e-02","date: 2006 Q2<br />.val:  9.284807e-03","date: 2006 Q3<br />.val: -1.802432e-03","date: 2006 Q4<br />.val:  9.443873e-03","date: 2007 Q1<br />.val: -1.692623e-02","date: 2007 Q2<br />.val:  9.284807e-03","date: 2007 Q3<br />.val: -1.802432e-03","date: 2007 Q4<br />.val:  9.443873e-03","date: 2008 Q1<br />.val: -1.692623e-02","date: 2008 Q2<br />.val:  9.284807e-03","date: 2008 Q3<br />.val: -1.802432e-03","date: 2008 Q4<br />.val:  9.443873e-03","date: 2009 Q1<br />.val: -1.692623e-02","date: 2009 Q2<br />.val:  9.284807e-03","date: 2009 Q3<br />.val: -1.802432e-03","date: 2009 Q4<br />.val:  9.443873e-03","date: 2010 Q1<br />.val: -1.692623e-02","date: 2010 Q2<br />.val:  9.284807e-03","date: 2010 Q3<br />.val: -1.802432e-03","date: 2010 Q4<br />.val:  9.443873e-03","date: 2011 Q1<br />.val: -1.692623e-02","date: 2011 Q2<br />.val:  9.284807e-03","date: 2011 Q3<br />.val: -1.802432e-03","date: 2011 Q4<br />.val:  9.443873e-03","date: 2012 Q1<br />.val: -1.692623e-02","date: 2012 Q2<br />.val:  9.284807e-03","date: 2012 Q3<br />.val: -1.802432e-03","date: 2012 Q4<br />.val:  9.443873e-03","date: 2013 Q1<br />.val: -1.692623e-02","date: 2013 Q2<br />.val:  9.284807e-03","date: 2013 Q3<br />.val: -1.802432e-03","date: 2013 Q4<br />.val:  9.443873e-03","date: 2014 Q1<br />.val: -1.692623e-02","date: 2014 Q2<br />.val:  9.284807e-03","date: 2014 Q3<br />.val: -1.802432e-03","date: 2014 Q4<br />.val:  9.443873e-03","date: 2015 Q1<br />.val: -1.692623e-02","date: 2015 Q2<br />.val:  9.284807e-03","date: 2015 Q3<br />.val: -1.802432e-03","date: 2015 Q4<br />.val:  9.443873e-03","date: 2016 Q1<br />.val: -1.692623e-02","date: 2016 Q2<br />.val:  9.284807e-03","date: 2016 Q3<br />.val: -1.802432e-03","date: 2016 Q4<br />.val:  9.443873e-03","date: 2017 Q1<br />.val: -1.692623e-02","date: 2017 Q2<br />.val:  9.284807e-03","date: 2017 Q3<br />.val: -1.802432e-03","date: 2017 Q4<br />.val:  9.443873e-03","date: 2018 Q1<br />.val: -1.692623e-02","date: 2018 Q2<br />.val:  9.284807e-03","date: 2018 Q3<br />.val: -1.802432e-03","date: 2018 Q4<br />.val:  9.443873e-03","date: 2019 Q1<br />.val: -1.692623e-02","date: 2019 Q2<br />.val:  9.284807e-03","date: 2019 Q3<br />.val: -1.802432e-03","date: 2019 Q4<br />.val:  9.443873e-03","date: 2020 Q1<br />.val: -1.692623e-02","date: 2020 Q2<br />.val:  9.284807e-03","date: 2020 Q3<br />.val: -1.802432e-03","date: 2020 Q4<br />.val:  9.443873e-03"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536],"y":[-0.0017671167164703405,0.0034295121721577004,-0.0023375578309536849,0.0013007643018863035,0.024715112201464606,-0.00093246969664306789,0.0039279543591863586,-0.012566920237985002,0.014231668216355686,-0.0067825909886884972,0.0058498571548515343,-0.011418606726282476,0.029731260174434837,0.0020633667254799093,0.013630716653874941,-0.016697802690291752,0.013974938045910434,-0.003674059472560387,0.0084970805428259411,-0.011694102269562023,-0.01267745666904041,0.010389238494575181,0.0050966418137523561,-0.0089362453995232016,0.0036270974438092907,0.0018371275113171492,-0.0039247453937250043,-0.013923612139533859,0.010335955058998536,0.0066889694213170259,-0.0027387713451343387,-0.0020906634759807474,-0.0069982751798587373,0.01010135319989125,-0.0069659134702249048,-0.0068594573185265517,0.0072336239671386693,0.0083013008602073057,-0.0006207859437736829,-0.0059031175512522793,-9.3050837497443695e-05,0.0057467235395556315,0.0013666486452290627,-0.0013930443514578172,-0.0078633243679036013,0.018283275228426987,0.0056637313464253936,-0.00037813137951125952,-0.053943676631091009,-0.054452974302479973,-0.0029655285492768968,0.0088304844009670092,-0.0053048021446588933,-0.00056806123401997866,0.0017451687147715944,0.0060782362847291438,-0.0031683935422890386,-0.0093848988638089992,0.0029850936253179583,0.0047764414291897594,0.0053008956133897556,-0.0057931811296505487,-0.00034528988218518464,0.013572086129983063,-0.011461535786965626,0.00069717508994848743,-0.0022837752440487691,0.0069171218592920525,-0.0048505757943555494,-0.0020863673891344803,-0.0017922625691539906,0.010416983438037875,-0.0037395346221948955,-0.0066177745947868516,0.0055664555916070668,0.008323031814615689,-0.0079438931535520396,-0.0015432706077511682,-0.0044414433418413779,0.010129796295968774,0.0045389492375953466,-0.0062990853877327169,-0.0080831138580759188,0.010036562833779072,-0.00234435194822602,0.0015694015952547602,-0.0010545582833145772,0.0066449474395344765,0.0015290260675655531,-0.0070250715062805114,0.00090824501988784334,0.0047594761614035974,0.014302595598840284,-0.18049613816593535,-0.004221770057323937,0.077418651370125602],"text":["date: 1997 Q1<br />.val: -1.767117e-03","date: 1997 Q2<br />.val:  3.429512e-03","date: 1997 Q3<br />.val: -2.337558e-03","date: 1997 Q4<br />.val:  1.300764e-03","date: 1998 Q1<br />.val:  2.471511e-02","date: 1998 Q2<br />.val: -9.324697e-04","date: 1998 Q3<br />.val:  3.927954e-03","date: 1998 Q4<br />.val: -1.256692e-02","date: 1999 Q1<br />.val:  1.423167e-02","date: 1999 Q2<br />.val: -6.782591e-03","date: 1999 Q3<br />.val:  5.849857e-03","date: 1999 Q4<br />.val: -1.141861e-02","date: 2000 Q1<br />.val:  2.973126e-02","date: 2000 Q2<br />.val:  2.063367e-03","date: 2000 Q3<br />.val:  1.363072e-02","date: 2000 Q4<br />.val: -1.669780e-02","date: 2001 Q1<br />.val:  1.397494e-02","date: 2001 Q2<br />.val: -3.674059e-03","date: 2001 Q3<br />.val:  8.497081e-03","date: 2001 Q4<br />.val: -1.169410e-02","date: 2002 Q1<br />.val: -1.267746e-02","date: 2002 Q2<br />.val:  1.038924e-02","date: 2002 Q3<br />.val:  5.096642e-03","date: 2002 Q4<br />.val: -8.936245e-03","date: 2003 Q1<br />.val:  3.627097e-03","date: 2003 Q2<br />.val:  1.837128e-03","date: 2003 Q3<br />.val: -3.924745e-03","date: 2003 Q4<br />.val: -1.392361e-02","date: 2004 Q1<br />.val:  1.033596e-02","date: 2004 Q2<br />.val:  6.688969e-03","date: 2004 Q3<br />.val: -2.738771e-03","date: 2004 Q4<br />.val: -2.090663e-03","date: 2005 Q1<br />.val: -6.998275e-03","date: 2005 Q2<br />.val:  1.010135e-02","date: 2005 Q3<br />.val: -6.965913e-03","date: 2005 Q4<br />.val: -6.859457e-03","date: 2006 Q1<br />.val:  7.233624e-03","date: 2006 Q2<br />.val:  8.301301e-03","date: 2006 Q3<br />.val: -6.207859e-04","date: 2006 Q4<br />.val: -5.903118e-03","date: 2007 Q1<br />.val: -9.305084e-05","date: 2007 Q2<br />.val:  5.746724e-03","date: 2007 Q3<br />.val:  1.366649e-03","date: 2007 Q4<br />.val: -1.393044e-03","date: 2008 Q1<br />.val: -7.863324e-03","date: 2008 Q2<br />.val:  1.828328e-02","date: 2008 Q3<br />.val:  5.663731e-03","date: 2008 Q4<br />.val: -3.781314e-04","date: 2009 Q1<br />.val: -5.394368e-02","date: 2009 Q2<br />.val: -5.445297e-02","date: 2009 Q3<br />.val: -2.965529e-03","date: 2009 Q4<br />.val:  8.830484e-03","date: 2010 Q1<br />.val: -5.304802e-03","date: 2010 Q2<br />.val: -5.680612e-04","date: 2010 Q3<br />.val:  1.745169e-03","date: 2010 Q4<br />.val:  6.078236e-03","date: 2011 Q1<br />.val: -3.168394e-03","date: 2011 Q2<br />.val: -9.384899e-03","date: 2011 Q3<br />.val:  2.985094e-03","date: 2011 Q4<br />.val:  4.776441e-03","date: 2012 Q1<br />.val:  5.300896e-03","date: 2012 Q2<br />.val: -5.793181e-03","date: 2012 Q3<br />.val: -3.452899e-04","date: 2012 Q4<br />.val:  1.357209e-02","date: 2013 Q1<br />.val: -1.146154e-02","date: 2013 Q2<br />.val:  6.971751e-04","date: 2013 Q3<br />.val: -2.283775e-03","date: 2013 Q4<br />.val:  6.917122e-03","date: 2014 Q1<br />.val: -4.850576e-03","date: 2014 Q2<br />.val: -2.086367e-03","date: 2014 Q3<br />.val: -1.792263e-03","date: 2014 Q4<br />.val:  1.041698e-02","date: 2015 Q1<br />.val: -3.739535e-03","date: 2015 Q2<br />.val: -6.617775e-03","date: 2015 Q3<br />.val:  5.566456e-03","date: 2015 Q4<br />.val:  8.323032e-03","date: 2016 Q1<br />.val: -7.943893e-03","date: 2016 Q2<br />.val: -1.543271e-03","date: 2016 Q3<br />.val: -4.441443e-03","date: 2016 Q4<br />.val:  1.012980e-02","date: 2017 Q1<br />.val:  4.538949e-03","date: 2017 Q2<br />.val: -6.299085e-03","date: 2017 Q3<br />.val: -8.083114e-03","date: 2017 Q4<br />.val:  1.003656e-02","date: 2018 Q1<br />.val: -2.344352e-03","date: 2018 Q2<br />.val:  1.569402e-03","date: 2018 Q3<br />.val: -1.054558e-03","date: 2018 Q4<br />.val:  6.644947e-03","date: 2019 Q1<br />.val:  1.529026e-03","date: 2019 Q2<br />.val: -7.025072e-03","date: 2019 Q3<br />.val:  9.082450e-04","date: 2019 Q4<br />.val:  4.759476e-03","date: 2020 Q1<br />.val:  1.430260e-02","date: 2020 Q2<br />.val: -1.804961e-01","date: 2020 Q3<br />.val: -4.221770e-03","date: 2020 Q4<br />.val:  7.741865e-02"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[15.365149098445571,15.391519198153507,15.391519198153507,15.365149098445571,15.365149098445571],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[15.366451359693301,15.392821459401237,15.392821459401237,15.366451359693301,15.366451359693301],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[-0.016926226463230564,0.0094438732447054245,0.0094438732447054245,-0.016926226463230564,-0.016926226463230564],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9678,9678,9770,9770,9678],"y":[-0.064723793251872871,-0.038353693543936876,-0.038353693543936876,-0.064723793251872871,-0.064723793251872871],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":55.452054794520549,"r":18.99543378995434,"b":40.182648401826491,"l":34.337899543379002},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9235.1000000000004,18978.900000000001],"tickmode":"array","ticktext":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"tickvals":[10957,12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"log(price)","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[15.099106914264182,15.657561382334896],"tickmode":"array","ticktext":["15.1","15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.100000000000001,15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.1","15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[15.119539365637078,15.63973345345746],"tickmode":"array","ticktext":["15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.018244731448627365,0.010762378230102225],"tickmode":"array","ticktext":["-0.01","0.00","0.01"],"tickvals":[-0.01,0,0.0099999999999999985],"categoryorder":"array","categoryarray":["-0.01","0.00","0.01"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.19339187764273841,0.090314390846928647],"tickmode":"array","ticktext":["-0.1","0.0"],"tickvals":[-0.10000000000000001,0],"categoryorder":"array","categoryarray":["-0.1","0.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"18311c0d6e61":{"x":{},"y":{},"type":"scatter"},"18316360e610":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"18311c0d6e61","visdat":{"18311c0d6e61":["function (y) ","x"],"18316360e610":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="model-specification" class="slide level2" data-number="1.4">
<h2><span class="header-section-number">1.4</span> Model Specification</h2>
<p>We will <strong>fit</strong> two models to our time series: <em>Seasonal Naïve</em>, and the <em>Drift</em> model. We will also use the log transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>gdp_fit <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a></a>  <span class="fu">model</span>(</span>
<span id="cb10-3"><a></a>    <span class="at">snaive =</span> <span class="fu">SNAIVE</span>(<span class="fu">log</span>(price)),</span>
<span id="cb10-4"><a></a>    <span class="at">drift  =</span> <span class="fu">RW</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb10-5"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Benchmark models</strong></p>
</div>
<div class="callout-content">
<p>We have four different benchmark models that we’ll use to compare against the rest of the more complex models: - Mean (<code>MEAN( &lt;.y&gt; )</code>) - Naïve (<code>NAIVE( &lt;.y&gt; )</code>) - Seasonal Naïve (<code>SNAIVE( &lt;.y&gt; )</code>) - Drift (<code>RW( &lt;.y&gt; ~ drift())</code>)</p>
<p>where <code>&lt;.y&gt;</code> is just a placeholder for the variable to model.</p>
<p>Choose wisely which of these to use in each case, according to the exploratory analysis performed.</p>
</div>
</div>
</div>
</section>
<section id="residuals-diagnostics" class="slide level2 scrollable" data-number="1.5">
<h2><span class="header-section-number">1.5</span> Residuals Diagnostics</h2>
<h3 data-number="1.5.1" id="visual-analysis"><span class="header-section-number">1.5.1</span> Visual analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a></a>  <span class="fu">select</span>(snaive) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals Diagnostics for the Seasonal Naïve Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-11-1.png" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a></a>  <span class="fu">select</span>(drift) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals Diagnostics for the Drift Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-11-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-11-2.png" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Here we expect to see:</p>
<ul>
<li>A time series with no apparent patterns (no trend and/or seasonality), with a mean close to zero.</li>
<li>In the <strong>ACF</strong>, we’d expect no lags with significant autocorrelation.</li>
<li>Normally distributed residuals.</li>
</ul>
</div>
</div>
</div>
<h3 data-number="1.5.2" id="portmanteau-tests-of-autocorrelation"><span class="header-section-number">1.5.2</span> Portmanteau tests of autocorrelation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">24</span>, <span class="at">dof =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"118.56792","4":"1.743050e-14"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"62.21247","4":"3.091462e-05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Residuals interpretation</strong></p>
</div>
<div class="callout-content">
<p>Both models produce sub optimal residuals:</p>
<ul>
<li><p>The SNAIVE correctly detects the seasonality, however, its residuals are still autocorrelated. Moreover, the residuals are not normally distributed.</p></li>
<li><p>The drift model doesn’t account for the seasonality, and their distribution is a little bit skewed.</p></li>
</ul>
<p>Hence, we will perform our forecasts using the <strong>bootstrapping</strong> method.</p>
</div>
</div>
</div>
<p>We can compute some error metrics on the training set using the <code>accuracy()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>gdp_train_accu <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(gdp_fit) <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a></a>  <span class="fu">arrange</span>(MAPE)</span>
<span id="cb14-3"><a></a>gdp_train_accu <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a></a>  <span class="fu">select</span>(symbol<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.45218","5":"189100.4","6":"125961.4","7":"0.8232537"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.08231","5":"213059.8","6":"153004.4","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The <code>accuracy()</code> function</strong></p>
</div>
<div class="callout-content">
<p>The <code>accuracy()</code> function can be used to compute error metrics in the training data, or in the test set. What differs is the data that is given to it:</p>
<ul>
<li><p>For the training metrics, you need to use the <strong><code>mable</code></strong> (the table of models, that we usually store in <code>_fit</code>).</p></li>
<li><p>For the forecasting error metrics, we need the <strong><code>fable</code></strong> (the forecasts table, usually stored as <code>_fc</code> or <code>_fcst</code>), and the <strong>complete set of data</strong> (both the training and test set together).</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>For this analysis, we are focusing on the <strong>MAPE</strong><sup>1</sup> metric. The drift model <strong>(2.45%)</strong> seems to have a better fit with the training set than the snaive model <strong>(3.08%)</strong>.</p>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>The Mean Absolute Percentage Error is a percentage error metric widely used in professional environments.</p>
<p>Let</p>
<p><span class="math display">\[
e_t = y_t - \hat{y}_t
\]</span></p>
<p>be the error or residual.</p>
<p>Then the MAPE would be computed as</p>
<p><span class="math display">\[
MAPE = \frac{1}{T}\sum_{t=1}^T|\frac{e_t}{y_t}|
\]</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</li></ol></aside></section>
<section id="modeling-using-decomposition" class="slide level2 scrollable" data-number="1.6">
<h2><span class="header-section-number">1.6</span> Modeling using decomposition</h2>
<p>We will perform a forecast using decomposition, to see if we can improve our results so far.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>gdp_fit_dcmp <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a></a>      <span class="fu">model</span>(</span>
<span id="cb15-3"><a></a>        <span class="at">stlf =</span> <span class="fu">decomposition_model</span>(</span>
<span id="cb15-4"><a></a>          <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-5"><a></a>          <span class="fu">RW</span>(season_adjust <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb15-6"><a></a>        )</span>
<span id="cb15-7"><a></a>      )</span>
<span id="cb15-8"><a></a></span>
<span id="cb15-9"><a></a>gdp_fit_dcmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note on <code>decomposition_model()</code></strong></p>
</div>
<div class="callout-content">
<p>Remember, when using decomposition models, we need to do the following:</p>
<ol type="1">
<li><p>Specify what type of decomposition we want to use and customize it as needed.</p></li>
<li><p>Fit a model for the seasonally adjusted data; <code>season_adjust</code>.</p></li>
<li><p>Fit a model for the seasonal component. <strong>R</strong> uses a <code>SNAIVE()</code> model by default to model the seasonality. If you wish to model it using a different model, you have specify it.</p></li>
</ol>
<ul>
<li>The name of the seasonal component depends on the type of seasonality present in the time series. If it has a yearly seasonality, the component is called <code>season_year</code>. It could also be called <code>season_week</code>, <code>season_day</code>, and so on.</li>
</ul>
</div>
</div>
</div>
<p>We can join this new model with the models we trained before. This way we can have them all in the same <code>mable</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>gdp_fit <span class="ot">&lt;-</span> gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a></a>  <span class="fu">left_join</span>(gdp_fit_dcmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(symbol)`</code></pre>
</div>
</div>
<h3 data-number="1.6.1" id="residuals-diagnostics-1"><span class="header-section-number">1.6.1</span> Residuals diagnostics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a></a>  <span class="fu">accuracy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a></a>  <span class="fu">select</span>(symbol<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a></a>  <span class="fu">arrange</span>(MAPE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"Training","4":"1.702697","5":"171996.9","6":"84659.55","7":"0.5533145"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.452180","5":"189100.4","6":"125961.43","7":"0.8232537"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.082310","5":"213059.8","6":"153004.39","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a></a>  <span class="fu">select</span>(stlf) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a></a>  <span class="fu">gg_tsresiduals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-18-1.png" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a></a>  <span class="fu">features</span>(.innov, ljung_box)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"11.389002","4":"7.388021e-04"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"36.224571","4":"1.758395e-09"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"6.800928","4":"9.111053e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>The MAPE seems to improve with this decomposition model. Also, the residual diagnostics do not show any seasonality present in them. However, the residuals are still autocorrelated, as the <em>Ljung-Box</em> test suggests.</p>
</div>
</div>
</div>
</section>
<section id="forecasting-on-the-test-set" class="slide level2" data-number="1.7">
<h2><span class="header-section-number">1.7</span> Forecasting on the test set</h2>
<p>Once we have our models, we can produce forecasts. We will forecast our test data and check our forecasts’ performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>gdp_fc <span class="ot">&lt;-</span> gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">6</span>) </span>
<span id="cb21-3"><a></a></span>
<span id="cb21-4"><a></a>gdp_fc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2021 Q1","4":"<dist>","5":"5867750"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2021 Q2","4":"<dist>","5":"4817527"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2021 Q3","4":"<dist>","5":"5523000"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2021 Q4","4":"<dist>","5":"5881399"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q1","4":"<dist>","5":"5872993"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q2","4":"<dist>","5":"4821832"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2021 Q1","4":"<dist>","5":"5908722"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2021 Q2","4":"<dist>","5":"5941561"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2021 Q3","4":"<dist>","5":"5974662"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2021 Q4","4":"<dist>","5":"6008029"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q1","4":"<dist>","5":"6041662"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q2","4":"<dist>","5":"6075565"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2021 Q1","4":"<dist>","5":"5752637"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2021 Q2","4":"<dist>","5":"5935837"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2021 Q3","4":"<dist>","5":"5900698"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2021 Q4","4":"<dist>","5":"5998310"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q1","4":"<dist>","5":"5872493"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q2","4":"<dist>","5":"6059777"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a></a>  <span class="fu">autoplot</span>(gdp) <span class="sc">+</span></span>
<span id="cb22-3"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.model, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-21-1.png" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a></a>  <span class="fu">filter</span>(.model <span class="sc">==</span> <span class="st">"stlf"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a></a>  <span class="fu">autoplot</span>(gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-21-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-21-2.png" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We now estimate the forecast errors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a></a>  <span class="fu">accuracy</span>(gdp) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a></a>  <span class="fu">select</span>(.model<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a></a>  <span class="fu">arrange</span>(MAPE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["symbol"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"stlf","2":"NGDPRNSAXDCMXQ","3":"Test","4":"0.6063968","5":"46862.21","6":"35366.27","7":"0.2311454"},{"1":"drift","2":"NGDPRNSAXDCMXQ","3":"Test","4":"1.7554363","5":"131552.07","6":"101845.07","7":"0.6656350"},{"1":"snaive","2":"NGDPRNSAXDCMXQ","3":"Test","4":"8.1042435","5":"692289.84","6":"483037.94","7":"3.1570201"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="forecasting-the-future" class="slide level2" data-number="1.8">
<h2><span class="header-section-number">1.8</span> Forecasting the future</h2>
<p>We now refit our model using the whole dataset. We will only model the STL decomposition model, because the other two didn’t get a strong fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>gdp_fit2 <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a></a>  <span class="fu">model</span>(</span>
<span id="cb25-3"><a></a>    <span class="at">stlf =</span> <span class="fu">decomposition_model</span>(</span>
<span id="cb25-4"><a></a>          <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-5"><a></a>          <span class="fu">RW</span>(season_adjust <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb25-6"><a></a>        )</span>
<span id="cb25-7"><a></a>  )</span>
<span id="cb25-8"><a></a>gdp_fit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>gdp_fc_fut <span class="ot">&lt;-</span> gdp_fit2 <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="st">"3 years"</span>)</span>
<span id="cb26-3"><a></a>gdp_fc_fut</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q4","4":"<dist>","5":"6516112"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q1","4":"<dist>","5":"6346930"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q2","4":"<dist>","5":"6559748"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q3","4":"<dist>","5":"6527613"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q4","4":"<dist>","5":"6655733"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q1","4":"<dist>","5":"6483142"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q2","4":"<dist>","5":"6700749"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q3","4":"<dist>","5":"6668145"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q4","4":"<dist>","5":"6799248"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q1","4":"<dist>","5":"6623154"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q2","4":"<dist>","5":"6845686"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q3","4":"<dist>","5":"6812601"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>gdp_fc_fut <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a></a>  <span class="fu">autoplot</span>(gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="forecasting_workflow_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="forecasting_workflow_files/figure-html/unnamed-chunk-24-1.png" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="co"># save(gdp_fc_fut, file = "equipo1.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../images/iteso_logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Time Series Forecasting</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/pbenavidesh\.github\.io\/narsil\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>