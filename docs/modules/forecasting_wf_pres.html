<!DOCTYPE html>
<html lang="en"><head>
<link href="../../images/narsil_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2a367172f4fe7d9182ebf8e09f85cb4e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="author" content="Pablo Benavides">
<meta name="dcterms.date" content="2022-09-30">
<title>Time Series Forecasting – The Forecasting Workflow using fable</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #383a42;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #383a42; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #50a14f; } /* Annotation */
    code span.at { color: #a626a4; } /* Attribute */
    code span.bn { color: #986801; } /* BaseN */
    code span.bu { color: #a626a4; } /* BuiltIn */
    code span.cf { color: #a626a4; } /* ControlFlow */
    code span.ch { color: #50a14f; } /* Char */
    code span.cn { color: #986801; } /* Constant */
    code span.co { color: #a0a1a7; font-style: italic; } /* Comment */
    code span.cv { color: #e45649; font-style: italic; } /* CommentVar */
    code span.do { color: #e45649; } /* Documentation */
    code span.dt { color: #a626a4; } /* DataType */
    code span.dv { color: #986801; } /* DecVal */
    code span.er { color: #f44747; text-decoration: underline; } /* Error */
    code span.ex { color: #4078f2; font-weight: bold; } /* Extension */
    code span.fl { color: #986801; } /* Float */
    code span.fu { color: #4078f2; } /* Function */
    code span.im { color: #50a14f; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #a626a4; } /* Keyword */
    code span.op { color: #a626a4; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #a626a4; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #0184bc; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #50a14f; } /* String */
    code span.va { color: #e45649; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-f83072172e240c2b28d4d24e182e25c3.css">
<script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<script type="application/json" class="js-hypothesis-config">
  {
    "theme": "classic"
  }
  </script><script async="" src="https://hypothes.is/embed.js"></script><script>
    window.document.addEventListener("DOMContentLoaded", function (_event) {
      document.body.classList.add('hypothesis-enabled');
    });
  </script><style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../../site_libs/plotly-binding-4.11.0/plotly.js"></script><script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script><script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script><link href="../../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta property="og:site_name" content="Time Series Forecasting">
<meta name="twitter:title" content="The Forecasting Workflow using fable – Time Series Forecasting">
<meta name="twitter:creator" content="@PabsBenavides">
<meta name="twitter:card" content="summary">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">The Forecasting Workflow using <code>fable</code>
</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Pablo Benavides 
</div>
</div>
</div>

  <p class="date">2022-09-30</p>
</section><section class="slide level2"><div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://tidyverts.org/images/fable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="https://tidyverts.org/images/fable.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</section><section><section id="introduction" class="title-slide slide level1 unnumbered center"><h1>Introduction</h1>

</section><section id="packages" class="slide level2"><h2>Packages</h2>
<p>It is recommended to load all the packages at the beginning of your file. We will be using the <code>tidyverts</code> ecosystem for the whole forecasting workflow.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(plotly)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Do not load unnecesary packages into your environment. It could lead to conflicts between functions and unwanted results.</p>
</div>
</div>
</div>
</section></section><section><section id="forecasting-workflow" class="title-slide slide level1 center"><h1>Forecasting Workflow</h1>

</section><section id="data" class="slide level2 scrollable"><h2>Data</h2>
<p>We will work with the Real Gross Domestic Product (GDP) for Mexico. The data is downloaded from <a href="https://fred.stlouisfed.org/series/NGDPRNSAXDCMXQ">FRED</a>. The time series id is <code>NGDPRNSAXDCMXQ</code>.</p>
<h3 id="import-data">Import data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>gdp <span class="ot">&lt;-</span> tidyquant<span class="sc">::</span><span class="fu">tq_get</span>(</span>
<span id="cb2-2"><a></a>  <span class="at">x    =</span> <span class="st">"NGDPRNSAXDCMXQ"</span>,</span>
<span id="cb2-3"><a></a>  <span class="at">get  =</span> <span class="st">"economic.data"</span>,</span>
<span id="cb2-4"><a></a>  <span class="at">from =</span> <span class="st">"1997-01-01"</span></span>
<span id="cb2-5"><a></a>)</span>
<span id="cb2-6"><a></a></span>
<span id="cb2-7"><a></a>gdp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 115 × 3
   symbol         date          price
   &lt;chr&gt;          &lt;date&gt;        &lt;dbl&gt;
 1 NGDPRNSAXDCMXQ 1997-01-01 3702398.
 2 NGDPRNSAXDCMXQ 1997-04-01 3896084.
 3 NGDPRNSAXDCMXQ 1997-07-01 3906063 
 4 NGDPRNSAXDCMXQ 1997-10-01 4038358.
 5 NGDPRNSAXDCMXQ 1998-01-01 4084304.
 6 NGDPRNSAXDCMXQ 1998-04-01 4134899.
 7 NGDPRNSAXDCMXQ 1998-07-01 4138200.
 8 NGDPRNSAXDCMXQ 1998-10-01 4146841.
 9 NGDPRNSAXDCMXQ 1999-01-01 4176243.
10 NGDPRNSAXDCMXQ 1999-04-01 4232280.
# ℹ 105 more rows</code></pre>
</div>
</div>
<h3 id="wrangle-data">Wrangle data</h3>
<p>There are some issues with our data:</p>
<ol type="1">
<li class="fragment">It is loaded into a <code>tibble</code> object. We need to convert it to a <strong><code>tsibble</code></strong>.</li>
</ol>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>We can use <code>as_tsibble()</code> to do so.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li class="fragment">Our data is <strong>quarterly</strong>, but it is loaded in a <code>YYYY-MM-DD</code> format. We need to change it to a <code>YYYY QQ</code> format.</li>
</ol>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>There are some functions that help us achieve this, such as</p>
<ul>
<li class="fragment"><code>yearquarter()</code></li>
<li class="fragment"><code>yearmonth()</code></li>
<li class="fragment"><code>yearweek()</code></li>
<li class="fragment"><code>year()</code></li>
</ul>
<p>depending on the time series’ period.</p>
</div>
</div>
</div>
<p>We will overwrite our data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>gdp <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">yearquarter</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a></a>  <span class="fu">as_tsibble</span>(</span>
<span id="cb4-4"><a></a>    <span class="at">index =</span> date,</span>
<span id="cb4-5"><a></a>    <span class="at">key   =</span> symbol</span>
<span id="cb4-6"><a></a>  )</span>
<span id="cb4-7"><a></a></span>
<span id="cb4-8"><a></a>gdp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134899"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146841"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262621"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840643"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936399"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990925"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169143"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237545"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734911"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542389"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862075"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803635"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995609"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826517"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872817"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082192"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892098"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098933"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151318"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947648"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038700"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006226"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089156"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862493"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813186"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518050"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876205"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q1","3":"5710346"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q2","3":"5905880"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q3","3":"5801189"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q4","3":"5987417"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q1","3":"5860242"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q2","3":"6077556"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q3","3":"6072325"},{"1":"NGDPRNSAXDCMXQ","2":"2022 Q4","3":"6262970"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q1","3":"6082506"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q2","3":"6276608"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q3","3":"6272626"},{"1":"NGDPRNSAXDCMXQ","2":"2023 Q4","3":"6395468"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q1","3":"6185758"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q2","3":"6406399"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q3","3":"6360504"},{"1":"NGDPRNSAXDCMXQ","2":"2024 Q4","3":"6412561"},{"1":"NGDPRNSAXDCMXQ","2":"2025 Q1","3":"6220320"},{"1":"NGDPRNSAXDCMXQ","2":"2025 Q2","3":"6402037"},{"1":"NGDPRNSAXDCMXQ","2":"2025 Q3","3":"6352872"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<ul>
<li class="fragment"><p>We always need to specify the <code>index</code> argument, as it is our <strong>date</strong> variable.</p></li>
<li class="fragment"><p>The <code>key</code> argument is necessary whenever we have more than one time series in our data frame and is made up of <strong>one or more columns</strong> that uniquely identify each time series .</p></li>
</ul>
</div>
</div>
</div>
</section><section id="traintest-split" class="slide level2"><h2>Train/Test Split</h2>
<p>We will split our data in two sets: a training set, and a test set, in order to evaluate our forecasts’ accuracy.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>gdp_train <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a></a>  <span class="fu">filter_index</span>(. <span class="sc">~</span> <span class="st">"2021 Q4"</span>)</span>
<span id="cb5-3"><a></a></span>
<span id="cb5-4"><a></a>gdp_train</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"1997 Q1","3":"3702398"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q2","3":"3896084"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q3","3":"3906063"},{"1":"NGDPRNSAXDCMXQ","2":"1997 Q4","3":"4038358"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q1","3":"4084304"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q2","3":"4134899"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q3","3":"4138200"},{"1":"NGDPRNSAXDCMXQ","2":"1998 Q4","3":"4146841"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q1","3":"4176243"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q2","3":"4232280"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q3","3":"4262621"},{"1":"NGDPRNSAXDCMXQ","2":"1999 Q4","3":"4287798"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q1","3":"4412426"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q2","3":"4465504"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q3","3":"4505221"},{"1":"NGDPRNSAXDCMXQ","2":"2000 Q4","3":"4428703"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q1","3":"4441058"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q2","3":"4468505"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q3","3":"4440265"},{"1":"NGDPRNSAXDCMXQ","2":"2001 Q4","3":"4381722"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q1","3":"4269784"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q2","3":"4504200"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q3","3":"4457001"},{"1":"NGDPRNSAXDCMXQ","2":"2002 Q4","3":"4458615"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q1","3":"4402402"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q2","3":"4520666"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q3","3":"4464787"},{"1":"NGDPRNSAXDCMXQ","2":"2003 Q4","3":"4511464"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q1","3":"4546254"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q2","3":"4692565"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q3","3":"4615345"},{"1":"NGDPRNSAXDCMXQ","2":"2004 Q4","3":"4683344"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q1","3":"4567922"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q2","3":"4804679"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q3","3":"4720818"},{"1":"NGDPRNSAXDCMXQ","2":"2005 Q4","3":"4835832"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q1","3":"4840643"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q2","3":"5029028"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q3","3":"4959002"},{"1":"NGDPRNSAXDCMXQ","2":"2006 Q4","3":"5010131"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q1","3":"4936399"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q2","3":"5127368"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q3","3":"5066709"},{"1":"NGDPRNSAXDCMXQ","2":"2007 Q4","3":"5120551"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q1","3":"4975730"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q2","3":"5249626"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q3","3":"5123968"},{"1":"NGDPRNSAXDCMXQ","2":"2008 Q4","3":"5092737"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q1","3":"4634315"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q2","3":"4706891"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q3","3":"4823052"},{"1":"NGDPRNSAXDCMXQ","2":"2009 Q4","3":"4990925"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q1","3":"4842968"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q2","3":"5045140"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q3","3":"5050200"},{"1":"NGDPRNSAXDCMXQ","2":"2010 Q4","3":"5169143"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q1","3":"5022838"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q2","3":"5170734"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q3","3":"5237545"},{"1":"NGDPRNSAXDCMXQ","2":"2011 Q4","3":"5368844"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q1","3":"5270945"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q2","3":"5380528"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q3","3":"5369752"},{"1":"NGDPRNSAXDCMXQ","2":"2012 Q4","3":"5517802"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q1","3":"5256450"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q2","3":"5473377"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q3","3":"5425704"},{"1":"NGDPRNSAXDCMXQ","2":"2013 Q4","3":"5567030"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q1","3":"5386946"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q2","3":"5580039"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q3","3":"5564547"},{"1":"NGDPRNSAXDCMXQ","2":"2014 Q4","3":"5734911"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q1","3":"5542389"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q2","3":"5710754"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q3","3":"5752936"},{"1":"NGDPRNSAXDCMXQ","2":"2015 Q4","3":"5862075"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q1","3":"5634258"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q2","3":"5839989"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q3","3":"5803635"},{"1":"NGDPRNSAXDCMXQ","2":"2016 Q4","3":"5995609"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q1","3":"5826517"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q2","3":"5927582"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q3","3":"5872817"},{"1":"NGDPRNSAXDCMXQ","2":"2017 Q4","3":"6082192"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q1","3":"5892098"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q2","3":"6098933"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q3","3":"6034322"},{"1":"NGDPRNSAXDCMXQ","2":"2018 Q4","3":"6151318"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q1","3":"5947648"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q2","3":"6038700"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q3","3":"6006226"},{"1":"NGDPRNSAXDCMXQ","2":"2019 Q4","3":"6089156"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q1","3":"5862493"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q2","3":"4813186"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q3","3":"5518050"},{"1":"NGDPRNSAXDCMXQ","2":"2020 Q4","3":"5876205"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q1","3":"5710346"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q2","3":"5905880"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q3","3":"5801189"},{"1":"NGDPRNSAXDCMXQ","2":"2021 Q4","3":"5987417"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>For all our variables, it is strongly recommended to follow the same notation process, and write our code using <a href="https://en.wikipedia.org/wiki/Snake_case"><strong>snake_case</strong></a>. Here, we called our data <code>gdp</code>, therefore, all the following variables will be called starting with <strong><code>gdp_</code></strong><a href="#/footnotes" class="footnote-ref" id="fnref1" role="doc-noteref" data-footnote-href="#/fn1" onclick=""><sup>1</sup></a>, such as <code>gdp_train</code> for our training set.</p>
</div>
</div>
</div>
<aside></aside></section><section id="visualization-and-eda" class="slide level2"><h2>Visualization and EDA</h2>
<p>When performing time series analysis/forecasting, one of the first things to do is to create a time series plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>p <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a></a>  <span class="fu">autoplot</span>(price) <span class="sc">+</span></span>
<span id="cb6-3"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb6-4"><a></a>    <span class="at">title =</span> <span class="st">"Time series plot of the Real GDP for Mexico"</span>,</span>
<span id="cb6-5"><a></a>    <span class="at">y =</span> <span class="st">"GDP"</span></span>
<span id="cb6-6"><a></a>  )</span>
<span id="cb6-7"><a></a> </span>
<span id="cb6-8"><a></a><span class="fu">ggplotly</span>(p, <span class="at">dynamicTicks =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a></a>  <span class="fu">rangeslider</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-386f5d0c480db974bc0d" style="width:960px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-386f5d0c480db974bc0d">{"x":{"data":[{"x":["1997-01-01","1997-04-01","1997-07-01","1997-10-01","1998-01-01","1998-04-01","1998-07-01","1998-10-01","1999-01-01","1999-04-01","1999-07-01","1999-10-01","2000-01-01","2000-04-01","2000-07-01","2000-10-01","2001-01-01","2001-04-01","2001-07-01","2001-10-01","2002-01-01","2002-04-01","2002-07-01","2002-10-01","2003-01-01","2003-04-01","2003-07-01","2003-10-01","2004-01-01","2004-04-01","2004-07-01","2004-10-01","2005-01-01","2005-04-01","2005-07-01","2005-10-01","2006-01-01","2006-04-01","2006-07-01","2006-10-01","2007-01-01","2007-04-01","2007-07-01","2007-10-01","2008-01-01","2008-04-01","2008-07-01","2008-10-01","2009-01-01","2009-04-01","2009-07-01","2009-10-01","2010-01-01","2010-04-01","2010-07-01","2010-10-01","2011-01-01","2011-04-01","2011-07-01","2011-10-01","2012-01-01","2012-04-01","2012-07-01","2012-10-01","2013-01-01","2013-04-01","2013-07-01","2013-10-01","2014-01-01","2014-04-01","2014-07-01","2014-10-01","2015-01-01","2015-04-01","2015-07-01","2015-10-01","2016-01-01","2016-04-01","2016-07-01","2016-10-01","2017-01-01","2017-04-01","2017-07-01","2017-10-01","2018-01-01","2018-04-01","2018-07-01","2018-10-01","2019-01-01","2019-04-01","2019-07-01","2019-10-01","2020-01-01","2020-04-01","2020-07-01","2020-10-01","2021-01-01","2021-04-01","2021-07-01","2021-10-01"],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5,4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999,4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002,4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998,4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004,4269784.4000000004,4504199.5,4457000.9000000004,4458615,4402401.5,4520666,4464786.7999999998,4511463.5999999996,4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996,4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998,4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998,4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002,4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996,4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002,4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004,5022838,5170733.5,5237545.4000000004,5368843.5999999996,5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996,5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004,5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998,5542388.5999999996,5710754.4000000004,5752936.5,5862074.7999999998,5634257.7999999998,5839988.9000000004,5803635.2999999998,5995608.7000000002,5826517.2999999998,5927581.7000000002,5872816.5999999996,6082191.7000000002,5892097.5,6098933.4000000004,6034321.5999999996,6151317.9000000004,5947648.2000000002,6038700.4000000004,6006226.4000000004,6089155.7999999998,5862493,4813186.5,5518050.4000000004,5876204.7999999998,5710345.7000000002,5905879.5999999996,5801188.7999999998,5987417],"text":["date: 1997 Q1<br />price: 3702398","date: 1997 Q2<br />price: 3896084","date: 1997 Q3<br />price: 3906063","date: 1997 Q4<br />price: 4038358","date: 1998 Q1<br />price: 4084304","date: 1998 Q2<br />price: 4134899","date: 1998 Q3<br />price: 4138200","date: 1998 Q4<br />price: 4146841","date: 1999 Q1<br />price: 4176243","date: 1999 Q2<br />price: 4232280","date: 1999 Q3<br />price: 4262621","date: 1999 Q4<br />price: 4287798","date: 2000 Q1<br />price: 4412426","date: 2000 Q2<br />price: 4465504","date: 2000 Q3<br />price: 4505221","date: 2000 Q4<br />price: 4428703","date: 2001 Q1<br />price: 4441058","date: 2001 Q2<br />price: 4468505","date: 2001 Q3<br />price: 4440265","date: 2001 Q4<br />price: 4381722","date: 2002 Q1<br />price: 4269784","date: 2002 Q2<br />price: 4504200","date: 2002 Q3<br />price: 4457001","date: 2002 Q4<br />price: 4458615","date: 2003 Q1<br />price: 4402402","date: 2003 Q2<br />price: 4520666","date: 2003 Q3<br />price: 4464787","date: 2003 Q4<br />price: 4511464","date: 2004 Q1<br />price: 4546254","date: 2004 Q2<br />price: 4692565","date: 2004 Q3<br />price: 4615345","date: 2004 Q4<br />price: 4683344","date: 2005 Q1<br />price: 4567922","date: 2005 Q2<br />price: 4804679","date: 2005 Q3<br />price: 4720818","date: 2005 Q4<br />price: 4835832","date: 2006 Q1<br />price: 4840643","date: 2006 Q2<br />price: 5029028","date: 2006 Q3<br />price: 4959002","date: 2006 Q4<br />price: 5010131","date: 2007 Q1<br />price: 4936399","date: 2007 Q2<br />price: 5127368","date: 2007 Q3<br />price: 5066709","date: 2007 Q4<br />price: 5120551","date: 2008 Q1<br />price: 4975730","date: 2008 Q2<br />price: 5249626","date: 2008 Q3<br />price: 5123968","date: 2008 Q4<br />price: 5092737","date: 2009 Q1<br />price: 4634315","date: 2009 Q2<br />price: 4706891","date: 2009 Q3<br />price: 4823052","date: 2009 Q4<br />price: 4990925","date: 2010 Q1<br />price: 4842968","date: 2010 Q2<br />price: 5045140","date: 2010 Q3<br />price: 5050200","date: 2010 Q4<br />price: 5169143","date: 2011 Q1<br />price: 5022838","date: 2011 Q2<br />price: 5170734","date: 2011 Q3<br />price: 5237545","date: 2011 Q4<br />price: 5368844","date: 2012 Q1<br />price: 5270945","date: 2012 Q2<br />price: 5380528","date: 2012 Q3<br />price: 5369752","date: 2012 Q4<br />price: 5517802","date: 2013 Q1<br />price: 5256450","date: 2013 Q2<br />price: 5473377","date: 2013 Q3<br />price: 5425704","date: 2013 Q4<br />price: 5567030","date: 2014 Q1<br />price: 5386946","date: 2014 Q2<br />price: 5580039","date: 2014 Q3<br />price: 5564547","date: 2014 Q4<br />price: 5734911","date: 2015 Q1<br />price: 5542389","date: 2015 Q2<br />price: 5710754","date: 2015 Q3<br />price: 5752936","date: 2015 Q4<br />price: 5862075","date: 2016 Q1<br />price: 5634258","date: 2016 Q2<br />price: 5839989","date: 2016 Q3<br />price: 5803635","date: 2016 Q4<br />price: 5995609","date: 2017 Q1<br />price: 5826517","date: 2017 Q2<br />price: 5927582","date: 2017 Q3<br />price: 5872817","date: 2017 Q4<br />price: 6082192","date: 2018 Q1<br />price: 5892098","date: 2018 Q2<br />price: 6098933","date: 2018 Q3<br />price: 6034322","date: 2018 Q4<br />price: 6151318","date: 2019 Q1<br />price: 5947648","date: 2019 Q2<br />price: 6038700","date: 2019 Q3<br />price: 6006226","date: 2019 Q4<br />price: 6089156","date: 2020 Q1<br />price: 5862493","date: 2020 Q2<br />price: 4813186","date: 2020 Q3<br />price: 5518050","date: 2020 Q4<br />price: 5876205","date: 2021 Q1<br />price: 5710346","date: 2021 Q2<br />price: 5905880","date: 2021 Q3<br />price: 5801189","date: 2021 Q4<br />price: 5987417"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time series plot of the Real GDP for Mexico","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"tickmode":"auto","ticktext":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"tickvals":[10957,12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2000 Q1","2005 Q1","2010 Q1","2015 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"date [1Q]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f","rangeslider":{"visible":true}},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[3579951.7949999999,6273763.9050000003],"tickmode":"auto","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"GDP","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"189f73f90849":{"x":{},"y":{},"type":"scatter"}},"cur_data":"189f73f90849","visdat":{"189f73f90849":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>Our data exhibits an upward <em>linear trend</em> (with some economic cycles), and strong <em>yearly seasonality</em>.</p>
</div>
</div>
</div>
<p>We will explore it further with a season plot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">gg_season</span>(price) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a></a>  <span class="fu">ggplotly</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-886fb0820d50d65c86e3" style="width:960px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-886fb0820d50d65c86e3">{"x":{"data":[{"x":[1096,1186,1277,1369],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5],"text":["date: 1973 Q1<br />price: 3702398<br />unclass(id):  1<br />id: 1997","date: 1973 Q2<br />price: 3896084<br />unclass(id):  1<br />id: 1997","date: 1973 Q3<br />price: 3906063<br />unclass(id):  1<br />id: 1997","date: 1973 Q4<br />price: 4038358<br />unclass(id):  1<br />id: 1997"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999],"text":["date: 1973 Q1<br />price: 4084304<br />unclass(id):  2<br />id: 1998","date: 1973 Q2<br />price: 4134899<br />unclass(id):  2<br />id: 1998","date: 1973 Q3<br />price: 4138200<br />unclass(id):  2<br />id: 1998","date: 1973 Q4<br />price: 4146841<br />unclass(id):  2<br />id: 1998"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(237,129,83,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002],"text":["date: 1973 Q1<br />price: 4176243<br />unclass(id):  3<br />id: 1999","date: 1973 Q2<br />price: 4232280<br />unclass(id):  3<br />id: 1999","date: 1973 Q3<br />price: 4262621<br />unclass(id):  3<br />id: 1999","date: 1973 Q4<br />price: 4287798<br />unclass(id):  3<br />id: 1999"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(224,138,54,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998],"text":["date: 1973 Q1<br />price: 4412426<br />unclass(id):  4<br />id: 2000","date: 1973 Q2<br />price: 4465504<br />unclass(id):  4<br />id: 2000","date: 1973 Q3<br />price: 4505221<br />unclass(id):  4<br />id: 2000","date: 1973 Q4<br />price: 4428703<br />unclass(id):  4<br />id: 2000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(211,146,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004],"text":["date: 1973 Q1<br />price: 4441058<br />unclass(id):  5<br />id: 2001","date: 1973 Q2<br />price: 4468505<br />unclass(id):  5<br />id: 2001","date: 1973 Q3<br />price: 4440265<br />unclass(id):  5<br />id: 2001","date: 1973 Q4<br />price: 4381722<br />unclass(id):  5<br />id: 2001"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(191,155,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4269784.4000000004,4504199.5,4457000.9000000004,4458615],"text":["date: 1973 Q1<br />price: 4269784<br />unclass(id):  6<br />id: 2002","date: 1973 Q2<br />price: 4504200<br />unclass(id):  6<br />id: 2002","date: 1973 Q3<br />price: 4457001<br />unclass(id):  6<br />id: 2002","date: 1973 Q4<br />price: 4458615<br />unclass(id):  6<br />id: 2002"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(170,163,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4402401.5,4520666,4464786.7999999998,4511463.5999999996],"text":["date: 1973 Q1<br />price: 4402402<br />unclass(id):  7<br />id: 2003","date: 1973 Q2<br />price: 4520666<br />unclass(id):  7<br />id: 2003","date: 1973 Q3<br />price: 4464787<br />unclass(id):  7<br />id: 2003","date: 1973 Q4<br />price: 4511464<br />unclass(id):  7<br />id: 2003"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(147,170,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996],"text":["date: 1973 Q1<br />price: 4546254<br />unclass(id):  8<br />id: 2004","date: 1973 Q2<br />price: 4692565<br />unclass(id):  8<br />id: 2004","date: 1973 Q3<br />price: 4615345<br />unclass(id):  8<br />id: 2004","date: 1973 Q4<br />price: 4683344<br />unclass(id):  8<br />id: 2004"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(120,176,27,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998],"text":["date: 1973 Q1<br />price: 4567922<br />unclass(id):  9<br />id: 2005","date: 1973 Q2<br />price: 4804679<br />unclass(id):  9<br />id: 2005","date: 1973 Q3<br />price: 4720818<br />unclass(id):  9<br />id: 2005","date: 1973 Q4<br />price: 4835832<br />unclass(id):  9<br />id: 2005"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(85,181,43,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998],"text":["date: 1973 Q1<br />price: 4840643<br />unclass(id): 10<br />id: 2006","date: 1973 Q2<br />price: 5029028<br />unclass(id): 10<br />id: 2006","date: 1973 Q3<br />price: 4959002<br />unclass(id): 10<br />id: 2006","date: 1973 Q4<br />price: 5010131<br />unclass(id): 10<br />id: 2006"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002],"text":["date: 1973 Q1<br />price: 4936399<br />unclass(id): 11<br />id: 2007","date: 1973 Q2<br />price: 5127368<br />unclass(id): 11<br />id: 2007","date: 1973 Q3<br />price: 5066709<br />unclass(id): 11<br />id: 2007","date: 1973 Q4<br />price: 5120551<br />unclass(id): 11<br />id: 2007"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(25,188,94,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996],"text":["date: 1973 Q1<br />price: 4975730<br />unclass(id): 12<br />id: 2008","date: 1973 Q2<br />price: 5249626<br />unclass(id): 12<br />id: 2008","date: 1973 Q3<br />price: 5123968<br />unclass(id): 12<br />id: 2008","date: 1973 Q4<br />price: 5092737<br />unclass(id): 12<br />id: 2008"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(26,191,127,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002],"text":["date: 1973 Q1<br />price: 4634315<br />unclass(id): 13<br />id: 2009","date: 1973 Q2<br />price: 4706891<br />unclass(id): 13<br />id: 2009","date: 1973 Q3<br />price: 4823052<br />unclass(id): 13<br />id: 2009","date: 1973 Q4<br />price: 4990925<br />unclass(id): 13<br />id: 2009"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,193,159,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004],"text":["date: 1973 Q1<br />price: 4842968<br />unclass(id): 14<br />id: 2010","date: 1973 Q2<br />price: 5045140<br />unclass(id): 14<br />id: 2010","date: 1973 Q3<br />price: 5050200<br />unclass(id): 14<br />id: 2010","date: 1973 Q4<br />price: 5169143<br />unclass(id): 14<br />id: 2010"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(20,190,182,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5022838,5170733.5,5237545.4000000004,5368843.5999999996],"text":["date: 1973 Q1<br />price: 5022838<br />unclass(id): 15<br />id: 2011","date: 1973 Q2<br />price: 5170734<br />unclass(id): 15<br />id: 2011","date: 1973 Q3<br />price: 5237545<br />unclass(id): 15<br />id: 2011","date: 1973 Q4<br />price: 5368844<br />unclass(id): 15<br />id: 2011"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(20,188,204,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996],"text":["date: 1973 Q1<br />price: 5270945<br />unclass(id): 16<br />id: 2012","date: 1973 Q2<br />price: 5380528<br />unclass(id): 16<br />id: 2012","date: 1973 Q3<br />price: 5369752<br />unclass(id): 16<br />id: 2012","date: 1973 Q4<br />price: 5517802<br />unclass(id): 16<br />id: 2012"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,185,227,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004],"text":["date: 1973 Q1<br />price: 5256450<br />unclass(id): 17<br />id: 2013","date: 1973 Q2<br />price: 5473377<br />unclass(id): 17<br />id: 2013","date: 1973 Q3<br />price: 5425704<br />unclass(id): 17<br />id: 2013","date: 1973 Q4<br />price: 5567030<br />unclass(id): 17<br />id: 2013"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(58,176,236,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998],"text":["date: 1973 Q1<br />price: 5386946<br />unclass(id): 18<br />id: 2014","date: 1973 Q2<br />price: 5580039<br />unclass(id): 18<br />id: 2014","date: 1973 Q3<br />price: 5564547<br />unclass(id): 18<br />id: 2014","date: 1973 Q4<br />price: 5734911<br />unclass(id): 18<br />id: 2014"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(81,166,246,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5542388.5999999996,5710754.4000000004,5752936.5,5862074.7999999998],"text":["date: 1973 Q1<br />price: 5542389<br />unclass(id): 19<br />id: 2015","date: 1973 Q2<br />price: 5710754<br />unclass(id): 19<br />id: 2015","date: 1973 Q3<br />price: 5752936<br />unclass(id): 19<br />id: 2015","date: 1973 Q4<br />price: 5862075<br />unclass(id): 19<br />id: 2015"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5634257.7999999998,5839988.9000000004,5803635.2999999998,5995608.7000000002],"text":["date: 1973 Q1<br />price: 5634258<br />unclass(id): 20<br />id: 2016","date: 1973 Q2<br />price: 5839989<br />unclass(id): 20<br />id: 2016","date: 1973 Q3<br />price: 5803635<br />unclass(id): 20<br />id: 2016","date: 1973 Q4<br />price: 5995609<br />unclass(id): 20<br />id: 2016"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,145,254,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5826517.2999999998,5927581.7000000002,5872816.5999999996,6082191.7000000002],"text":["date: 1973 Q1<br />price: 5826517<br />unclass(id): 21<br />id: 2017","date: 1973 Q2<br />price: 5927582<br />unclass(id): 21<br />id: 2017","date: 1973 Q3<br />price: 5872817<br />unclass(id): 21<br />id: 2017","date: 1973 Q4<br />price: 6082192<br />unclass(id): 21<br />id: 2017"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(187,131,252,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5892097.5,6098933.4000000004,6034321.5999999996,6151317.9000000004],"text":["date: 1973 Q1<br />price: 5892098<br />unclass(id): 22<br />id: 2018","date: 1973 Q2<br />price: 6098933<br />unclass(id): 22<br />id: 2018","date: 1973 Q3<br />price: 6034322<br />unclass(id): 22<br />id: 2018","date: 1973 Q4<br />price: 6151318<br />unclass(id): 22<br />id: 2018"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(219,114,251,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5947648.2000000002,6038700.4000000004,6006226.4000000004,6089155.7999999998],"text":["date: 1973 Q1<br />price: 5947648<br />unclass(id): 23<br />id: 2019","date: 1973 Q2<br />price: 6038700<br />unclass(id): 23<br />id: 2019","date: 1973 Q3<br />price: 6006226<br />unclass(id): 23<br />id: 2019","date: 1973 Q4<br />price: 6089156<br />unclass(id): 23<br />id: 2019"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(233,109,232,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5862493,4813186.5,5518050.4000000004,5876204.7999999998],"text":["date: 1973 Q1<br />price: 5862493<br />unclass(id): 24<br />id: 2020","date: 1973 Q2<br />price: 4813186<br />unclass(id): 24<br />id: 2020","date: 1973 Q3<br />price: 5518050<br />unclass(id): 24<br />id: 2020","date: 1973 Q4<br />price: 5876205<br />unclass(id): 24<br />id: 2020"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(245,103,213,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1096,1186,1277,1369],"y":[5710345.7000000002,5905879.5999999996,5801188.7999999998,5987417],"text":["date: 1973 Q1<br />price: 5710346<br />unclass(id): 25<br />id: 2021","date: 1973 Q2<br />price: 5905880<br />unclass(id): 25<br />id: 2021","date: 1973 Q3<br />price: 5801189<br />unclass(id): 25<br />id: 2021","date: 1973 Q4<br />price: 5987417<br />unclass(id): 25<br />id: 2021"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,97,195,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1369],"y":[4000000],"name":"728cb4c234d4da4d5533b7393c4bb689","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F8766D"],[0.0033444816053511683,"#F7776B"],[0.0066889632107023367,"#F67869"],[0.010033444816053514,"#F57967"],[0.013377926421404682,"#F47A65"],[0.016722408026755852,"#F47A63"],[0.020066889632107027,"#F37B61"],[0.023411371237458196,"#F27C5F"],[0.026755852842809364,"#F17D5D"],[0.030100334448160532,"#F07E5B"],[0.033444816053511704,"#EF7F59"],[0.03678929765886288,"#EE7F56"],[0.040133779264214048,"#ED8054"],[0.043478260869565223,"#EC8152"],[0.046822742474916391,"#EB8250"],[0.05016722408026756,"#EA834E"],[0.053511705685618728,"#E9834C"],[0.056856187290969896,"#E88449"],[0.060200668896321065,"#E78547"],[0.06354515050167224,"#E68645"],[0.066889632107023408,"#E58642"],[0.070234113712374577,"#E48740"],[0.073578595317725759,"#E3883D"],[0.076923076923076927,"#E2883B"],[0.080267558528428096,"#E18938"],[0.083612040133779264,"#E08A36"],[0.086956521739130432,"#DF8B33"],[0.090301003344481601,"#DE8B30"],[0.093645484949832783,"#DD8C2D"],[0.096989966555183951,"#DC8D2A"],[0.10033444816053512,"#DB8D27"],[0.10367892976588629,"#DA8E24"],[0.10702341137123746,"#D98F20"],[0.11036789297658862,"#D88F1C"],[0.11371237458193979,"#D79017"],[0.11705685618729096,"#D69112"],[0.12040133779264213,"#D5910B"],[0.12374581939799333,"#D39203"],[0.12709030100334448,"#D29200"],[0.13043478260869565,"#D09300"],[0.13377926421404682,"#CF9400"],[0.13712374581939799,"#CD9500"],[0.14046822742474915,"#CC9600"],[0.14381270903010032,"#CA9600"],[0.14715719063545152,"#C99700"],[0.15050167224080269,"#C79800"],[0.15384615384615385,"#C59800"],[0.15719063545150502,"#C49900"],[0.16053511705685619,"#C29A00"],[0.16387959866220736,"#C19B00"],[0.16722408026755853,"#BF9B00"],[0.1705685618729097,"#BD9C00"],[0.17391304347826086,"#BC9D00"],[0.17725752508361203,"#BA9D00"],[0.1806020066889632,"#B89E00"],[0.18394648829431437,"#B79F00"],[0.18729096989966557,"#B59F00"],[0.19063545150501673,"#B3A000"],[0.1939799331103679,"#B2A000"],[0.19732441471571907,"#B0A100"],[0.20066889632107024,"#AEA200"],[0.20401337792642141,"#ACA200"],[0.20735785953177258,"#ABA300"],[0.21070234113712374,"#A9A300"],[0.21404682274247491,"#A7A400"],[0.21739130434782608,"#A5A500"],[0.22073578595317725,"#A4A500"],[0.22408026755852842,"#A2A600"],[0.22742474916387959,"#A0A600"],[0.23076923076923075,"#9EA700"],[0.23411371237458192,"#9CA700"],[0.23745819397993309,"#9AA800"],[0.24080267558528426,"#98A900"],[0.24414715719063548,"#96A900"],[0.24749163879598665,"#94AA00"],[0.25083612040133779,"#93AA01"],[0.25418060200668896,"#91AB03"],[0.25752508361204013,"#8EAB06"],[0.2608695652173913,"#8CAC09"],[0.26421404682274247,"#8AAC0C"],[0.26755852842809363,"#88AD0E"],[0.2709030100334448,"#86AD10"],[0.27424749163879597,"#84AE12"],[0.27759197324414714,"#82AE14"],[0.28093645484949831,"#80AE16"],[0.28428093645484948,"#7DAF18"],[0.28762541806020064,"#7BAF19"],[0.29096989966555181,"#79B01B"],[0.29431438127090304,"#76B01C"],[0.2976588628762542,"#74B11E"],[0.30100334448160537,"#71B11F"],[0.30434782608695654,"#6FB221"],[0.30769230769230771,"#6CB222"],[0.31103678929765888,"#69B223"],[0.31438127090301005,"#67B324"],[0.31772575250836121,"#64B326"],[0.32107023411371238,"#61B427"],[0.32441471571906355,"#5EB428"],[0.32775919732441472,"#5BB529"],[0.33110367892976589,"#57B52A"],[0.33444816053511706,"#54B52B"],[0.33779264214046822,"#50B62D"],[0.34113712374581939,"#4DB62E"],[0.34448160535117056,"#49B72F"],[0.34782608695652173,"#45B730"],[0.3511705685618729,"#40B731"],[0.35451505016722407,"#3BB832"],[0.35785953177257523,"#36B833"],[0.3612040133779264,"#30B834"],[0.36454849498327757,"#29B935"],[0.36789297658862874,"#21B936"],[0.37123745819397991,"#16BA37"],[0.37458193979933113,"#03BA38"],[0.3779264214046823,"#03BA3B"],[0.38127090301003347,"#07BA3E"],[0.38461538461538464,"#0ABB42"],[0.38795986622073581,"#0DBB45"],[0.39130434782608697,"#0FBB48"],[0.39464882943143814,"#11BB4B"],[0.39799331103678931,"#13BB4E"],[0.40133779264214048,"#14BB51"],[0.40468227424749165,"#16BC54"],[0.40802675585284282,"#17BC56"],[0.41137123745819398,"#18BC59"],[0.41471571906354515,"#19BC5C"],[0.41806020066889632,"#1ABC5F"],[0.42140468227424749,"#1ABD62"],[0.42474916387959866,"#1BBD64"],[0.42809364548494983,"#1BBD67"],[0.43143812709030099,"#1BBD6A"],[0.43478260869565216,"#1CBD6C"],[0.43812709030100333,"#1CBD6F"],[0.4414715719063545,"#1CBE72"],[0.44481605351170567,"#1CBE74"],[0.44816053511705684,"#1CBE77"],[0.451505016722408,"#1BBE7A"],[0.45484949832775917,"#1BBE7C"],[0.45819397993311034,"#1ABF7F"],[0.46153846153846151,"#1ABF81"],[0.46488294314381268,"#19BF84"],[0.46822742474916385,"#18BF87"],[0.47157190635451501,"#17BF89"],[0.47491638795986618,"#16C08C"],[0.47826086956521735,"#14C08E"],[0.48160535117056852,"#12C091"],[0.4849498327759198,"#10C093"],[0.48829431438127097,"#0EC096"],[0.49163879598662213,"#0AC199"],[0.4949832775919733,"#06C19B"],[0.49832775919732447,"#02C19E"],[0.50167224080267558,"#01C1A0"],[0.50501672240802675,"#04C1A2"],[0.50836120401337792,"#06C0A4"],[0.51170568561872909,"#09C0A5"],[0.51505016722408026,"#0BC0A7"],[0.51839464882943143,"#0DC0A9"],[0.52173913043478259,"#0EC0AB"],[0.52508361204013376,"#0FBFAD"],[0.52842809364548493,"#11BFAF"],[0.5317725752508361,"#12BFB0"],[0.53511705685618727,"#13BFB2"],[0.53846153846153844,"#13BFB4"],[0.5418060200668896,"#14BEB6"],[0.54515050167224077,"#15BEB8"],[0.54849498327759194,"#15BEB9"],[0.55183946488294311,"#15BEBB"],[0.55518394648829428,"#16BEBD"],[0.55852842809364545,"#16BDBF"],[0.56187290969899661,"#16BDC1"],[0.56521739130434778,"#16BDC2"],[0.56856187290969895,"#16BDC4"],[0.57190635451505012,"#16BCC6"],[0.57525083612040129,"#15BCC8"],[0.57859531772575246,"#15BCCA"],[0.58193979933110362,"#15BCCC"],[0.58528428093645479,"#14BCCD"],[0.58862876254180607,"#13BBCF"],[0.59197324414715724,"#13BBD1"],[0.59531772575250841,"#12BBD3"],[0.59866220735785958,"#11BBD5"],[0.60200668896321075,"#0FBBD6"],[0.60535117056856191,"#0EBAD8"],[0.60869565217391308,"#0CBADA"],[0.61204013377926425,"#0ABADC"],[0.61538461538461542,"#08BADE"],[0.61872909698996659,"#05B9E0"],[0.62207357859531776,"#03B9E1"],[0.62541806020066881,"#01B9E3"],[0.62876254180602009,"#0DB8E4"],[0.63210702341137137,"#15B7E5"],[0.63545150501672243,"#1BB7E5"],[0.63879598662207349,"#20B6E6"],[0.64214046822742477,"#24B5E7"],[0.64548494983277604,"#28B4E8"],[0.6488294314381271,"#2BB4E8"],[0.65217391304347816,"#2EB3E9"],[0.65551839464882944,"#31B2EA"],[0.65886287625418072,"#34B1EB"],[0.66220735785953178,"#37B1EB"],[0.66555183946488283,"#39B0EC"],[0.66889632107023411,"#3BAFED"],[0.67224080267558539,"#3EAEEE"],[0.67558528428093645,"#40AEEE"],[0.67892976588628773,"#42ADEF"],[0.68227424749163879,"#44ACF0"],[0.68561872909699006,"#46ABF1"],[0.68896321070234112,"#47ABF1"],[0.6923076923076924,"#49AAF2"],[0.69565217391304346,"#4BA9F3"],[0.69899665551839474,"#4CA8F4"],[0.7023411371237458,"#4EA8F4"],[0.70568561872909707,"#50A7F5"],[0.70903010033444813,"#51A6F6"],[0.71237458193979941,"#53A5F7"],[0.71571906354515047,"#54A4F7"],[0.71906354515050175,"#55A4F8"],[0.72240802675585281,"#57A3F9"],[0.72575250836120409,"#58A2FA"],[0.72909698996655514,"#59A1FA"],[0.73244147157190642,"#5BA0FB"],[0.73578595317725748,"#5CA0FC"],[0.73913043478260876,"#5D9FFD"],[0.74247491638795982,"#5E9EFD"],[0.7458193979933111,"#609DFE"],[0.74916387959866226,"#619CFF"],[0.75250836120401343,"#659BFF"],[0.7558528428093646,"#6A9BFF"],[0.75919732441471577,"#6F9AFF"],[0.76254180602006694,"#7399FF"],[0.76588628762541811,"#7798FE"],[0.76923076923076927,"#7C97FE"],[0.77257525083612044,"#8096FE"],[0.77591973244147161,"#8495FE"],[0.77926421404682278,"#8794FE"],[0.78260869565217395,"#8B94FE"],[0.78595317725752512,"#8F93FE"],[0.78929765886287628,"#9292FE"],[0.79264214046822745,"#9691FE"],[0.79598662207357862,"#9990FD"],[0.79933110367892979,"#9C8FFD"],[0.80267558528428096,"#9F8EFD"],[0.80602006688963213,"#A38DFD"],[0.80936454849498329,"#A68CFD"],[0.81270903010033446,"#A98AFD"],[0.81605351170568563,"#AC89FD"],[0.8193979933110368,"#AF88FD"],[0.82274247491638797,"#B287FD"],[0.82608695652173914,"#B486FD"],[0.8294314381270903,"#B785FC"],[0.83277591973244147,"#BA84FC"],[0.83612040133779264,"#BD82FC"],[0.83946488294314381,"#C081FC"],[0.84280936454849498,"#C280FC"],[0.84615384615384615,"#C57EFC"],[0.84949832775919731,"#C87DFC"],[0.85284280936454848,"#CA7CFC"],[0.85618729096989965,"#CD7AFC"],[0.85953177257525093,"#CF79FB"],[0.86287625418060199,"#D278FB"],[0.86622073578595327,"#D476FB"],[0.86956521739130432,"#D775FB"],[0.8729096989966556,"#D973FB"],[0.87625418060200666,"#DB72FA"],[0.87959866220735794,"#DD71F9"],[0.882943143812709,"#DE71F7"],[0.88628762541806028,"#DF71F6"],[0.88963210702341133,"#E070F4"],[0.89297658862876261,"#E170F3"],[0.89632107023411367,"#E26FF1"],[0.89966555183946495,"#E36FF0"],[0.90301003344481601,"#E56EEE"],[0.90635451505016729,"#E66EED"],[0.90969899665551834,"#E76DEB"],[0.91304347826086962,"#E86DEA"],[0.91638795986622068,"#E96DE8"],[0.91973244147157196,"#EA6CE7"],[0.92307692307692302,"#EB6CE5"],[0.9264214046822743,"#EC6BE4"],[0.92976588628762535,"#ED6BE2"],[0.93311036789297663,"#EE6AE1"],[0.93645484949832769,"#EF6ADF"],[0.93979933110367897,"#F069DE"],[0.94314381270903003,"#F169DC"],[0.94648829431438131,"#F168DB"],[0.94983277591973236,"#F268D9"],[0.95317725752508364,"#F368D8"],[0.9565217391304347,"#F467D6"],[0.95986622073578598,"#F567D5"],[0.96321070234113704,"#F666D3"],[0.96655518394648832,"#F766D2"],[0.9698996655518396,"#F865D0"],[0.97324414715719065,"#F965CF"],[0.97658862876254193,"#F964CD"],[0.97993311036789299,"#FA64CC"],[0.98327759197324427,"#FB63CA"],[0.98662207357859533,"#FC63C9"],[0.98996655518394661,"#FD62C7"],[0.99331103678929766,"#FD62C6"],[0.99665551839464894,"#FE61C4"],[1,"#FF61C3"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["2001","2006","2011","2016","2021"],"tickvals":[0.16777777777777778,0.37541666666666662,0.58305555555555555,0.79069444444444437,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":66.484018264840202},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1082.3499999999999,1382.6500000000001],"tickmode":"array","ticktext":["Q4","Q1","Q2","Q3"],"tickvals":[1369,1096,1186,1277],"categoryorder":"array","categoryarray":["Q4","Q1","Q2","Q3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.7949999999,6273763.9050000003],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"189f1d6da0a5":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"189f1d6da0a5","visdat":{"189f1d6da0a5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<h3 id="ts-decomposition">TS Decomposition</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(price, <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a></a>  <span class="fu">autoplot</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a></a>  <span class="fu">ggplotly</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5a9fa37e86ad805a00e1" style="width:960px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-5a9fa37e86ad805a00e1">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[3702397.7999999998,3896083.8999999999,3906063,4038358.5,4084303.5,4134899.3999999999,4138199.7999999998,4146841.3999999999,4176243.2999999998,4232279.5,4262620.5999999996,4287797.7000000002,4412426.2999999998,4465504.2000000002,4505221.0999999996,4428702.7999999998,4441058.2000000002,4468504.7999999998,4440265,4381722.4000000004,4269784.4000000004,4504199.5,4457000.9000000004,4458615,4402401.5,4520666,4464786.7999999998,4511463.5999999996,4546253.9000000004,4692565.0999999996,4615345,4683343.5999999996,4567922.0999999996,4804678.7999999998,4720817.7000000002,4835832.2999999998,4840642.7000000002,5029028.2000000002,4959002.2000000002,5010130.7999999998,4936399.2999999998,5127368,5066708.7999999998,5120551.2000000002,4975730.4000000004,5249626,5123968.2000000002,5092737.0999999996,4634314.7999999998,4706890.7999999998,4823052.4000000004,4990924.7000000002,4842967.7000000002,5045140.2999999998,5050199.5,5169143.4000000004,5022838,5170733.5,5237545.4000000004,5368843.5999999996,5270945.0999999996,5380528.2000000002,5369752.0999999996,5517801.5999999996,5256450.2999999998,5473377.0999999996,5425704.0999999996,5567029.9000000004,5386945.5999999996,5580039,5564547.0999999996,5734911.2999999998,5542388.5999999996,5710754.4000000004,5752936.5,5862074.7999999998,5634257.7999999998,5839988.9000000004,5803635.2999999998,5995608.7000000002,5826517.2999999998,5927581.7000000002,5872816.5999999996,6082191.7000000002,5892097.5,6098933.4000000004,6034321.5999999996,6151317.9000000004,5947648.2000000002,6038700.4000000004,6006226.4000000004,6089155.7999999998,5862493,4813186.5,5518050.4000000004,5876204.7999999998,5710345.7000000002,5905879.5999999996,5801188.7999999998,5987417],"text":["date: 1997 Q1<br />.val: 3702397.80000","date: 1997 Q2<br />.val: 3896083.90000","date: 1997 Q3<br />.val: 3906063.00000","date: 1997 Q4<br />.val: 4038358.50000","date: 1998 Q1<br />.val: 4084303.50000","date: 1998 Q2<br />.val: 4134899.40000","date: 1998 Q3<br />.val: 4138199.80000","date: 1998 Q4<br />.val: 4146841.40000","date: 1999 Q1<br />.val: 4176243.30000","date: 1999 Q2<br />.val: 4232279.50000","date: 1999 Q3<br />.val: 4262620.60000","date: 1999 Q4<br />.val: 4287797.70000","date: 2000 Q1<br />.val: 4412426.30000","date: 2000 Q2<br />.val: 4465504.20000","date: 2000 Q3<br />.val: 4505221.10000","date: 2000 Q4<br />.val: 4428702.80000","date: 2001 Q1<br />.val: 4441058.20000","date: 2001 Q2<br />.val: 4468504.80000","date: 2001 Q3<br />.val: 4440265.00000","date: 2001 Q4<br />.val: 4381722.40000","date: 2002 Q1<br />.val: 4269784.40000","date: 2002 Q2<br />.val: 4504199.50000","date: 2002 Q3<br />.val: 4457000.90000","date: 2002 Q4<br />.val: 4458615.00000","date: 2003 Q1<br />.val: 4402401.50000","date: 2003 Q2<br />.val: 4520666.00000","date: 2003 Q3<br />.val: 4464786.80000","date: 2003 Q4<br />.val: 4511463.60000","date: 2004 Q1<br />.val: 4546253.90000","date: 2004 Q2<br />.val: 4692565.10000","date: 2004 Q3<br />.val: 4615345.00000","date: 2004 Q4<br />.val: 4683343.60000","date: 2005 Q1<br />.val: 4567922.10000","date: 2005 Q2<br />.val: 4804678.80000","date: 2005 Q3<br />.val: 4720817.70000","date: 2005 Q4<br />.val: 4835832.30000","date: 2006 Q1<br />.val: 4840642.70000","date: 2006 Q2<br />.val: 5029028.20000","date: 2006 Q3<br />.val: 4959002.20000","date: 2006 Q4<br />.val: 5010130.80000","date: 2007 Q1<br />.val: 4936399.30000","date: 2007 Q2<br />.val: 5127368.00000","date: 2007 Q3<br />.val: 5066708.80000","date: 2007 Q4<br />.val: 5120551.20000","date: 2008 Q1<br />.val: 4975730.40000","date: 2008 Q2<br />.val: 5249626.00000","date: 2008 Q3<br />.val: 5123968.20000","date: 2008 Q4<br />.val: 5092737.10000","date: 2009 Q1<br />.val: 4634314.80000","date: 2009 Q2<br />.val: 4706890.80000","date: 2009 Q3<br />.val: 4823052.40000","date: 2009 Q4<br />.val: 4990924.70000","date: 2010 Q1<br />.val: 4842967.70000","date: 2010 Q2<br />.val: 5045140.30000","date: 2010 Q3<br />.val: 5050199.50000","date: 2010 Q4<br />.val: 5169143.40000","date: 2011 Q1<br />.val: 5022838.00000","date: 2011 Q2<br />.val: 5170733.50000","date: 2011 Q3<br />.val: 5237545.40000","date: 2011 Q4<br />.val: 5368843.60000","date: 2012 Q1<br />.val: 5270945.10000","date: 2012 Q2<br />.val: 5380528.20000","date: 2012 Q3<br />.val: 5369752.10000","date: 2012 Q4<br />.val: 5517801.60000","date: 2013 Q1<br />.val: 5256450.30000","date: 2013 Q2<br />.val: 5473377.10000","date: 2013 Q3<br />.val: 5425704.10000","date: 2013 Q4<br />.val: 5567029.90000","date: 2014 Q1<br />.val: 5386945.60000","date: 2014 Q2<br />.val: 5580039.00000","date: 2014 Q3<br />.val: 5564547.10000","date: 2014 Q4<br />.val: 5734911.30000","date: 2015 Q1<br />.val: 5542388.60000","date: 2015 Q2<br />.val: 5710754.40000","date: 2015 Q3<br />.val: 5752936.50000","date: 2015 Q4<br />.val: 5862074.80000","date: 2016 Q1<br />.val: 5634257.80000","date: 2016 Q2<br />.val: 5839988.90000","date: 2016 Q3<br />.val: 5803635.30000","date: 2016 Q4<br />.val: 5995608.70000","date: 2017 Q1<br />.val: 5826517.30000","date: 2017 Q2<br />.val: 5927581.70000","date: 2017 Q3<br />.val: 5872816.60000","date: 2017 Q4<br />.val: 6082191.70000","date: 2018 Q1<br />.val: 5892097.50000","date: 2018 Q2<br />.val: 6098933.40000","date: 2018 Q3<br />.val: 6034321.60000","date: 2018 Q4<br />.val: 6151317.90000","date: 2019 Q1<br />.val: 5947648.20000","date: 2019 Q2<br />.val: 6038700.40000","date: 2019 Q3<br />.val: 6006226.40000","date: 2019 Q4<br />.val: 6089155.80000","date: 2020 Q1<br />.val: 5862493.00000","date: 2020 Q2<br />.val: 4813186.50000","date: 2020 Q3<br />.val: 5518050.40000","date: 2020 Q4<br />.val: 5876204.80000","date: 2021 Q1<br />.val: 5710345.70000","date: 2021 Q2<br />.val: 5905879.60000","date: 2021 Q3<br />.val: 5801188.80000","date: 2021 Q4<br />.val: 5987417.00000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[3750277.751939076,3826573.7799810977,3898124.6232522991,3962836.2584946137,4021887.87496805,4081386.7598268935,4127891.8013668009,4170644.3418177087,4204768.1199042071,4237915.6875413302,4270698.3500632476,4310158.4862134624,4357556.6873143176,4393589.4527601767,4427030.1044165092,4442210.3889354449,4445935.8189824354,4438485.7176945917,4423109.713904148,4424533.2422330258,4431645.7800118746,4442793.9218198815,4457840.7563985987,4458419.6944755139,4459604.0420830166,4466260.6189412316,4490723.4220545832,4531956.9912897646,4574042.8918204606,4613334.9942410039,4645508.4767678259,4673674.3947304469,4701324.7289461913,4732005.9438315351,4770992.2913355259,4829803.8748427359,4889171.4686469967,4938869.7998338426,4971754.8386639124,4995662.2183176419,5021479.7084776359,5048635.6902256431,5067700.017162201,5074975.5802896917,5066632.6657904629,5058319.6270956472,5049093.7122253235,5041253.3315310515,4971394.6601097332,4919993.1336888392,4838611.7044349127,4899874.7763518551,4954309.3832409885,5003302.9439188438,5048501.5021395953,5092976.189101995,5137677.7343873559,5185882.605272132,5233611.0725383377,5276465.7800809611,5311652.636792399,5345843.1383400727,5377027.0838324577,5396190.4777786741,5414549.0067292452,5427189.7682391666,5447138.1497918377,5474895.0975726582,5507428.2043138565,5546152.7964611817,5585591.2852806933,5622190.4232335053,5654780.8379114717,5685410.0677977912,5712187.8237519395,5739580.648517685,5770219.5041100141,5801296.8831929564,5838985.1330922171,5865217.0100404834,5883570.2187071517,5902119.3199693607,5924991.9575558556,5965412.364252042,6007007.4238682855,6034069.2056099335,6049442.6771399919,6049776.7110287892,6038586.5108023696,6027113.7255310751,6007752.7506396202,5987009.5272055427,5822409.4589236844,5687723.8689827193,5541819.101507687,5541819.101507687,5683265.3383388957,5750777.6345480736,5818039.3866713867,5883695.1218584627],"text":["date: 1997 Q1<br />.val: 3750277.75194","date: 1997 Q2<br />.val: 3826573.77998","date: 1997 Q3<br />.val: 3898124.62325","date: 1997 Q4<br />.val: 3962836.25849","date: 1998 Q1<br />.val: 4021887.87497","date: 1998 Q2<br />.val: 4081386.75983","date: 1998 Q3<br />.val: 4127891.80137","date: 1998 Q4<br />.val: 4170644.34182","date: 1999 Q1<br />.val: 4204768.11990","date: 1999 Q2<br />.val: 4237915.68754","date: 1999 Q3<br />.val: 4270698.35006","date: 1999 Q4<br />.val: 4310158.48621","date: 2000 Q1<br />.val: 4357556.68731","date: 2000 Q2<br />.val: 4393589.45276","date: 2000 Q3<br />.val: 4427030.10442","date: 2000 Q4<br />.val: 4442210.38894","date: 2001 Q1<br />.val: 4445935.81898","date: 2001 Q2<br />.val: 4438485.71769","date: 2001 Q3<br />.val: 4423109.71390","date: 2001 Q4<br />.val: 4424533.24223","date: 2002 Q1<br />.val: 4431645.78001","date: 2002 Q2<br />.val: 4442793.92182","date: 2002 Q3<br />.val: 4457840.75640","date: 2002 Q4<br />.val: 4458419.69448","date: 2003 Q1<br />.val: 4459604.04208","date: 2003 Q2<br />.val: 4466260.61894","date: 2003 Q3<br />.val: 4490723.42205","date: 2003 Q4<br />.val: 4531956.99129","date: 2004 Q1<br />.val: 4574042.89182","date: 2004 Q2<br />.val: 4613334.99424","date: 2004 Q3<br />.val: 4645508.47677","date: 2004 Q4<br />.val: 4673674.39473","date: 2005 Q1<br />.val: 4701324.72895","date: 2005 Q2<br />.val: 4732005.94383","date: 2005 Q3<br />.val: 4770992.29134","date: 2005 Q4<br />.val: 4829803.87484","date: 2006 Q1<br />.val: 4889171.46865","date: 2006 Q2<br />.val: 4938869.79983","date: 2006 Q3<br />.val: 4971754.83866","date: 2006 Q4<br />.val: 4995662.21832","date: 2007 Q1<br />.val: 5021479.70848","date: 2007 Q2<br />.val: 5048635.69023","date: 2007 Q3<br />.val: 5067700.01716","date: 2007 Q4<br />.val: 5074975.58029","date: 2008 Q1<br />.val: 5066632.66579","date: 2008 Q2<br />.val: 5058319.62710","date: 2008 Q3<br />.val: 5049093.71223","date: 2008 Q4<br />.val: 5041253.33153","date: 2009 Q1<br />.val: 4971394.66011","date: 2009 Q2<br />.val: 4919993.13369","date: 2009 Q3<br />.val: 4838611.70443","date: 2009 Q4<br />.val: 4899874.77635","date: 2010 Q1<br />.val: 4954309.38324","date: 2010 Q2<br />.val: 5003302.94392","date: 2010 Q3<br />.val: 5048501.50214","date: 2010 Q4<br />.val: 5092976.18910","date: 2011 Q1<br />.val: 5137677.73439","date: 2011 Q2<br />.val: 5185882.60527","date: 2011 Q3<br />.val: 5233611.07254","date: 2011 Q4<br />.val: 5276465.78008","date: 2012 Q1<br />.val: 5311652.63679","date: 2012 Q2<br />.val: 5345843.13834","date: 2012 Q3<br />.val: 5377027.08383","date: 2012 Q4<br />.val: 5396190.47778","date: 2013 Q1<br />.val: 5414549.00673","date: 2013 Q2<br />.val: 5427189.76824","date: 2013 Q3<br />.val: 5447138.14979","date: 2013 Q4<br />.val: 5474895.09757","date: 2014 Q1<br />.val: 5507428.20431","date: 2014 Q2<br />.val: 5546152.79646","date: 2014 Q3<br />.val: 5585591.28528","date: 2014 Q4<br />.val: 5622190.42323","date: 2015 Q1<br />.val: 5654780.83791","date: 2015 Q2<br />.val: 5685410.06780","date: 2015 Q3<br />.val: 5712187.82375","date: 2015 Q4<br />.val: 5739580.64852","date: 2016 Q1<br />.val: 5770219.50411","date: 2016 Q2<br />.val: 5801296.88319","date: 2016 Q3<br />.val: 5838985.13309","date: 2016 Q4<br />.val: 5865217.01004","date: 2017 Q1<br />.val: 5883570.21871","date: 2017 Q2<br />.val: 5902119.31997","date: 2017 Q3<br />.val: 5924991.95756","date: 2017 Q4<br />.val: 5965412.36425","date: 2018 Q1<br />.val: 6007007.42387","date: 2018 Q2<br />.val: 6034069.20561","date: 2018 Q3<br />.val: 6049442.67714","date: 2018 Q4<br />.val: 6049776.71103","date: 2019 Q1<br />.val: 6038586.51080","date: 2019 Q2<br />.val: 6027113.72553","date: 2019 Q3<br />.val: 6007752.75064","date: 2019 Q4<br />.val: 5987009.52721","date: 2020 Q1<br />.val: 5822409.45892","date: 2020 Q2<br />.val: 5687723.86898","date: 2020 Q3<br />.val: 5541819.10151","date: 2020 Q4<br />.val: 5541819.10151","date: 2021 Q1<br />.val: 5683265.33834","date: 2021 Q2<br />.val: 5750777.63455","date: 2021 Q3<br />.val: 5818039.38667","date: 2021 Q4<br />.val: 5883695.12186"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-35686.57266432426,58152.984279770186,-2912.3006421598889,-19485.609608561652,-35606.570806754426,58299.780589752947,-3765.1883375663324,-18846.987090476032,-35547.320111621098,58401.662372156919,-4678.8505318785219,-18258.237386338173,-34829.375429332118,58657.709068337645,-6966.594607718409,-16989.375838854819,-33984.819684569455,59105.748754724918,-8969.6929894628884,-15383.345679564425,-36015.444400731692,61785.047788534735,-13342.408641171944,-10603.657916800315,-38238.829340235818,64625.128563809092,-17132.851801958735,-5043.299476822096,-47831.496400712844,69048.719472372308,-18829.717612607339,4363.6390495340856,-58566.478523227597,72639.794539148992,-21001.705369711581,13472.980076397176,-68365.908545147482,72053.169295804808,-20073.274159192239,24804.362168052714,-78933.681878653078,71187.958073857109,-18754.930799042551,37167.022005560138,-89044.073613861285,62127.687981557887,-13703.936492754769,51483.768468948205,-99075.308039810203,52978.762385360584,-8624.9172671056313,66185.524510286195,-107974.58768689753,45305.82039018409,-7991.1542145876774,79556.441601689236,-115818.70865240335,37808.576803766213,-8193.1026617145762,91260.24952128547,-119704.50745735693,36068.657761540373,-11146.144270328183,98929.048371032826,-123516.47890178791,34404.296326791286,-14283.608829999846,106208.95501197502,-124221.24806266722,34376.313395094352,-19607.255894582675,110267.19215421038,-124168.55868503312,34708.051019694722,-25134.720486044014,113608.8157101356,-121257.48249760186,32935.029225460086,-25243.908741591826,112231.94452671238,-118307.93633362545,31446.883109434122,-24952.1504864456,111277.13343296472,-117441.65183379159,30973.668702665076,-24492.279850543742,110431.8546439057,-116558.64955734105,30506.954265931228,-24011.564696193269,109622.39606724936,-115899.40511570244,30209.461333025669,-23768.701507686979,109083.04408845534,-115258.74741136825,29900.029088175361,-23522.775170102737,108560.65564476805],"text":["date: 1997 Q1<br />.val:  -35686.57266","date: 1997 Q2<br />.val:   58152.98428","date: 1997 Q3<br />.val:   -2912.30064","date: 1997 Q4<br />.val:  -19485.60961","date: 1998 Q1<br />.val:  -35606.57081","date: 1998 Q2<br />.val:   58299.78059","date: 1998 Q3<br />.val:   -3765.18834","date: 1998 Q4<br />.val:  -18846.98709","date: 1999 Q1<br />.val:  -35547.32011","date: 1999 Q2<br />.val:   58401.66237","date: 1999 Q3<br />.val:   -4678.85053","date: 1999 Q4<br />.val:  -18258.23739","date: 2000 Q1<br />.val:  -34829.37543","date: 2000 Q2<br />.val:   58657.70907","date: 2000 Q3<br />.val:   -6966.59461","date: 2000 Q4<br />.val:  -16989.37584","date: 2001 Q1<br />.val:  -33984.81968","date: 2001 Q2<br />.val:   59105.74875","date: 2001 Q3<br />.val:   -8969.69299","date: 2001 Q4<br />.val:  -15383.34568","date: 2002 Q1<br />.val:  -36015.44440","date: 2002 Q2<br />.val:   61785.04779","date: 2002 Q3<br />.val:  -13342.40864","date: 2002 Q4<br />.val:  -10603.65792","date: 2003 Q1<br />.val:  -38238.82934","date: 2003 Q2<br />.val:   64625.12856","date: 2003 Q3<br />.val:  -17132.85180","date: 2003 Q4<br />.val:   -5043.29948","date: 2004 Q1<br />.val:  -47831.49640","date: 2004 Q2<br />.val:   69048.71947","date: 2004 Q3<br />.val:  -18829.71761","date: 2004 Q4<br />.val:    4363.63905","date: 2005 Q1<br />.val:  -58566.47852","date: 2005 Q2<br />.val:   72639.79454","date: 2005 Q3<br />.val:  -21001.70537","date: 2005 Q4<br />.val:   13472.98008","date: 2006 Q1<br />.val:  -68365.90855","date: 2006 Q2<br />.val:   72053.16930","date: 2006 Q3<br />.val:  -20073.27416","date: 2006 Q4<br />.val:   24804.36217","date: 2007 Q1<br />.val:  -78933.68188","date: 2007 Q2<br />.val:   71187.95807","date: 2007 Q3<br />.val:  -18754.93080","date: 2007 Q4<br />.val:   37167.02201","date: 2008 Q1<br />.val:  -89044.07361","date: 2008 Q2<br />.val:   62127.68798","date: 2008 Q3<br />.val:  -13703.93649","date: 2008 Q4<br />.val:   51483.76847","date: 2009 Q1<br />.val:  -99075.30804","date: 2009 Q2<br />.val:   52978.76239","date: 2009 Q3<br />.val:   -8624.91727","date: 2009 Q4<br />.val:   66185.52451","date: 2010 Q1<br />.val: -107974.58769","date: 2010 Q2<br />.val:   45305.82039","date: 2010 Q3<br />.val:   -7991.15421","date: 2010 Q4<br />.val:   79556.44160","date: 2011 Q1<br />.val: -115818.70865","date: 2011 Q2<br />.val:   37808.57680","date: 2011 Q3<br />.val:   -8193.10266","date: 2011 Q4<br />.val:   91260.24952","date: 2012 Q1<br />.val: -119704.50746","date: 2012 Q2<br />.val:   36068.65776","date: 2012 Q3<br />.val:  -11146.14427","date: 2012 Q4<br />.val:   98929.04837","date: 2013 Q1<br />.val: -123516.47890","date: 2013 Q2<br />.val:   34404.29633","date: 2013 Q3<br />.val:  -14283.60883","date: 2013 Q4<br />.val:  106208.95501","date: 2014 Q1<br />.val: -124221.24806","date: 2014 Q2<br />.val:   34376.31340","date: 2014 Q3<br />.val:  -19607.25589","date: 2014 Q4<br />.val:  110267.19215","date: 2015 Q1<br />.val: -124168.55869","date: 2015 Q2<br />.val:   34708.05102","date: 2015 Q3<br />.val:  -25134.72049","date: 2015 Q4<br />.val:  113608.81571","date: 2016 Q1<br />.val: -121257.48250","date: 2016 Q2<br />.val:   32935.02923","date: 2016 Q3<br />.val:  -25243.90874","date: 2016 Q4<br />.val:  112231.94453","date: 2017 Q1<br />.val: -118307.93633","date: 2017 Q2<br />.val:   31446.88311","date: 2017 Q3<br />.val:  -24952.15049","date: 2017 Q4<br />.val:  111277.13343","date: 2018 Q1<br />.val: -117441.65183","date: 2018 Q2<br />.val:   30973.66870","date: 2018 Q3<br />.val:  -24492.27985","date: 2018 Q4<br />.val:  110431.85464","date: 2019 Q1<br />.val: -116558.64956","date: 2019 Q2<br />.val:   30506.95427","date: 2019 Q3<br />.val:  -24011.56470","date: 2019 Q4<br />.val:  109622.39607","date: 2020 Q1<br />.val: -115899.40512","date: 2020 Q2<br />.val:   30209.46133","date: 2020 Q3<br />.val:  -23768.70151","date: 2020 Q4<br />.val:  109083.04409","date: 2021 Q1<br />.val: -115258.74741","date: 2021 Q2<br />.val:   29900.02909","date: 2021 Q3<br />.val:  -23522.77517","date: 2021 Q4<br />.val:  108560.65564"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-12193.379274751991,11357.135739131831,10850.677389860619,95007.85111394804,98022.19583870424,-4787.1404166463763,14073.186970765237,-4955.9547272329219,7022.5002074139193,-64037.849913487211,-3398.8995313690975,-4102.5488271238282,89698.988115014508,13257.038171485998,85157.590191208757,3481.7869034102187,29107.20070213452,-29086.666449316777,26124.979085315019,-27427.496553461067,-125845.93561114278,-379.46960841584951,12502.552242573351,10798.963441286236,-18963.712742780335,-10219.747505040839,-8803.7702526245266,-15450.091812943108,20042.504580252804,10181.386286623776,-11333.759155218489,5305.5662200190127,-74836.150422964245,33.061629315838218,-29172.885965813883,-7444.5549191329628,19837.139898151159,18105.230870353058,7320.6354952799156,-10335.780485695228,-6146.7265989826992,7544.3517004996538,17763.713636841625,8408.5977047486231,-1858.1921766009182,129178.68492279481,88578.424267431721,0,-238004.55206992291,-266081.09607420024,-6934.3871678067371,24864.399137859233,-3367.0955540910363,-3468.4643090283498,9689.1520749926567,-3389.23070368357,978.97426504734904,-52957.682075898163,12127.430123377591,1117.5703977532685,78996.970664957538,-1383.596101612784,3871.1604378698394,22682.073850292712,-34582.227827457711,11783.035434042104,-7150.4409618377686,-14074.152584632859,3738.6437488105148,-490.10985627584159,-1436.9293861109763,2453.6846122844145,11776.320773560554,-9363.7188174854964,65883.396734104492,8885.3357721790671,-14704.221612412483,5756.9875815836713,-10105.924350625835,18159.745432804339,61255.01762647368,-5984.5030787950382,-27223.207069410011,5502.2023149933666,2531.7279655057937,33890.525687402114,9371.2027105512097,-8890.6656726943329,25620.338754971512,-18920.279797006398,22485.214056573808,-7476.1232727924362,155982.94619201776,-904746.8303157445,0,225302.65440385789,142339.1090724729,125201.93636375107,6672.1884987158701,-4838.777503230609],"text":["date: 1997 Q1<br />.val:  -12193.37927","date: 1997 Q2<br />.val:   11357.13574","date: 1997 Q3<br />.val:   10850.67739","date: 1997 Q4<br />.val:   95007.85111","date: 1998 Q1<br />.val:   98022.19584","date: 1998 Q2<br />.val:   -4787.14042","date: 1998 Q3<br />.val:   14073.18697","date: 1998 Q4<br />.val:   -4955.95473","date: 1999 Q1<br />.val:    7022.50021","date: 1999 Q2<br />.val:  -64037.84991","date: 1999 Q3<br />.val:   -3398.89953","date: 1999 Q4<br />.val:   -4102.54883","date: 2000 Q1<br />.val:   89698.98812","date: 2000 Q2<br />.val:   13257.03817","date: 2000 Q3<br />.val:   85157.59019","date: 2000 Q4<br />.val:    3481.78690","date: 2001 Q1<br />.val:   29107.20070","date: 2001 Q2<br />.val:  -29086.66645","date: 2001 Q3<br />.val:   26124.97909","date: 2001 Q4<br />.val:  -27427.49655","date: 2002 Q1<br />.val: -125845.93561","date: 2002 Q2<br />.val:    -379.46961","date: 2002 Q3<br />.val:   12502.55224","date: 2002 Q4<br />.val:   10798.96344","date: 2003 Q1<br />.val:  -18963.71274","date: 2003 Q2<br />.val:  -10219.74751","date: 2003 Q3<br />.val:   -8803.77025","date: 2003 Q4<br />.val:  -15450.09181","date: 2004 Q1<br />.val:   20042.50458","date: 2004 Q2<br />.val:   10181.38629","date: 2004 Q3<br />.val:  -11333.75916","date: 2004 Q4<br />.val:    5305.56622","date: 2005 Q1<br />.val:  -74836.15042","date: 2005 Q2<br />.val:      33.06163","date: 2005 Q3<br />.val:  -29172.88597","date: 2005 Q4<br />.val:   -7444.55492","date: 2006 Q1<br />.val:   19837.13990","date: 2006 Q2<br />.val:   18105.23087","date: 2006 Q3<br />.val:    7320.63550","date: 2006 Q4<br />.val:  -10335.78049","date: 2007 Q1<br />.val:   -6146.72660","date: 2007 Q2<br />.val:    7544.35170","date: 2007 Q3<br />.val:   17763.71364","date: 2007 Q4<br />.val:    8408.59770","date: 2008 Q1<br />.val:   -1858.19218","date: 2008 Q2<br />.val:  129178.68492","date: 2008 Q3<br />.val:   88578.42427","date: 2008 Q4<br />.val:       0.00000","date: 2009 Q1<br />.val: -238004.55207","date: 2009 Q2<br />.val: -266081.09607","date: 2009 Q3<br />.val:   -6934.38717","date: 2009 Q4<br />.val:   24864.39914","date: 2010 Q1<br />.val:   -3367.09555","date: 2010 Q2<br />.val:   -3468.46431","date: 2010 Q3<br />.val:    9689.15207","date: 2010 Q4<br />.val:   -3389.23070","date: 2011 Q1<br />.val:     978.97427","date: 2011 Q2<br />.val:  -52957.68208","date: 2011 Q3<br />.val:   12127.43012","date: 2011 Q4<br />.val:    1117.57040","date: 2012 Q1<br />.val:   78996.97066","date: 2012 Q2<br />.val:   -1383.59610","date: 2012 Q3<br />.val:    3871.16044","date: 2012 Q4<br />.val:   22682.07385","date: 2013 Q1<br />.val:  -34582.22783","date: 2013 Q2<br />.val:   11783.03543","date: 2013 Q3<br />.val:   -7150.44096","date: 2013 Q4<br />.val:  -14074.15258","date: 2014 Q1<br />.val:    3738.64375","date: 2014 Q2<br />.val:    -490.10986","date: 2014 Q3<br />.val:   -1436.92939","date: 2014 Q4<br />.val:    2453.68461","date: 2015 Q1<br />.val:   11776.32077","date: 2015 Q2<br />.val:   -9363.71882","date: 2015 Q3<br />.val:   65883.39673","date: 2015 Q4<br />.val:    8885.33577","date: 2016 Q1<br />.val:  -14704.22161","date: 2016 Q2<br />.val:    5756.98758","date: 2016 Q3<br />.val:  -10105.92435","date: 2016 Q4<br />.val:   18159.74543","date: 2017 Q1<br />.val:   61255.01763","date: 2017 Q2<br />.val:   -5984.50308","date: 2017 Q3<br />.val:  -27223.20707","date: 2017 Q4<br />.val:    5502.20231","date: 2018 Q1<br />.val:    2531.72797","date: 2018 Q2<br />.val:   33890.52569","date: 2018 Q3<br />.val:    9371.20271","date: 2018 Q4<br />.val:   -8890.66567","date: 2019 Q1<br />.val:   25620.33875","date: 2019 Q2<br />.val:  -18920.27980","date: 2019 Q3<br />.val:   22485.21406","date: 2019 Q4<br />.val:   -7476.12327","date: 2020 Q1<br />.val:  155982.94619","date: 2020 Q2<br />.val: -904746.83032","date: 2020 Q3<br />.val:       0.00000","date: 2020 Q4<br />.val:  225302.65440","date: 2021 Q1<br />.val:  142339.10907","date: 2021 Q2<br />.val:  125201.93636","date: 2021 Q3<br />.val:    6672.18850","date: 2021 Q4<br />.val:   -4838.77750"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[4807942.818113598,5045772.8818864012,5045772.8818864012,4807942.818113598,4807942.818113598],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[4781112.199597531,5018942.2633703342,5018942.2633703342,4781112.199597531,4781112.199597531],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-124221.24806266722,113608.8157101356,113608.8157101356,-124221.24806266722,-124221.24806266722],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-458637.11984234472,-220807.0560695419,-220807.0560695419,-458637.11984234472,-458637.11984234472],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":52.529680365296812,"r":18.99543378995434,"b":37.260273972602747,"l":51.872146118721474},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9025.75,19371.25],"tickmode":"array","ticktext":["2000 Q1","2010 Q1","2020 Q1"],"tickvals":[10957,14610,18262],"categoryorder":"array","categoryarray":["2000 Q1","2010 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"price","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[3579951.7949999999,6273763.9050000003],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[3635302.8039845903,6164751.6589832753],"tickmode":"array","ticktext":["4000000","4500000","5000000","5500000","6000000"],"tickvals":[4000000,4500000,5000000,5500000,6000000],"categoryorder":"array","categoryarray":["4000000","4500000","5000000","5500000","6000000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-136112.75125130737,125500.31889877575],"tickmode":"array","ticktext":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"tickvals":[-100000,-50000,0,50000,100000],"categoryorder":"array","categoryarray":["-1e+05","-5e+04","0e+00","5e+04","1e+05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-961249.30455172458,281805.12863983802],"tickmode":"array","ticktext":["-9e+05","-6e+05","-3e+05","0e+00"],"tickvals":[-900000,-600000,-300000,-1.1641532182693481e-10],"categoryorder":"array","categoryarray":["-9e+05","-6e+05","-3e+05","0e+00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"189f172a381a":{"x":{},"y":{},"type":"scatter"},"189f2059ff16":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"189f172a381a","visdat":{"189f172a381a":["function (y) ","x"],"189f2059ff16":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>The STL decomposition shows that the variance of the seasonal component has been increasing. We could try using a <strong>log transformation</strong> to counter this.</p>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a></a>  <span class="fu">autoplot</span>(<span class="fu">log</span>(price)) <span class="sc">+</span></span>
<span id="cb9-3"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Log of the Real GDP of Mexico"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a></a>  <span class="fu">autoplot</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a></a>  <span class="fu">ggplotly</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1f365173fb41b5082b3e" style="width:960px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1f365173fb41b5082b3e">{"x":{"data":[{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[15.124491221772157,15.175482478420287,15.178040519320948,15.211348855489106,15.222661769903164,15.23497355724434,15.235771420317244,15.237857493983071,15.244922668341729,15.258251294762877,15.265394693428794,15.271283802448208,15.299935277534624,15.311892688649808,15.320747526621583,15.303617277470252,15.306403239344863,15.312564413988975,15.306224617312033,15.292952447062387,15.267073892126774,15.320520741781639,15.309986653858221,15.31034873765271,15.29766074545087,15.32416988608693,15.311732021992574,15.322132182114167,15.329814133132844,15.361489920548486,15.344897179354668,15.359522857244334,15.334568976757511,15.385100751117829,15.367492584082582,15.391563812696189,15.3925580591333,15.430737322615016,15.416715109109003,15.426972580504676,15.412146736757412,15.450103025057565,15.438202012903293,15.448772647471172,15.420082731869051,15.473667393935015,15.449439735890511,15.44332598466398,15.348998914338697,15.364538120624045,15.388917563599181,15.423131761181052,15.393038251943345,15.43393602109575,15.434938305421738,15.45821754610329,15.429505670569641,15.458525112630031,15.471363511432719,15.496123098788573,15.477720240302169,15.498297105757441,15.496292301546092,15.52349007805679,15.474966508992798,15.515406369634395,15.506658236987494,15.532372238087094,15.499489103226681,15.53470632358038,15.531926155732155,15.562082841991826,15.527936121037413,15.557861691994551,15.565220978065064,15.584014160321685,15.544375984270069,15.580239454117672,15.573995055036763,15.606537875901639,15.57793000418353,15.595126880040544,15.585844906365097,15.620875665959819,15.589122604289251,15.62362446139605,15.612973995258981,15.63217690950823,15.598506438881587,15.613699381196653,15.608307222452646,15.622020009387688,15.584085497706107,15.386869896755375,15.523535167461766,15.586421669310464,15.557790122706725,15.59145895503012,15.573573420031327,15.605170658392282],"text":["date: 1997 Q1<br />.val: 15.1244912218","date: 1997 Q2<br />.val: 15.1754824784","date: 1997 Q3<br />.val: 15.1780405193","date: 1997 Q4<br />.val: 15.2113488555","date: 1998 Q1<br />.val: 15.2226617699","date: 1998 Q2<br />.val: 15.2349735572","date: 1998 Q3<br />.val: 15.2357714203","date: 1998 Q4<br />.val: 15.2378574940","date: 1999 Q1<br />.val: 15.2449226683","date: 1999 Q2<br />.val: 15.2582512948","date: 1999 Q3<br />.val: 15.2653946934","date: 1999 Q4<br />.val: 15.2712838024","date: 2000 Q1<br />.val: 15.2999352775","date: 2000 Q2<br />.val: 15.3118926886","date: 2000 Q3<br />.val: 15.3207475266","date: 2000 Q4<br />.val: 15.3036172775","date: 2001 Q1<br />.val: 15.3064032393","date: 2001 Q2<br />.val: 15.3125644140","date: 2001 Q3<br />.val: 15.3062246173","date: 2001 Q4<br />.val: 15.2929524471","date: 2002 Q1<br />.val: 15.2670738921","date: 2002 Q2<br />.val: 15.3205207418","date: 2002 Q3<br />.val: 15.3099866539","date: 2002 Q4<br />.val: 15.3103487377","date: 2003 Q1<br />.val: 15.2976607455","date: 2003 Q2<br />.val: 15.3241698861","date: 2003 Q3<br />.val: 15.3117320220","date: 2003 Q4<br />.val: 15.3221321821","date: 2004 Q1<br />.val: 15.3298141331","date: 2004 Q2<br />.val: 15.3614899205","date: 2004 Q3<br />.val: 15.3448971794","date: 2004 Q4<br />.val: 15.3595228572","date: 2005 Q1<br />.val: 15.3345689768","date: 2005 Q2<br />.val: 15.3851007511","date: 2005 Q3<br />.val: 15.3674925841","date: 2005 Q4<br />.val: 15.3915638127","date: 2006 Q1<br />.val: 15.3925580591","date: 2006 Q2<br />.val: 15.4307373226","date: 2006 Q3<br />.val: 15.4167151091","date: 2006 Q4<br />.val: 15.4269725805","date: 2007 Q1<br />.val: 15.4121467368","date: 2007 Q2<br />.val: 15.4501030251","date: 2007 Q3<br />.val: 15.4382020129","date: 2007 Q4<br />.val: 15.4487726475","date: 2008 Q1<br />.val: 15.4200827319","date: 2008 Q2<br />.val: 15.4736673939","date: 2008 Q3<br />.val: 15.4494397359","date: 2008 Q4<br />.val: 15.4433259847","date: 2009 Q1<br />.val: 15.3489989143","date: 2009 Q2<br />.val: 15.3645381206","date: 2009 Q3<br />.val: 15.3889175636","date: 2009 Q4<br />.val: 15.4231317612","date: 2010 Q1<br />.val: 15.3930382519","date: 2010 Q2<br />.val: 15.4339360211","date: 2010 Q3<br />.val: 15.4349383054","date: 2010 Q4<br />.val: 15.4582175461","date: 2011 Q1<br />.val: 15.4295056706","date: 2011 Q2<br />.val: 15.4585251126","date: 2011 Q3<br />.val: 15.4713635114","date: 2011 Q4<br />.val: 15.4961230988","date: 2012 Q1<br />.val: 15.4777202403","date: 2012 Q2<br />.val: 15.4982971058","date: 2012 Q3<br />.val: 15.4962923015","date: 2012 Q4<br />.val: 15.5234900781","date: 2013 Q1<br />.val: 15.4749665090","date: 2013 Q2<br />.val: 15.5154063696","date: 2013 Q3<br />.val: 15.5066582370","date: 2013 Q4<br />.val: 15.5323722381","date: 2014 Q1<br />.val: 15.4994891032","date: 2014 Q2<br />.val: 15.5347063236","date: 2014 Q3<br />.val: 15.5319261557","date: 2014 Q4<br />.val: 15.5620828420","date: 2015 Q1<br />.val: 15.5279361210","date: 2015 Q2<br />.val: 15.5578616920","date: 2015 Q3<br />.val: 15.5652209781","date: 2015 Q4<br />.val: 15.5840141603","date: 2016 Q1<br />.val: 15.5443759843","date: 2016 Q2<br />.val: 15.5802394541","date: 2016 Q3<br />.val: 15.5739950550","date: 2016 Q4<br />.val: 15.6065378759","date: 2017 Q1<br />.val: 15.5779300042","date: 2017 Q2<br />.val: 15.5951268800","date: 2017 Q3<br />.val: 15.5858449064","date: 2017 Q4<br />.val: 15.6208756660","date: 2018 Q1<br />.val: 15.5891226043","date: 2018 Q2<br />.val: 15.6236244614","date: 2018 Q3<br />.val: 15.6129739953","date: 2018 Q4<br />.val: 15.6321769095","date: 2019 Q1<br />.val: 15.5985064389","date: 2019 Q2<br />.val: 15.6136993812","date: 2019 Q3<br />.val: 15.6083072225","date: 2019 Q4<br />.val: 15.6220200094","date: 2020 Q1<br />.val: 15.5840854977","date: 2020 Q2<br />.val: 15.3868698968","date: 2020 Q3<br />.val: 15.5235351675","date: 2020 Q4<br />.val: 15.5864216693","date: 2021 Q1<br />.val: 15.5577901227","date: 2021 Q2<br />.val: 15.5914589550","date: 2021 Q3<br />.val: 15.5735734200","date: 2021 Q4<br />.val: 15.6051706584"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[15.144066662702278,15.162999848282618,15.181743052027802,15.19953654404266,15.213772602961841,15.225703129379136,15.23322937993005,15.240787805006484,15.247389327573572,15.25552226956526,15.260522417433222,15.271978548106839,15.28601011281056,15.299575286008583,15.308838791565522,15.310964046849804,15.3094163766437,15.306996897200625,15.29950739733928,15.295253454914617,15.296634989842101,15.300845939450262,15.306622892187434,15.309910679195204,15.311049447849101,15.313128176493333,15.317424155622522,15.326716597672048,15.336471042278273,15.345619717517643,15.34937088413373,15.352154779751221,15.358509651600372,15.365742622451688,15.376201569508604,15.388981600618276,15.402255227697751,15.413226566541605,15.419123729213061,15.423479433572931,15.429243324342822,15.435141353748467,15.438566905459499,15.44073493579376,15.444947084335386,15.44618293766788,15.445340060032082,15.433609941914797,15.419464111718026,15.409348472353166,15.393374069513428,15.404872463884555,15.415331316238461,15.425264790234007,15.434933844548526,15.442733631847441,15.449690261417523,15.458730530772572,15.470164745499757,15.481910502859312,15.489353563377644,15.494862060065415,15.498420395843091,15.500503114743964,15.50335541137332,15.505442597552491,15.51066235728176,15.516027104023758,15.521312612557448,15.527579812191094,15.535519583870224,15.542323995552541,15.548729741167996,15.555303899560657,15.561399522536345,15.566247619218137,15.569247859852247,15.572556115149627,15.580243421630453,15.58705932354194,15.590409238016838,15.59225673051415,15.595743819923516,15.601483030116473,15.608506086373479,15.612835682945541,15.615793640761268,15.616131879662765,15.61398398472366,15.611512502846827,15.608929158988214,15.607342295683209,15.603447608305364,15.593619408975535,15.585921419579451,15.575461534206363,15.577398880088458,15.580430841341348,15.584772253155037,15.589200770804737],"text":["date: 1997 Q1<br />.val: 15.1440666627","date: 1997 Q2<br />.val: 15.1629998483","date: 1997 Q3<br />.val: 15.1817430520","date: 1997 Q4<br />.val: 15.1995365440","date: 1998 Q1<br />.val: 15.2137726030","date: 1998 Q2<br />.val: 15.2257031294","date: 1998 Q3<br />.val: 15.2332293799","date: 1998 Q4<br />.val: 15.2407878050","date: 1999 Q1<br />.val: 15.2473893276","date: 1999 Q2<br />.val: 15.2555222696","date: 1999 Q3<br />.val: 15.2605224174","date: 1999 Q4<br />.val: 15.2719785481","date: 2000 Q1<br />.val: 15.2860101128","date: 2000 Q2<br />.val: 15.2995752860","date: 2000 Q3<br />.val: 15.3088387916","date: 2000 Q4<br />.val: 15.3109640468","date: 2001 Q1<br />.val: 15.3094163766","date: 2001 Q2<br />.val: 15.3069968972","date: 2001 Q3<br />.val: 15.2995073973","date: 2001 Q4<br />.val: 15.2952534549","date: 2002 Q1<br />.val: 15.2966349898","date: 2002 Q2<br />.val: 15.3008459395","date: 2002 Q3<br />.val: 15.3066228922","date: 2002 Q4<br />.val: 15.3099106792","date: 2003 Q1<br />.val: 15.3110494478","date: 2003 Q2<br />.val: 15.3131281765","date: 2003 Q3<br />.val: 15.3174241556","date: 2003 Q4<br />.val: 15.3267165977","date: 2004 Q1<br />.val: 15.3364710423","date: 2004 Q2<br />.val: 15.3456197175","date: 2004 Q3<br />.val: 15.3493708841","date: 2004 Q4<br />.val: 15.3521547798","date: 2005 Q1<br />.val: 15.3585096516","date: 2005 Q2<br />.val: 15.3657426225","date: 2005 Q3<br />.val: 15.3762015695","date: 2005 Q4<br />.val: 15.3889816006","date: 2006 Q1<br />.val: 15.4022552277","date: 2006 Q2<br />.val: 15.4132265665","date: 2006 Q3<br />.val: 15.4191237292","date: 2006 Q4<br />.val: 15.4234794336","date: 2007 Q1<br />.val: 15.4292433243","date: 2007 Q2<br />.val: 15.4351413537","date: 2007 Q3<br />.val: 15.4385669055","date: 2007 Q4<br />.val: 15.4407349358","date: 2008 Q1<br />.val: 15.4449470843","date: 2008 Q2<br />.val: 15.4461829377","date: 2008 Q3<br />.val: 15.4453400600","date: 2008 Q4<br />.val: 15.4336099419","date: 2009 Q1<br />.val: 15.4194641117","date: 2009 Q2<br />.val: 15.4093484724","date: 2009 Q3<br />.val: 15.3933740695","date: 2009 Q4<br />.val: 15.4048724639","date: 2010 Q1<br />.val: 15.4153313162","date: 2010 Q2<br />.val: 15.4252647902","date: 2010 Q3<br />.val: 15.4349338445","date: 2010 Q4<br />.val: 15.4427336318","date: 2011 Q1<br />.val: 15.4496902614","date: 2011 Q2<br />.val: 15.4587305308","date: 2011 Q3<br />.val: 15.4701647455","date: 2011 Q4<br />.val: 15.4819105029","date: 2012 Q1<br />.val: 15.4893535634","date: 2012 Q2<br />.val: 15.4948620601","date: 2012 Q3<br />.val: 15.4984203958","date: 2012 Q4<br />.val: 15.5005031147","date: 2013 Q1<br />.val: 15.5033554114","date: 2013 Q2<br />.val: 15.5054425976","date: 2013 Q3<br />.val: 15.5106623573","date: 2013 Q4<br />.val: 15.5160271040","date: 2014 Q1<br />.val: 15.5213126126","date: 2014 Q2<br />.val: 15.5275798122","date: 2014 Q3<br />.val: 15.5355195839","date: 2014 Q4<br />.val: 15.5423239956","date: 2015 Q1<br />.val: 15.5487297412","date: 2015 Q2<br />.val: 15.5553038996","date: 2015 Q3<br />.val: 15.5613995225","date: 2015 Q4<br />.val: 15.5662476192","date: 2016 Q1<br />.val: 15.5692478599","date: 2016 Q2<br />.val: 15.5725561151","date: 2016 Q3<br />.val: 15.5802434216","date: 2016 Q4<br />.val: 15.5870593235","date: 2017 Q1<br />.val: 15.5904092380","date: 2017 Q2<br />.val: 15.5922567305","date: 2017 Q3<br />.val: 15.5957438199","date: 2017 Q4<br />.val: 15.6014830301","date: 2018 Q1<br />.val: 15.6085060864","date: 2018 Q2<br />.val: 15.6128356829","date: 2018 Q3<br />.val: 15.6157936408","date: 2018 Q4<br />.val: 15.6161318797","date: 2019 Q1<br />.val: 15.6139839847","date: 2019 Q2<br />.val: 15.6115125028","date: 2019 Q3<br />.val: 15.6089291590","date: 2019 Q4<br />.val: 15.6073422957","date: 2020 Q1<br />.val: 15.6034476083","date: 2020 Q2<br />.val: 15.5936194090","date: 2020 Q3<br />.val: 15.5859214196","date: 2020 Q4<br />.val: 15.5754615342","date: 2021 Q1<br />.val: 15.5773988801","date: 2021 Q2<br />.val: 15.5804308413","date: 2021 Q3<br />.val: 15.5847722532","date: 2021 Q4<br />.val: 15.5892007708"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039,-0.017996746061627607,0.0095450649735310776,-0.0017209257695128899,0.010172627530833039],"text":["date: 1997 Q1<br />.val: -0.0179967461","date: 1997 Q2<br />.val:  0.0095450650","date: 1997 Q3<br />.val: -0.0017209258","date: 1997 Q4<br />.val:  0.0101726275","date: 1998 Q1<br />.val: -0.0179967461","date: 1998 Q2<br />.val:  0.0095450650","date: 1998 Q3<br />.val: -0.0017209258","date: 1998 Q4<br />.val:  0.0101726275","date: 1999 Q1<br />.val: -0.0179967461","date: 1999 Q2<br />.val:  0.0095450650","date: 1999 Q3<br />.val: -0.0017209258","date: 1999 Q4<br />.val:  0.0101726275","date: 2000 Q1<br />.val: -0.0179967461","date: 2000 Q2<br />.val:  0.0095450650","date: 2000 Q3<br />.val: -0.0017209258","date: 2000 Q4<br />.val:  0.0101726275","date: 2001 Q1<br />.val: -0.0179967461","date: 2001 Q2<br />.val:  0.0095450650","date: 2001 Q3<br />.val: -0.0017209258","date: 2001 Q4<br />.val:  0.0101726275","date: 2002 Q1<br />.val: -0.0179967461","date: 2002 Q2<br />.val:  0.0095450650","date: 2002 Q3<br />.val: -0.0017209258","date: 2002 Q4<br />.val:  0.0101726275","date: 2003 Q1<br />.val: -0.0179967461","date: 2003 Q2<br />.val:  0.0095450650","date: 2003 Q3<br />.val: -0.0017209258","date: 2003 Q4<br />.val:  0.0101726275","date: 2004 Q1<br />.val: -0.0179967461","date: 2004 Q2<br />.val:  0.0095450650","date: 2004 Q3<br />.val: -0.0017209258","date: 2004 Q4<br />.val:  0.0101726275","date: 2005 Q1<br />.val: -0.0179967461","date: 2005 Q2<br />.val:  0.0095450650","date: 2005 Q3<br />.val: -0.0017209258","date: 2005 Q4<br />.val:  0.0101726275","date: 2006 Q1<br />.val: -0.0179967461","date: 2006 Q2<br />.val:  0.0095450650","date: 2006 Q3<br />.val: -0.0017209258","date: 2006 Q4<br />.val:  0.0101726275","date: 2007 Q1<br />.val: -0.0179967461","date: 2007 Q2<br />.val:  0.0095450650","date: 2007 Q3<br />.val: -0.0017209258","date: 2007 Q4<br />.val:  0.0101726275","date: 2008 Q1<br />.val: -0.0179967461","date: 2008 Q2<br />.val:  0.0095450650","date: 2008 Q3<br />.val: -0.0017209258","date: 2008 Q4<br />.val:  0.0101726275","date: 2009 Q1<br />.val: -0.0179967461","date: 2009 Q2<br />.val:  0.0095450650","date: 2009 Q3<br />.val: -0.0017209258","date: 2009 Q4<br />.val:  0.0101726275","date: 2010 Q1<br />.val: -0.0179967461","date: 2010 Q2<br />.val:  0.0095450650","date: 2010 Q3<br />.val: -0.0017209258","date: 2010 Q4<br />.val:  0.0101726275","date: 2011 Q1<br />.val: -0.0179967461","date: 2011 Q2<br />.val:  0.0095450650","date: 2011 Q3<br />.val: -0.0017209258","date: 2011 Q4<br />.val:  0.0101726275","date: 2012 Q1<br />.val: -0.0179967461","date: 2012 Q2<br />.val:  0.0095450650","date: 2012 Q3<br />.val: -0.0017209258","date: 2012 Q4<br />.val:  0.0101726275","date: 2013 Q1<br />.val: -0.0179967461","date: 2013 Q2<br />.val:  0.0095450650","date: 2013 Q3<br />.val: -0.0017209258","date: 2013 Q4<br />.val:  0.0101726275","date: 2014 Q1<br />.val: -0.0179967461","date: 2014 Q2<br />.val:  0.0095450650","date: 2014 Q3<br />.val: -0.0017209258","date: 2014 Q4<br />.val:  0.0101726275","date: 2015 Q1<br />.val: -0.0179967461","date: 2015 Q2<br />.val:  0.0095450650","date: 2015 Q3<br />.val: -0.0017209258","date: 2015 Q4<br />.val:  0.0101726275","date: 2016 Q1<br />.val: -0.0179967461","date: 2016 Q2<br />.val:  0.0095450650","date: 2016 Q3<br />.val: -0.0017209258","date: 2016 Q4<br />.val:  0.0101726275","date: 2017 Q1<br />.val: -0.0179967461","date: 2017 Q2<br />.val:  0.0095450650","date: 2017 Q3<br />.val: -0.0017209258","date: 2017 Q4<br />.val:  0.0101726275","date: 2018 Q1<br />.val: -0.0179967461","date: 2018 Q2<br />.val:  0.0095450650","date: 2018 Q3<br />.val: -0.0017209258","date: 2018 Q4<br />.val:  0.0101726275","date: 2019 Q1<br />.val: -0.0179967461","date: 2019 Q2<br />.val:  0.0095450650","date: 2019 Q3<br />.val: -0.0017209258","date: 2019 Q4<br />.val:  0.0101726275","date: 2020 Q1<br />.val: -0.0179967461","date: 2020 Q2<br />.val:  0.0095450650","date: 2020 Q3<br />.val: -0.0017209258","date: 2020 Q4<br />.val:  0.0101726275","date: 2021 Q1<br />.val: -0.0179967461","date: 2021 Q2<br />.val:  0.0095450650","date: 2021 Q3<br />.val: -0.0017209258","date: 2021 Q4<br />.val:  0.0101726275"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9862,9952,10043,10135,10227,10317,10408,10500,10592,10682,10773,10865,10957,11048,11139,11231,11323,11413,11504,11596,11688,11778,11869,11961,12053,12143,12234,12326,12418,12509,12600,12692,12784,12874,12965,13057,13149,13239,13330,13422,13514,13604,13695,13787,13879,13970,14061,14153,14245,14335,14426,14518,14610,14700,14791,14883,14975,15065,15156,15248,15340,15431,15522,15614,15706,15796,15887,15979,16071,16161,16252,16344,16436,16526,16617,16709,16801,16892,16983,17075,17167,17257,17348,17440,17532,17622,17713,17805,17897,17987,18078,18170,18262,18353,18444,18536,18628,18718,18809,18901],"y":[-0.001578694868493713,0.0029375651641370126,-0.0019816069373401746,0.0016396839156129772,0.026885913002949735,-0.00027463710832797972,0.004262966156707293,-0.013102938554245824,0.015530086829784295,-0.0068160397759147173,0.0065932017650851549,-0.010867373189464402,0.031921910785690955,0.0027723376676931366,0.013629660825573708,-0.01751939691038551,0.014983608762790368,-0.0039775481851815897,0.008438145742266201,-0.012473635383063453,-0.011564351653699845,0.010129737357845059,0.0050846874403003284,-0.0097345690733270374,0.0046080436633957333,0.0014966446200652683,-0.0039712078604345891,-0.014757043088714283,0.011339836916198109,0.0063251380573117189,-0.0027527790095493998,-0.002804550037719622,-0.0059439287812335095,0.0098130636926097026,-0.0069880596565088382,-0.0075904154529204959,0.0082995774971763581,0.0079656910998799901,-0.00068769433454463069,-0.0066794805990877393,0.00090015847621671696,0.0054166063355669536,0.0013560332133071284,-0.0021349158534214041,-0.0068676064047075158,0.01793939129360389,0.005820601627942068,-0.00045658478165044869,-0.052468451317702502,-0.054355416702652093,-0.0027355801447335182,0.0080866697656638564,-0.0042963182334894157,-0.00087383411178798553,0.0017253866427253683,0.0053112867250160178,-0.0021878447862544448,-0.0097504831160719618,0.0029196917024751912,0.0040399683984269075,0.0063634229861513347,-0.0061100192815057852,-0.00040716852748623467,0.01281433578199298,-0.010392156318895118,0.00041870710837166314,-0.002283194524752119,0.0061725065325024531,-0.003826763269140443,-0.0024185535842455863,-0.0018725023685561837,0.0095862189084510163,-0.0027968740689559013,-0.0069872725396376012,0.0055423812982322573,0.0075939135727143281,-0.0068751295205515817,-0.0018617260054867302,-0.004527440824176665,0.0093059248288653862,0.0055175122283195321,-0.0066749154471370531,-0.0081779877889065489,0.0092200083125124621,-0.0013867360226011982,0.0012437134769776037,-0.0010987197327736453,0.0058724023146314863,0.0025192002195542074,-0.0073581866237049098,0.0010989892339452467,0.004505086173645978,-0.0013653645376301426,-0.2162945771936915,-0.060665326348171789,0.00078750757326773169,-0.0016120113201054664,0.0014830487152401872,-0.0094779073541975123,0.0057972600567115506],"text":["date: 1997 Q1<br />.val: -0.0015786949","date: 1997 Q2<br />.val:  0.0029375652","date: 1997 Q3<br />.val: -0.0019816069","date: 1997 Q4<br />.val:  0.0016396839","date: 1998 Q1<br />.val:  0.0268859130","date: 1998 Q2<br />.val: -0.0002746371","date: 1998 Q3<br />.val:  0.0042629662","date: 1998 Q4<br />.val: -0.0131029386","date: 1999 Q1<br />.val:  0.0155300868","date: 1999 Q2<br />.val: -0.0068160398","date: 1999 Q3<br />.val:  0.0065932018","date: 1999 Q4<br />.val: -0.0108673732","date: 2000 Q1<br />.val:  0.0319219108","date: 2000 Q2<br />.val:  0.0027723377","date: 2000 Q3<br />.val:  0.0136296608","date: 2000 Q4<br />.val: -0.0175193969","date: 2001 Q1<br />.val:  0.0149836088","date: 2001 Q2<br />.val: -0.0039775482","date: 2001 Q3<br />.val:  0.0084381457","date: 2001 Q4<br />.val: -0.0124736354","date: 2002 Q1<br />.val: -0.0115643517","date: 2002 Q2<br />.val:  0.0101297374","date: 2002 Q3<br />.val:  0.0050846874","date: 2002 Q4<br />.val: -0.0097345691","date: 2003 Q1<br />.val:  0.0046080437","date: 2003 Q2<br />.val:  0.0014966446","date: 2003 Q3<br />.val: -0.0039712079","date: 2003 Q4<br />.val: -0.0147570431","date: 2004 Q1<br />.val:  0.0113398369","date: 2004 Q2<br />.val:  0.0063251381","date: 2004 Q3<br />.val: -0.0027527790","date: 2004 Q4<br />.val: -0.0028045500","date: 2005 Q1<br />.val: -0.0059439288","date: 2005 Q2<br />.val:  0.0098130637","date: 2005 Q3<br />.val: -0.0069880597","date: 2005 Q4<br />.val: -0.0075904155","date: 2006 Q1<br />.val:  0.0082995775","date: 2006 Q2<br />.val:  0.0079656911","date: 2006 Q3<br />.val: -0.0006876943","date: 2006 Q4<br />.val: -0.0066794806","date: 2007 Q1<br />.val:  0.0009001585","date: 2007 Q2<br />.val:  0.0054166063","date: 2007 Q3<br />.val:  0.0013560332","date: 2007 Q4<br />.val: -0.0021349159","date: 2008 Q1<br />.val: -0.0068676064","date: 2008 Q2<br />.val:  0.0179393913","date: 2008 Q3<br />.val:  0.0058206016","date: 2008 Q4<br />.val: -0.0004565848","date: 2009 Q1<br />.val: -0.0524684513","date: 2009 Q2<br />.val: -0.0543554167","date: 2009 Q3<br />.val: -0.0027355801","date: 2009 Q4<br />.val:  0.0080866698","date: 2010 Q1<br />.val: -0.0042963182","date: 2010 Q2<br />.val: -0.0008738341","date: 2010 Q3<br />.val:  0.0017253866","date: 2010 Q4<br />.val:  0.0053112867","date: 2011 Q1<br />.val: -0.0021878448","date: 2011 Q2<br />.val: -0.0097504831","date: 2011 Q3<br />.val:  0.0029196917","date: 2011 Q4<br />.val:  0.0040399684","date: 2012 Q1<br />.val:  0.0063634230","date: 2012 Q2<br />.val: -0.0061100193","date: 2012 Q3<br />.val: -0.0004071685","date: 2012 Q4<br />.val:  0.0128143358","date: 2013 Q1<br />.val: -0.0103921563","date: 2013 Q2<br />.val:  0.0004187071","date: 2013 Q3<br />.val: -0.0022831945","date: 2013 Q4<br />.val:  0.0061725065","date: 2014 Q1<br />.val: -0.0038267633","date: 2014 Q2<br />.val: -0.0024185536","date: 2014 Q3<br />.val: -0.0018725024","date: 2014 Q4<br />.val:  0.0095862189","date: 2015 Q1<br />.val: -0.0027968741","date: 2015 Q2<br />.val: -0.0069872725","date: 2015 Q3<br />.val:  0.0055423813","date: 2015 Q4<br />.val:  0.0075939136","date: 2016 Q1<br />.val: -0.0068751295","date: 2016 Q2<br />.val: -0.0018617260","date: 2016 Q3<br />.val: -0.0045274408","date: 2016 Q4<br />.val:  0.0093059248","date: 2017 Q1<br />.val:  0.0055175122","date: 2017 Q2<br />.val: -0.0066749154","date: 2017 Q3<br />.val: -0.0081779878","date: 2017 Q4<br />.val:  0.0092200083","date: 2018 Q1<br />.val: -0.0013867360","date: 2018 Q2<br />.val:  0.0012437135","date: 2018 Q3<br />.val: -0.0010987197","date: 2018 Q4<br />.val:  0.0058724023","date: 2019 Q1<br />.val:  0.0025192002","date: 2019 Q2<br />.val: -0.0073581866","date: 2019 Q3<br />.val:  0.0010989892","date: 2019 Q4<br />.val:  0.0045050862","date: 2020 Q1<br />.val: -0.0013653645","date: 2020 Q2<br />.val: -0.2162945772","date: 2020 Q3<br />.val: -0.0606653263","date: 2020 Q4<br />.val:  0.0007875076","date: 2021 Q1<br />.val: -0.0016120113","date: 2021 Q2<br />.val:  0.0014830487","date: 2021 Q3<br />.val: -0.0094779074","date: 2021 Q4<br />.val:  0.0057972601"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[15.364249378843962,15.392418752436424,15.392418752436424,15.364249378843962,15.364249378843962],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[15.36601458438629,15.394183957978752,15.394183957978752,15.36601458438629,15.36601458438629],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-0.017996746061627607,0.010172627530833041,0.010172627530833041,-0.017996746061627607,-0.017996746061627607],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[9496,9496,9678,9678,9496],"y":[-0.10627102000023059,-0.078101646407769953,-0.078101646407769953,-0.10627102000023059,-0.10627102000023059],"text":"","type":"scatter","mode":"lines","line":{"width":1.2598425196850394,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,1)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":52.529680365296812,"r":18.99543378995434,"b":37.260273972602747,"l":34.337899543379002},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"STL decomposition","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9025.75,19371.25],"tickmode":"array","ticktext":["2000 Q1","2010 Q1","2020 Q1"],"tickvals":[10957,14610,18262],"categoryorder":"array","categoryarray":["2000 Q1","2010 Q1","2020 Q1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"date","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"log(price)","x":1,"y":0.87785388127853881,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"trend","x":1,"y":0.625,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"season_year","x":1,"y":0.375,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"remainder","x":1,"y":0.12214611872146118,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"yaxis":{"domain":[0.75570776255707761,1],"automargin":true,"type":"linear","autorange":false,"range":[15.099106937385354,15.657561193895033],"tickmode":"array","ticktext":["15.1","15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.100000000000001,15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.1","15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.75570776255707761,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.75570776255707761,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.50570776255707761,"y1":0.74429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.50570776255707761,"y1":0.74429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0.25570776255707761,"y1":0.49429223744292239},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0.25570776255707761,"y1":0.49429223744292239,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":0.24429223744292236},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","y0":0,"y1":0.24429223744292236,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[15.120463401854254,15.639735140510789],"tickmode":"array","ticktext":["15.2","15.3","15.4","15.5","15.6"],"tickvals":[15.200000000000001,15.300000000000001,15.400000000000002,15.500000000000002,15.600000000000001],"categoryorder":"array","categoryarray":["15.2","15.3","15.4","15.5","15.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.50570776255707761,0.74429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.019405214741250638,0.011581096210456074],"tickmode":"array","ticktext":["-0.01","0.00","0.01"],"tickvals":[-0.01,0,0.0099999999999999985],"categoryorder":"array","categoryarray":["-0.01","0.00","0.01"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.25570776255707761,0.49429223744292239],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.22870540159266062,0.044332735184660077],"tickmode":"array","ticktext":["-0.20","-0.15","-0.10","-0.05","0.00"],"tickvals":[-0.20000000000000001,-0.15000000000000002,-0.10000000000000001,-0.049999999999999989,2.7755575615628914e-17],"categoryorder":"array","categoryarray":["-0.20","-0.15","-0.10","-0.05","0.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.24429223744292236],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"189f2d0b682c":{"x":{},"y":{},"type":"scatter"},"189f765ce815":{"ymin":{},"ymax":{},"xmin":{},"xmax":{}}},"cur_data":"189f2d0b682c","visdat":{"189f2d0b682c":["function (y) ","x"],"189f765ce815":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="model-specification" class="slide level2"><h2>Model Specification</h2>
<p>We will <strong>fit</strong> two models to our time series: <em>Seasonal Naïve</em>, and the <em>Drift</em> model. We will also use the log transformation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>gdp_fit <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a></a>  <span class="fu">model</span>(</span>
<span id="cb11-3"><a></a>    <span class="at">snaive =</span> <span class="fu">SNAIVE</span>(<span class="fu">log</span>(price)),</span>
<span id="cb11-4"><a></a>    <span class="at">drift  =</span> <span class="fu">RW</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb11-5"><a></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Benchmark models</strong></p>
</div>
<div class="callout-content">
<p>We have four different benchmark models that we’ll use to compare against the rest of the more complex models:</p>
<ul>
<li class="fragment">Mean (<code>MEAN( &lt;.y&gt; )</code>)</li>
<li class="fragment">Naïve (<code>NAIVE( &lt;.y&gt; )</code>)</li>
<li class="fragment">Seasonal Naïve (<code>SNAIVE( &lt;.y&gt; )</code>)</li>
<li class="fragment">Drift (<code>RW( &lt;.y&gt; ~ drift())</code>)</li>
</ul>
<p>where <code>&lt;.y&gt;</code> is just a placeholder for the variable to model.</p>
<p>Choose wisely which of these to use in each case, according to the exploratory analysis performed.</p>
</div>
</div>
</div>
</section><section id="residuals-diagnostics" class="slide level2"><h2>Residuals Diagnostics</h2>
<h3 id="visual-analysis">Visual analysis</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a></a>  <span class="fu">select</span>(snaive) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals Diagnostics for the Seasonal Naïve Model"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></a></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a></a>  <span class="fu">select</span>(drift) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals Diagnostics for the Drift Model"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-13-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-13-2.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Here we expect to see:</p>
<ul>
<li class="fragment">A time series with no apparent patterns (no trend and/or seasonality), with a mean close to zero.</li>
<li class="fragment">In the <strong>ACF</strong>, we’d expect no lags with significant autocorrelation.</li>
<li class="fragment">Normally distributed residuals.</li>
</ul>
</div>
</div>
</div>
<h3 id="portmanteau-tests-of-autocorrelation">Portmanteau tests of autocorrelation</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">24</span>, <span class="at">dof =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"126.96234","4":"5.551115e-16"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"45.90867","4":"4.540215e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Residuals interpretation</strong></p>
</div>
<div class="callout-content">
<p>Both models produce sub optimal residuals:</p>
<ul>
<li class="fragment"><p>The SNAIVE correctly detects the seasonality, however, its residuals are still autocorrelated. Moreover, the residuals are not normally distributed.</p></li>
<li class="fragment"><p>The drift model doesn’t account for the seasonality, and their distribution is a little bit skewed.</p></li>
</ul>
<p>Hence, we will perform our forecasts using the <strong>bootstrapping</strong> method.</p>
</div>
</div>
</div>
<p>We can compute some error metrics on the training set using the <code>accuracy()</code> function:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>gdp_train_accu <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(gdp_fit) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a></a>  <span class="fu">arrange</span>(MAPE)</span>
<span id="cb15-3"><a></a>gdp_train_accu <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a></a>  <span class="fu">select</span>(symbol<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.466149","5":"188184.1","6":"127478.3","7":"0.7787119"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.244553","5":"239052.4","6":"163704.1","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The <code>accuracy()</code> function</strong></p>
</div>
<div class="callout-content">
<p>The <code>accuracy()</code> function can be used to compute error metrics in the training data, or in the test set. What differs is the data that is given to it:</p>
<ul>
<li class="fragment"><p>For the training metrics, you need to use the <strong><code>mable</code></strong> (the table of models, that we usually store in <code>_fit</code>).</p></li>
<li class="fragment"><p>For the forecasting error metrics, we need the <strong><code>fable</code></strong> (the forecasts table, usually stored as <code>_fc</code> or <code>_fcst</code>), and the <strong>complete set of data</strong> (both the training and test set together).</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="https://media.tenor.com/dp_hQBGT0rIAAAAM/think-smart.gif" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>For this analysis, we are focusing on the <strong>MAPE</strong><a href="#/footnotes" class="footnote-ref" id="fnref2" role="doc-noteref" data-footnote-href="#/fn2" onclick=""><sup>2</sup></a> metric. The drift model <strong>(2.47%)</strong> seems to have a better fit with the training set than the snaive model <strong>(3.24%)</strong>.</p>
</div>
</div>
</div>
<aside></aside></section><section id="modeling-using-decomposition" class="slide level2 scrollable"><h2>Modeling using decomposition</h2>
<p>We will perform a forecast using decomposition, to see if we can improve our results so far.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>gdp_fit_dcmp <span class="ot">&lt;-</span> gdp_train <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a></a>      <span class="fu">model</span>(</span>
<span id="cb16-3"><a></a>        <span class="at">stlf =</span> <span class="fu">decomposition_model</span>(</span>
<span id="cb16-4"><a></a>          <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-5"><a></a>          <span class="fu">RW</span>(season_adjust <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb16-6"><a></a>        )</span>
<span id="cb16-7"><a></a>      )</span>
<span id="cb16-8"><a></a></span>
<span id="cb16-9"><a></a>gdp_fit_dcmp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note on <code>decomposition_model()</code></strong></p>
</div>
<div class="callout-content">
<p>Remember, when using decomposition models, we need to do the following:</p>
<ol type="1">
<li class="fragment"><p>Specify what type of decomposition we want to use and customize it as needed.</p></li>
<li class="fragment"><p>Fit a model for the seasonally adjusted data; <code>season_adjust</code>.</p></li>
<li class="fragment"><p>Fit a model for the seasonal component. <strong>R</strong> uses a <code>SNAIVE()</code> model by default to model the seasonality. If you wish to model it using a different model, you have specify it.</p></li>
</ol>
<ul>
<li class="fragment">The name of the seasonal component depends on the type of seasonality present in the time series. If it has a yearly seasonality, the component is called <code>season_year</code>. It could also be called <code>season_week</code>, <code>season_day</code>, and so on.</li>
</ul>
</div>
</div>
</div>
<p>We can join this new model with the models we trained before. This way we can have them all in the same <code>mable</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>gdp_fit <span class="ot">&lt;-</span> gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a></a>  <span class="fu">left_join</span>(gdp_fit_dcmp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<h3 id="residuals-diagnostics-1">Residuals diagnostics</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a></a>  <span class="fu">accuracy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a></a>  <span class="fu">select</span>(symbol<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a></a>  <span class="fu">arrange</span>(MAPE)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"Training","4":"1.658854","5":"169270.9","6":"82539.6","7":"0.5042000"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"Training","4":"2.466149","5":"188184.1","6":"127478.3","7":"0.7787119"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"Training","4":"3.244553","5":"239052.4","6":"163704.1","7":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a></a>  <span class="fu">select</span>(stlf) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-20-1.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a></a>  <span class="fu">features</span>(.innov, ljung_box)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lb_stat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lb_pvalue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"13.599325","4":"2.262668e-04"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"23.897849","4":"1.015852e-06"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"7.650318","4":"5.676230e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>The MAPE seems to improve with this decomposition model. Also, the residual diagnostics do not show any seasonality present in them. However, the residuals are still autocorrelated, as the <em>Ljung-Box</em> test suggests.</p>
</div>
</div>
</div>
</section><section id="forecasting-on-the-test-set" class="slide level2"><h2>Forecasting on the test set</h2>
<p>Once we have our models, we can produce forecasts. We will forecast our test data and check our forecasts’ performance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>gdp_fc <span class="ot">&lt;-</span> gdp_fit <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a></a>  <span class="fu">forecast</span>(<span class="at">h =</span> gdp_h_fc) </span>
<span id="cb21-3"><a></a></span>
<span id="cb21-4"><a></a>gdp_fc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q1","4":"<dist>","5":"5716591"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q2","4":"<dist>","5":"5912339"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q3","4":"<dist>","5":"5807533"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2022 Q4","4":"<dist>","5":"5993965"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q1","4":"<dist>","5":"5722836"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q2","4":"<dist>","5":"5918798"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q3","4":"<dist>","5":"5813878"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2023 Q4","4":"<dist>","5":"6000513"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q1","4":"<dist>","5":"5729081"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q2","4":"<dist>","5":"5925257"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q3","4":"<dist>","5":"5820222"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2024 Q4","4":"<dist>","5":"6007062"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2025 Q1","4":"<dist>","5":"5735326"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2025 Q2","4":"<dist>","5":"5931716"},{"1":"NGDPRNSAXDCMXQ","2":"snaive","3":"2025 Q3","4":"<dist>","5":"5826567"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q1","4":"<dist>","5":"6020504"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q2","4":"<dist>","5":"6053851"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q3","4":"<dist>","5":"6087459"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2022 Q4","4":"<dist>","5":"6121331"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q1","4":"<dist>","5":"6155469"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q2","4":"<dist>","5":"6189876"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q3","4":"<dist>","5":"6224552"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2023 Q4","4":"<dist>","5":"6259501"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q1","4":"<dist>","5":"6294725"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q2","4":"<dist>","5":"6330226"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q3","4":"<dist>","5":"6366007"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2024 Q4","4":"<dist>","5":"6402069"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2025 Q1","4":"<dist>","5":"6438414"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2025 Q2","4":"<dist>","5":"6475046"},{"1":"NGDPRNSAXDCMXQ","2":"drift","3":"2025 Q3","4":"<dist>","5":"6511967"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q1","4":"<dist>","5":"5850856"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q2","4":"<dist>","5":"6045036"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q3","4":"<dist>","5":"6007984"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2022 Q4","4":"<dist>","5":"6111125"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q1","4":"<dist>","5":"5971987"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q2","4":"<dist>","5":"6170438"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q3","4":"<dist>","5":"6132867"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2023 Q4","4":"<dist>","5":"6238405"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q1","4":"<dist>","5":"6096617"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q2","4":"<dist>","5":"6299465"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q3","4":"<dist>","5":"6261362"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2024 Q4","4":"<dist>","5":"6369369"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q1","4":"<dist>","5":"6224855"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q2","4":"<dist>","5":"6432228"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q3","4":"<dist>","5":"6393579"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a></a>  <span class="fu">autoplot</span>(gdp) <span class="sc">+</span></span>
<span id="cb22-3"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.model, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></a></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a></a>  <span class="fu">filter</span>(.model <span class="sc">==</span> <span class="st">"stlf"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a></a>  <span class="fu">autoplot</span>(gdp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-23-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-23-2.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
<p>We now estimate the forecast errors:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>gdp_fc <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a></a>  <span class="fu">accuracy</span>(gdp) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a></a>  <span class="fu">select</span>(.model<span class="sc">:</span>.type, MAPE, RMSE, MAE, MASE) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a></a>  <span class="fu">arrange</span>(MAPE)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["symbol"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["MAPE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MASE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"stlf","2":"NGDPRNSAXDCMXQ","3":"Test","4":"1.259968","5":"92985.72","6":"79029.65","7":"0.4827592"},{"1":"drift","2":"NGDPRNSAXDCMXQ","3":"Test","4":"1.430728","5":"108383.21","6":"89053.97","7":"0.5439936"},{"1":"snaive","2":"NGDPRNSAXDCMXQ","3":"Test","4":"6.137816","5":"403653.61","6":"385271.21","7":"2.3534612"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="forecasting-the-future" class="slide level2"><h2>Forecasting the future</h2>
<p>We now refit our model using the whole dataset. We will only model the STL decomposition model, because the other two didn’t get a strong fit.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>gdp_fit2 <span class="ot">&lt;-</span> gdp <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a></a>  <span class="fu">model</span>(</span>
<span id="cb25-3"><a></a>    <span class="at">stlf =</span> <span class="fu">decomposition_model</span>(</span>
<span id="cb25-4"><a></a>          <span class="fu">STL</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">"periodic"</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-5"><a></a>          <span class="fu">RW</span>(season_adjust <span class="sc">~</span> <span class="fu">drift</span>())</span>
<span id="cb25-6"><a></a>        )</span>
<span id="cb25-7"><a></a>  )</span>
<span id="cb25-8"><a></a>gdp_fit2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stlf"],"name":[2],"type":["lst_mdl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"<lst_mdl>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>gdp_fc_fut <span class="ot">&lt;-</span> gdp_fit2 <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a></a>  <span class="fu">forecast</span>(<span class="at">h =</span> gdp_h_fc)</span>
<span id="cb26-3"><a></a>gdp_fc_fut</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["symbol"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date"],"name":[3],"type":["qtr"],"align":["right"]},{"label":["price"],"name":[4],"type":["dist"],"align":["right"]},{"label":[".mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2025 Q4","4":"<dist>","5":"6486740"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q1","4":"<dist>","5":"6315370"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q2","4":"<dist>","5":"6513368"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q3","4":"<dist>","5":"6482810"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2026 Q4","4":"<dist>","5":"6619620"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q1","4":"<dist>","5":"6444936"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q2","4":"<dist>","5":"6647201"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q3","4":"<dist>","5":"6616217"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2027 Q4","4":"<dist>","5":"6756048"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q1","4":"<dist>","5":"6577965"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q2","4":"<dist>","5":"6784611"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q3","4":"<dist>","5":"6753192"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2028 Q4","4":"<dist>","5":"6896127"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2029 Q1","4":"<dist>","5":"6714555"},{"1":"NGDPRNSAXDCMXQ","2":"stlf","3":"2029 Q2","4":"<dist>","5":"6925702"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>gdp_fc_fut <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a></a>  <span class="fu">autoplot</span>(gdp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure><p><a href="forecasting_workflow_files/figure-revealjs/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="forecasting_workflow_files/figure-revealjs/unnamed-chunk-26-1.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="co"># save(gdp_fc_fut, file = "equipo1.RData")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section></section><section id="footnotes" class="footnotes footnotes-end-of-document smaller scrollable" role="doc-endnotes"><h2>Footnotes</h2>
<ol>
<li id="fn1">
<p>This will make it very convenient when calling your variables. RStudio will display all the options starting with <code>gdp_</code>. We will usually use the following suffixes:</p>
<ul>
<li class="fragment">
<code>_train</code>: training set</li>
<li class="fragment">
<code>_fit</code>: the <code>mable</code> (table of models)</li>
<li class="fragment">
<code>_aug</code>: the augmented table with fitted values and residuals</li>
<li class="fragment">
<code>_dcmp</code>: for the <code>dable</code> (decomposition table), containing the components and the seasonally adjusted series of a TS decomposition.</li>
<li class="fragment">
<code>_fc</code> or <code>_fcst</code>: for the <code>fable</code> (forecasts table) that has our forecasts. <img data-src="https://c.tenor.com/qjBICGJwxgIAAAAC/convenient-thats-convenient.gif" data-fig-aling="center">
</li>
</ul>

</li>
<li id="fn2">
<p>The Mean Absolute Percentage Error is a percentage error metric widely used in professional environments.</p>
<p>Let</p>
<p><span class="math display">
e_t = y_t - \hat{y}_t
</span></p>
<p>be the error or residual.</p>
<p>Then the MAPE would be computed as</p>
<p><span class="math display">
MAPE = \frac{1}{T}\sum_{t=1}^T|\frac{e_t}{y_t}|
</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="https://media.tenor.com/tqERWt8lBYEAAAAM/calculating-puzzled.gif" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>

</li>
</ol></section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../images/iteso_logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Time Series Forecasting</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 3.0e-2,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/pbenavidesh\.github\.io\/narsil\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>


</body></html>